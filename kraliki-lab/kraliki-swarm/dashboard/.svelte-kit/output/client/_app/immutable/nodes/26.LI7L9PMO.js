import{f as u,a as d}from"../chunks/CZY_NlAX.js";import{o as Ze}from"../chunks/BHyL2apj.js";import{ag as $e,aj as _,ap as fe,an as I,ai as et,al as i,ak as o,m as e,am as s,ao as $,G as l,ah as tt,as as at}from"../chunks/CHIrzwsT.js";import{s as m}from"../chunks/DsvTbyZG.js";import{i as x}from"../chunks/DNv7RG3c.js";import{e as ee,i as te}from"../chunks/De-eo5w8.js";import{s as ae}from"../chunks/Bf116p4L.js";import{s as ge}from"../chunks/U6XQp83X.js";import{d as st}from"../chunks/CaHQap0G.js";import{s as qe}from"../chunks/CuoGBMhC.js";import{b as ot}from"../chunks/C8UA6rw1.js";import{b as he}from"../chunks/DWj8Yt1E.js";var rt=u('<div class="camera-placeholder svelte-183qobo"><span class="placeholder-icon svelte-183qobo">ğŸ“¹</span> <p class="placeholder-text svelte-183qobo">Camera inactive</p> <button class="brutal-btn svelte-183qobo">START CAMERA</button></div>'),it=u('<div class="video-wrapper svelte-183qobo"><video class="video-preview svelte-183qobo" autoplay></video> <canvas style="display: none;" class="svelte-183qobo"></canvas> <div class="camera-controls svelte-183qobo"><button class="brutal-btn capture svelte-183qobo">ğŸ“¸ CAPTURE</button> <button class="brutal-btn stop svelte-183qobo">â¹ STOP</button></div></div>',2),lt=u('<div class="camera-error svelte-183qobo"> </div>'),nt=u('<div class="capture-item svelte-183qobo"><img class="svelte-183qobo"/> <div class="capture-actions svelte-183qobo"><button class="action-btn send svelte-183qobo">ğŸ“¤</button> <button class="action-btn delete svelte-183qobo">ğŸ—‘ï¸</button></div></div>'),vt=u('<div class="captures-section svelte-183qobo"><h4 class="svelte-183qobo"> </h4> <div class="captures-grid svelte-183qobo"></div></div>'),ct=u('<div class="stt-error svelte-183qobo">âš ï¸ Speech recognition not supported in this browser. Try Chrome or Edge.</div>'),dt=u('<span class="mic-icon recording-pulse svelte-183qobo">â¹</span>'),ut=u('<span class="mic-icon svelte-183qobo">ğŸ¤</span>'),pt=u('<button class="brutal-btn clear-btn svelte-183qobo">ğŸ—‘ï¸ CLEAR</button>'),bt=u('<div><div class="msg-header svelte-183qobo"><span class="msg-role svelte-183qobo"> </span> <span class="msg-time svelte-183qobo"> </span></div> <div class="msg-content svelte-183qobo"> </div></div>'),_t=u('<div class="conversation-section svelte-183qobo"><h4 class="svelte-183qobo"> </h4> <div class="conversation-list svelte-183qobo"></div></div>'),mt=u('<div class="voice-controls svelte-183qobo"><div class="input-row svelte-183qobo"><textarea class="voice-input svelte-183qobo" placeholder="Speak or type your message to AI..." rows="3"></textarea> <button type="button"><!></button></div> <div class="action-row svelte-183qobo"><button class="brutal-btn send-btn svelte-183qobo"> </button> <!></div></div> <!>',1),ft=u('<span class="agent-task svelte-183qobo"> </span>'),gt=u('<div class="agent-badge svelte-183qobo"><span class="agent-dot svelte-183qobo"></span> <span class="agent-name svelte-183qobo"> </span> <!></div>'),qt=u('<div class="page svelte-183qobo"><div class="page-header svelte-183qobo"><h2 class="glitch svelte-183qobo">Kraliki See // Multimodal Input</h2> <p class="subtitle svelte-183qobo">Visual + Voice AI Interface</p></div> <div class="content svelte-183qobo"><div class="card camera-card svelte-183qobo"><h3 class="svelte-183qobo">ğŸ“¹ VISUAL_INPUT // RECEPTION</h3> <div class="camera-container svelte-183qobo"><!> <!></div> <!></div> <div class="status-summary svelte-183qobo"><div class="status-card online svelte-183qobo"><span class="status-dot svelte-183qobo" style="background: #33ff00;"></span> <span class="status-count svelte-183qobo"> </span> <span class="status-label svelte-183qobo">ONLINE</span></div> <div class="status-card idle svelte-183qobo"><span class="status-dot svelte-183qobo" style="background: #6b7280;"></span> <span class="status-count svelte-183qobo"> </span> <span class="status-label svelte-183qobo">IDLE</span></div> <div class="status-card error svelte-183qobo"><span class="status-dot svelte-183qobo" style="background: #ff4444;"></span> <span class="status-count svelte-183qobo"> </span> <span class="status-label svelte-183qobo">ERROR</span></div></div> <div class="card voice-card svelte-183qobo"><h3 class="svelte-183qobo">ğŸ¤ VOICE_INPUT // AI_CONVERSATION</h3> <!></div> <div class="card agent-card svelte-183qobo"><h3 class="svelte-183qobo">ACTIVE_PROCESSES</h3> <div class="agent-grid svelte-183qobo"></div></div></div></div>');function Ot(Se,U){$e(U,!0);let f=_(void 0),k=_(void 0),N=_(null),V=_(!1),R=_(fe([])),y=_(null),L=_(!1),w=_(!1),b=null,j=_(!1),A=_(""),T=_(fe([])),M=_(!1);function se(t){switch(t){case"online":return"#33ff00";case"idle":return"#6b7280";case"error":return"#ff4444";default:return"#6b7280"}}function F(t){return U.data.agents.filter(a=>a.status===t).length}async function ye(){l(y,null);try{l(N,await navigator.mediaDevices.getUserMedia({video:{width:1280,height:720,facingMode:"user"},audio:!1}),!0),e(f)&&(e(f).srcObject=e(N),e(f).play(),l(V,!0))}catch(t){l(y,t instanceof Error?t.message:"Failed to access camera",!0),console.error("Camera error:",t)}}function oe(){e(N)&&(e(N).getTracks().forEach(t=>t.stop()),l(N,null)),e(f)&&(e(f).srcObject=null),l(V,!1)}function Te(){if(!e(f)||!e(k))return;const t=e(k).getContext("2d");if(!t)return;e(k).width=e(f).videoWidth,e(k).height=e(f).videoHeight,t.drawImage(e(f),0,0);const a=e(k).toDataURL("image/jpeg",.8);l(R,[a,...e(R)].slice(0,10),!0)}async function Ce(t){l(L,!0);try{const r=`ğŸ“¸ Visual capture from reception at ${new Date().toLocaleString()}`;await fetch("/api/comms",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({agent:"reception-camera",topic:"visual",message:`${r}
[Image data: ${t.substring(0,100)}...]`})}),l(y,null)}catch{l(y,"Failed to send capture to comms")}finally{l(L,!1)}}function Ee(t){l(R,e(R).filter((a,r)=>r!==t),!0)}function Ie(){const t=window.SpeechRecognition||window.webkitSpeechRecognition;if(!t){l(j,!1);return}l(j,!0),b=new t,b.continuous=!0,b.interimResults=!0,b.lang="en-US";let a="";b.onresult=r=>{let p="";for(let n=r.resultIndex;n<r.results.length;n++){const c=r.results[n][0].transcript;r.results[n].isFinal?a+=c+" ":p+=c}l(A,a+p)},b.onerror=r=>{console.error("STT error:",r.error),l(w,!1),r.error==="not-allowed"&&l(y,"Microphone access denied")},b.onend=()=>{e(w)&&b.start()}}function we(){b&&(e(w)?(b.stop(),l(w,!1)):(b.start(),l(w,!0)))}async function xe(){if(!e(A).trim()||e(M))return;l(M,!0);const t=e(A).trim();l(T,[...e(T),{role:"user",message:t,timestamp:new Date}],!0),l(A,"");try{(await fetch("/api/comms",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({agent:"see-multimodal",topic:"voice",message:t})})).ok&&l(T,[...e(T),{role:"ai",message:`Message received: "${t}". Sent to agent swarm for processing.`,timestamp:new Date}],!0),l(y,null)}catch(a){l(y,"Failed to send message to AI"),console.error("AI send error:",a)}finally{l(M,!1)}}function ke(){l(T,[],!0)}Ze(()=>(Ie(),()=>{oe(),b&&b.stop()}));var G=qt(),re=i(o(G),2),H=o(re),J=i(o(H),2),ie=o(J);{var Re=t=>{var a=rt(),r=i(o(a),4);r.__click=ye,s(a),d(t,a)},Ae=t=>{var a=it(),r=o(a);r.muted=!0,he(r,h=>l(f,h),()=>e(f));var p=i(r,2);he(p,h=>l(k,h),()=>e(k));var n=i(p,2),c=o(n);c.__click=Te;var C=i(c,2);C.__click=oe,s(n),s(a),d(t,a)};x(ie,t=>{e(V)?t(Ae,!1):t(Re)})}var Oe=i(ie,2);{var Ne=t=>{var a=lt(),r=o(a);s(a),I(()=>m(r,`âš ï¸ ${e(y)??""}`)),d(t,a)};x(Oe,t=>{e(y)&&t(Ne)})}s(J);var Me=i(J,2);{var De=t=>{var a=vt(),r=o(a),p=o(r);s(r);var n=i(r,2);ee(n,21,()=>e(R),te,(c,C,h)=>{var g=nt(),q=o(g);ae(q,"alt",`Capture ${h+1}`);var O=i(q,2),E=o(O);E.__click=()=>Ce(e(C));var z=i(E,2);z.__click=()=>Ee(h),s(O),s(g),I(()=>{ae(q,"src",e(C)),E.disabled=e(L)}),d(c,g)}),s(n),s(a),I(()=>m(p,`RECENT CAPTURES (${e(R).length??""})`)),d(t,a)};x(Me,t=>{e(R).length>0&&t(De)})}s(H);var Y=i(H,2),B=o(Y),le=i(o(B),2),Pe=o(le,!0);s(le),$(2),s(B);var K=i(B,2),ne=i(o(K),2),Ue=o(ne,!0);s(ne),$(2),s(K);var ve=i(K,2),ce=i(o(ve),2),Ve=o(ce,!0);s(ce),$(2),s(ve),s(Y);var W=i(Y,2),Le=i(o(W),2);{var je=t=>{var a=ct();d(t,a)},Fe=t=>{var a=mt(),r=tt(a),p=o(r),n=o(p);at(n);var c=i(n,2);let C;c.__click=we;var h=o(c);{var g=v=>{var S=dt();d(v,S)},q=v=>{var S=ut();d(v,S)};x(h,v=>{e(w)?v(g):v(q,!1)})}s(c),s(p);var O=i(p,2),E=o(O);E.__click=xe;var z=o(E,!0);s(E);var Ge=i(E,2);{var He=v=>{var S=pt();S.__click=ke,d(v,S)};x(Ge,v=>{e(T).length>0&&v(He)})}s(O),s(r);var Je=i(r,2);{var Ye=v=>{var S=_t(),Q=o(S),Be=o(Q);s(Q);var pe=i(Q,2);ee(pe,21,()=>e(T),te,(Ke,D)=>{var P=bt();let be;var X=o(P),Z=o(X),We=o(Z,!0);s(Z);var _e=i(Z,2),ze=o(_e,!0);s(_e),s(X);var me=i(X,2),Qe=o(me,!0);s(me),s(P),I(Xe=>{be=ge(P,1,"conversation-item svelte-183qobo",null,be,{user:e(D).role==="user",ai:e(D).role==="ai"}),m(We,e(D).role==="user"?"ğŸ‘¤ YOU":"ğŸ¤– AI"),m(ze,Xe),m(Qe,e(D).message)},[()=>e(D).timestamp.toLocaleTimeString()]),d(Ke,P)}),s(pe),s(S),I(()=>m(Be,`CONVERSATION HISTORY (${e(T).length??""})`)),d(v,S)};x(Je,v=>{e(T).length>0&&v(Ye)})}I(v=>{C=ge(c,1,"mic-btn svelte-183qobo",null,C,{recording:e(w)}),ae(c,"title",e(w)?"Stop recording":"Start voice input"),E.disabled=v,m(z,e(M)?"SENDING...":"ğŸ“¤ SEND TO AI")},[()=>!e(A).trim()||e(M)]),ot(n,()=>e(A),v=>l(A,v)),d(t,a)};x(Le,t=>{e(j)?t(Fe,!1):t(je)})}s(W);var de=i(W,2),ue=i(o(de),2);ee(ue,21,()=>U.data.agents,te,(t,a)=>{var r=gt(),p=o(r),n=i(p,2),c=o(n,!0);s(n);var C=i(n,2);{var h=g=>{var q=ft(),O=o(q,!0);s(q),I(()=>m(O,e(a).task)),d(g,q)};x(C,g=>{e(a).task&&g(h)})}s(r),I((g,q)=>{qe(r,`border-color: ${g??""}`),qe(p,`background: ${q??""};`),m(c,e(a).name)},[()=>se(e(a).status),()=>se(e(a).status)]),d(t,r)}),s(ue),s(de),s(re),s(G),I((t,a,r)=>{m(Pe,t),m(Ue,a),m(Ve,r)},[()=>F("online"),()=>F("idle"),()=>F("error")]),d(Se,G),et()}st(["click"]);export{Ot as component};

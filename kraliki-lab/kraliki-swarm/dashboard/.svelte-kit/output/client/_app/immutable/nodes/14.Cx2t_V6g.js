import{f as b,a as i,c as ve,t as Ye}from"../chunks/CZY_NlAX.js";import{o as ha}from"../chunks/BHyL2apj.js";import{ag as wa,ak as s,al as n,m as e,ai as ma,G as x,aj as F,am as a,ah as J,an as C,ao as Z,aq as ie,ar as Ve}from"../chunks/CHIrzwsT.js";import{s as r}from"../chunks/DsvTbyZG.js";import{i as G}from"../chunks/DNv7RG3c.js";import{e as ee,i as ae}from"../chunks/De-eo5w8.js";import{s as ua}from"../chunks/Bf116p4L.js";import{s as ce}from"../chunks/U6XQp83X.js";import{d as fa}from"../chunks/CaHQap0G.js";import{s as K}from"../chunks/CuoGBMhC.js";import{b as We}from"../chunks/_ujM_1n3.js";var ga=b('<option class="svelte-95wonh"> </option>'),ba=b('<div class="loading-state svelte-95wonh"><span class="loading-text svelte-95wonh">LOADING_GENOME_REGISTRY...</span></div>'),ya=b('<div class="error-state svelte-95wonh"><span class="error-text svelte-95wonh"> </span></div>'),Ea=b('<div class="stat-card svelte-95wonh"><span class="stat-value svelte-95wonh"> </span> <span class="stat-label svelte-95wonh"> </span></div>'),xa=b('<div class="cli-bar svelte-95wonh"><span class="cli-name svelte-95wonh"> </span> <div class="bar-container svelte-95wonh"><div class="bar-fill svelte-95wonh"></div></div> <span class="cli-stats svelte-95wonh"> </span></div>'),Oa=b('<div class="template-desc svelte-95wonh"> </div>'),Ta=b('<div class="role-row missing svelte-95wonh"><span class="role-label svelte-95wonh">MISSING ROLES</span> <span class="role-list svelte-95wonh"> </span></div>'),Ia=b('<div class="template-pack svelte-95wonh"><div class="template-pack-header svelte-95wonh"><span class="template-name svelte-95wonh"> </span> <span class="template-count svelte-95wonh"> </span></div> <!> <div class="role-row svelte-95wonh"><span class="role-label svelte-95wonh">ACTIVE ROLES</span> <span class="role-list svelte-95wonh"> </span></div> <div class="role-row muted svelte-95wonh"><span class="role-label svelte-95wonh">MUTED ROLES</span> <span class="role-list svelte-95wonh"> </span></div> <!></div>'),Na=b('<div class="template-packs card svelte-95wonh"><h3 class="svelte-95wonh">TEMPLATE GENOME PACKS</h3> <p class="hint svelte-95wonh">Templates activate role packs; genomes outside the pack are muted for that template. Global toggles still apply.</p> <div class="template-pack-grid svelte-95wonh"></div></div>'),Ca=b('<div role="button" tabindex="0"><div class="genome-header svelte-95wonh"><span class="genome-cli svelte-95wonh"> </span> <span class="genome-role svelte-95wonh"> </span> <button><!></button></div> <div class="genome-metrics svelte-95wonh"><span><span class="metric-value svelte-95wonh"> </span> <span class="metric-label svelte-95wonh">SPAWNS</span></span> <span><span class="metric-value svelte-95wonh"> </span> <span class="metric-label svelte-95wonh">POINTS</span></span> <span class="metric svelte-95wonh"><span class="metric-value svelte-95wonh"> </span> <span class="metric-label svelte-95wonh">DECISIONS</span></span></div> <div class="genome-footer svelte-95wonh"><span class="last-active svelte-95wonh"> </span></div></div>'),Sa=b('<div class="loading-content svelte-95wonh"><span class="loading-text svelte-95wonh">LOADING_DEFINITION...</span></div>'),ka=b('<pre class="genome-markdown svelte-95wonh"> </pre>'),Ga=b('<div class="detail-header svelte-95wonh"><div class="detail-title svelte-95wonh"><span class="detail-cli svelte-95wonh"> </span> <span class="detail-role svelte-95wonh"> </span></div> <div class="detail-stats svelte-95wonh"><span class="detail-stat green svelte-95wonh"> </span> <span class="detail-stat yellow svelte-95wonh"> </span></div></div> <div class="detail-content svelte-95wonh"><!></div>',1),$a=b('<div class="empty-detail svelte-95wonh"><span class="empty-text svelte-95wonh">SELECT A GENOME TO VIEW DEFINITION</span></div>'),Ma=b('<div class="stats-grid svelte-95wonh"><div class="stat-card svelte-95wonh"><span class="stat-value svelte-95wonh"> </span> <span class="stat-label svelte-95wonh">TOTAL GENOMES</span></div> <div class="stat-card svelte-95wonh"><span class="stat-value green svelte-95wonh"> </span> <span class="stat-label svelte-95wonh">ACTIVE TODAY</span></div> <!></div> <div class="cli-summary card svelte-95wonh"><h3 class="svelte-95wonh">CLI DISTRIBUTION</h3> <div class="cli-bars svelte-95wonh"></div></div> <!> <div class="content-grid svelte-95wonh"><div class="genome-list card svelte-95wonh"><h3 class="svelte-95wonh"> </h3> <div class="genome-items svelte-95wonh"></div></div> <div class="genome-detail card svelte-95wonh"><h3 class="svelte-95wonh">GENOME DEFINITION</h3> <!></div></div>',1),Aa=b('<div class="page svelte-95wonh"><div class="page-header svelte-95wonh"><h2 class="glitch svelte-95wonh">Genome Registry // Template Packs</h2> <div class="controls svelte-95wonh"><select class="filter-select svelte-95wonh"><option class="svelte-95wonh">ALL CLIs</option><!></select> <select class="filter-select svelte-95wonh"><option class="svelte-95wonh">BY SPAWNS</option><option class="svelte-95wonh">BY POINTS</option><option class="svelte-95wonh">BY NAME</option></select> <button class="brutal-btn svelte-95wonh">REFRESH</button></div></div> <!></div>');function Ha(He,qe){wa(qe,!0);let y=F(null),de=F(!0),se=F(null),te=F("all"),z=F("spawns"),U=F(null),Q=F(null),pe=F(!1);async function _e(){x(de,!0),x(se,null);try{const t=await fetch("/api/genomes");if(!t.ok)throw new Error("Failed to load genomes");x(y,await t.json(),!0)}catch(t){x(se,t instanceof Error?t.message:"Failed to load genomes",!0)}finally{x(de,!1)}}let le=F(null);async function Ce(t){x(U,t,!0),x(pe,!0),x(Q,null);try{const o=await fetch(`/api/genomes/${t.name}`);if(!o.ok)throw new Error("Failed to load genome");const p=await o.json();x(Q,p.content,!0)}catch(o){x(Q,`Error loading genome: ${o instanceof Error?o.message:"Unknown error"}`)}finally{x(pe,!1)}}async function Je(t,o){o.stopPropagation(),x(le,t.name,!0);try{if(!(await fetch("/api/genomes",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:t.name,enabled:!t.enabled})})).ok)throw new Error("Failed to toggle genome");await _e()}catch(p){console.error("Toggle failed:",p)}finally{x(le,null)}}function W(t){return{claude:"#33ff00",opencode:"#00d4ff",codex:"#9d4edd",gemini:"#ff9500",grok:"#ff4444"}[t]||"#6b7280"}function Ke(){if(!e(y))return[];let t=[...e(y).genomes];return e(te)!=="all"&&(t=t.filter(o=>o.cli===e(te))),t.sort((o,p)=>e(z)==="name"?o.name.localeCompare(p.name):e(z)==="spawns"?p.spawns_today-o.spawns_today:e(z)==="points"?p.points_earned-o.points_earned:0),t}function Se(t,o){return t.replace(o+"_","").replace(/_/g," ").toUpperCase()}function he(t,o=6){if(!t||t.length===0)return"NONE";const p=t.map(Y=>Y.replace(/_/g," ").toUpperCase());return p.length<=o?p.join(", "):`${p.slice(0,o).join(", ")} +${p.length-o} more`}function ze(t){if(!t)return"Never";const o=new Date(t),Y=new Date().getTime()-o.getTime(),j=Math.floor(Y/6e4),m=Math.floor(j/60),$=Math.floor(m/24);return j<60?`${j}m ago`:m<24?`${m}h ago`:`${$}d ago`}ha(()=>{_e()});let ke=ie(Ke);var we=Aa(),me=s(we),Ge=n(s(me),2),ne=s(Ge),ue=s(ne);ue.value=ue.__value="all";var Qe=n(ue);{var Xe=t=>{var o=ve(),p=J(o);ee(p,17,()=>Object.keys(e(y).by_cli),ae,(Y,j)=>{var m=ga(),$=s(m,!0);a(m);var V={};C(X=>{r($,X),V!==(V=e(j))&&(m.value=(m.__value=e(j))??"")},[()=>e(j).toUpperCase()]),i(Y,m)}),i(t,o)};G(Qe,t=>{e(y)&&t(Xe)})}a(ne);var oe=n(ne,2),fe=s(oe);fe.value=fe.__value="spawns";var ge=n(fe);ge.value=ge.__value="points";var $e=n(ge);$e.value=$e.__value="name",a(oe);var Ze=n(oe,2);Ze.__click=_e,a(Ge),a(me);var ea=n(me,2);{var aa=t=>{var o=ba();i(t,o)},sa=t=>{var o=ve(),p=J(o);{var Y=m=>{var $=ya(),V=s($),X=s(V);a(V),a($),C(()=>r(X,`ERROR: ${e(se)??""}`)),i(m,$)},j=m=>{var $=ve(),V=J($);{var X=be=>{var Me=Ma(),ye=J(Me),Ee=s(ye),Ae=s(Ee),ta=s(Ae,!0);a(Ae),Z(2),a(Ee);var xe=n(Ee,2),Le=s(xe),la=s(Le,!0);a(Le),Z(2),a(xe);var na=n(xe,2);ee(na,17,()=>Object.entries(e(y).by_cli).sort((c,l)=>l[1].spawns-c[1].spawns),ae,(c,l)=>{var d=ie(()=>Ve(e(l),2));let u=()=>e(d)[0],v=()=>e(d)[1];var h=Ea(),w=s(h),f=s(w,!0);a(w);var S=n(w,2),_=s(S);a(S),a(h),C((M,T,P)=>{K(h,`border-color: ${M??""}`),K(w,`color: ${T??""}`),r(f,v().spawns),r(_,`${P??""} SPAWNS`)},[()=>W(u()),()=>W(u()),()=>u().toUpperCase()]),i(c,h)}),a(ye);var Oe=n(ye,2),Re=n(s(Oe),2);ee(Re,21,()=>Object.entries(e(y).by_cli).sort((c,l)=>l[1].genomes-c[1].genomes),ae,(c,l)=>{var d=ie(()=>Ve(e(l),2));let u=()=>e(d)[0],v=()=>e(d)[1];const h=ie(()=>Math.max(...Object.values(e(y).by_cli).map(I=>I.genomes)));var w=xa(),f=s(w),S=s(f,!0);a(f);var _=n(f,2),M=s(_);a(_);var T=n(_,2),P=s(T);a(T),a(w),C((I,A,L)=>{K(f,`color: ${I??""}`),r(S,A),K(M,`width: ${v().genomes/e(h)*100}%; background: ${L??""}`),r(P,`${v().genomes??""} genomes / ${v().spawns??""} spawns / ${v().points??""} pts`)},[()=>W(u()),()=>u().toUpperCase(),()=>W(u())]),i(c,w)}),a(Re),a(Oe);var De=n(Oe,2);{var oa=c=>{var l=Na(),d=n(s(l),4);ee(d,21,()=>e(y).template_packs,ae,(u,v)=>{var h=Ia(),w=s(h),f=s(w),S=s(f,!0);a(f);var _=n(f,2),M=s(_);a(_),a(w);var T=n(w,2);{var P=g=>{var E=Oa(),k=s(E,!0);a(E),C(()=>r(k,e(v).description)),i(g,E)};G(T,g=>{e(v).description&&g(P)})}var I=n(T,2),A=n(s(I),2),L=s(A,!0);a(A),a(I);var B=n(I,2),O=n(s(B),2),R=s(O,!0);a(O),a(B);var D=n(B,2);{var H=g=>{var E=Ta(),k=n(s(E),2),re=s(k,!0);a(k),a(E),C(Ne=>r(re,Ne),[()=>he(e(v).missing_roles,8)]),i(g,E)};G(D,g=>{e(v).missing_roles.length>0&&g(H)})}a(h),C((g,E,k)=>{r(S,g),r(M,`${e(v).active_genome_count??""} active / ${e(v).muted_genome_count??""} muted`),r(L,E),r(R,k)},[()=>e(v).template.toUpperCase(),()=>he(e(v).active_roles),()=>he(e(v).muted_roles)]),i(u,h)}),a(d),a(l),i(c,l)};G(De,c=>{e(y).template_packs&&e(y).template_packs.length>0&&c(oa)})}var Ue=n(De,2),Te=s(Ue),Ie=s(Te),ra=s(Ie);a(Ie);var je=n(Ie,2);ee(je,21,()=>e(ke),ae,(c,l)=>{var d=Ca();let u;d.__click=()=>Ce(e(l)),d.__keydown=N=>N.key==="Enter"&&Ce(e(l));var v=s(d),h=s(v),w=s(h,!0);a(h);var f=n(h,2),S=s(f,!0);a(f);var _=n(f,2);let M;_.__click=N=>Je(e(l),N);var T=s(_);{var P=N=>{var q=Ye("...");i(N,q)},I=N=>{var q=Ye();C(()=>r(q,e(l).enabled?"ACTIVE":"MUTED")),i(N,q)};G(T,N=>{e(le)===e(l).name?N(P):N(I,!1)})}a(_),a(v);var A=n(v,2),L=s(A);let B;var O=s(L),R=s(O,!0);a(O),Z(2),a(L);var D=n(L,2);let H;var g=s(D),E=s(g,!0);a(g),Z(2),a(D);var k=n(D,2),re=s(k),Ne=s(re,!0);a(re),Z(2),a(k),a(A);var Fe=n(A,2),Be=s(Fe),da=s(Be);a(Be),a(Fe),a(d),C((N,q,pa,_a)=>{u=ce(d,1,"genome-item svelte-95wonh",null,u,{selected:e(U)?.name===e(l).name,active:e(l).spawns_today>0||e(l).points_earned>0,disabled:!e(l).enabled}),K(h,`color: ${N??""}`),r(w,q),r(S,pa),M=ce(_,1,"toggle-btn svelte-95wonh",null,M,{enabled:e(l).enabled,loading:e(le)===e(l).name}),ua(_,"title",e(l).enabled?"Click to mute genome globally":"Click to activate genome globally"),B=ce(L,1,"metric svelte-95wonh",null,B,{highlight:e(l).spawns_today>0}),r(R,e(l).spawns_today),H=ce(D,1,"metric svelte-95wonh",null,H,{highlight:e(l).points_earned>0}),r(E,e(l).points_earned),r(Ne,e(l).decisions),r(da,`LAST: ${_a??""}`)},[()=>W(e(l).cli),()=>e(l).cli.toUpperCase(),()=>Se(e(l).name,e(l).cli),()=>ze(e(l).last_active)]),i(c,d)}),a(je),a(Te);var Pe=n(Te,2),va=n(s(Pe),2);{var ia=c=>{var l=Ga(),d=J(l),u=s(d),v=s(u),h=s(v,!0);a(v);var w=n(v,2),f=s(w,!0);a(w),a(u);var S=n(u,2),_=s(S),M=s(_);a(_);var T=n(_,2),P=s(T);a(T),a(S),a(d);var I=n(d,2),A=s(I);{var L=O=>{var R=Sa();i(O,R)},B=O=>{var R=ve(),D=J(R);{var H=g=>{var E=ka(),k=s(E,!0);a(E),C(()=>r(k,e(Q))),i(g,E)};G(D,g=>{e(Q)&&g(H)},!0)}i(O,R)};G(A,O=>{e(pe)?O(L):O(B,!1)})}a(I),C((O,R,D)=>{K(v,`color: ${O??""}`),r(h,R),r(f,D),r(M,`${e(U).spawns_today??""} spawns today`),r(P,`${e(U).points_earned??""} points`)},[()=>W(e(U).cli),()=>e(U).cli.toUpperCase(),()=>Se(e(U).name,e(U).cli)]),i(c,l)},ca=c=>{var l=$a();i(c,l)};G(va,c=>{e(U)?c(ia):c(ca,!1)})}a(Pe),a(Ue),C(()=>{r(ta,e(y).total_genomes),r(la,e(y).active_today),r(ra,`GENOMES (${e(ke).length??""})`)}),i(be,Me)};G(V,be=>{e(y)&&be(X)},!0)}i(m,$)};G(p,m=>{e(se)?m(Y):m(j,!1)},!0)}i(t,o)};G(ea,t=>{e(de)&&!e(y)?t(aa):t(sa,!1)})}a(we),We(ne,()=>e(te),t=>x(te,t)),We(oe,()=>e(z),t=>x(z,t)),i(He,we),ma()}fa(["click","keydown"]);export{Ha as component};

import{f,a as u,c as ys}from"../chunks/CZY_NlAX.js";import{o as As}from"../chunks/BHyL2apj.js";import{ag as Ns,ak as t,an as A,ai as Rs,G as N,aj as q,al as e,am as s,m as a,ah as Ua,ao as P,aq as Va,ar as Cs}from"../chunks/CHIrzwsT.js";import{s as v}from"../chunks/DsvTbyZG.js";import{i as R}from"../chunks/DNv7RG3c.js";import{e as fa,i as ma}from"../chunks/De-eo5w8.js";import{s as ga}from"../chunks/Bf116p4L.js";import{s as I}from"../chunks/U6XQp83X.js";import{d as Is}from"../chunks/CaHQap0G.js";import{s as z}from"../chunks/CuoGBMhC.js";var Os=f('<div class="loading svelte-c59208">SCANNING_AGENT_REGISTRY...</div>'),ws=f('<div class="info-item governor svelte-c59208"><span class="info-label svelte-c59208">GOVERNOR</span> <span class="info-value svelte-c59208"> </span></div>'),Fs=f('<div role="button" tabindex="0"><div class="lab-header svelte-c59208"><span class="lab-badge"> </span> <span class="lab-name"> </span></div> <div class="lab-stats svelte-c59208"><div class="lab-stat svelte-c59208"><span class="lab-stat-value yellow svelte-c59208"> </span> <span class="lab-stat-label svelte-c59208">POINTS</span></div> <div class="lab-stat svelte-c59208"><span class="lab-stat-value svelte-c59208"> </span> <span class="lab-stat-label svelte-c59208">FITNESS</span></div></div></div>'),Ls=f('<div class="card"><h2>LAB_PERFORMANCE // BY_UNIT</h2> <div class="lab-grid svelte-c59208"></div></div>'),$s=f('<button class="brutal-btn"> </button>'),Gs=f('<p class="hint svelte-c59208">No agents found. The arena is empty.</p>'),Ds=f('<div><span class="col-rank"><span> </span></span> <span class="col-agent svelte-c59208"><span class="agent-badge svelte-c59208"> </span> <span class="agent-id svelte-c59208" style="color: var(--lab-color)"> </span></span> <span class="col-lab"><span class="lab-badge-small svelte-c59208"> </span></span> <span class="col-role svelte-c59208"> </span> <span class="col-points yellow svelte-c59208"> </span> <span class="col-fitness svelte-c59208"> </span> <span class="col-tasks svelte-c59208"><span class="tasks-completed svelte-c59208"> </span> <span class="tasks-sep svelte-c59208">/</span> <span class="tasks-attempted svelte-c59208"> </span></span> <span> </span> <span class="col-tokens svelte-c59208"> </span> <span class="col-active svelte-c59208"> </span></div>'),Ms=f('<div class="leaderboard-table svelte-c59208"><div class="leaderboard-row header svelte-c59208"><span class="col-rank">#</span> <span class="col-agent svelte-c59208">AGENT</span> <span class="col-lab">LAB</span> <span class="col-role svelte-c59208">ROLE</span> <span class="col-points svelte-c59208">POINTS</span> <span class="col-fitness svelte-c59208">FITNESS</span> <span class="col-tasks svelte-c59208">TASKS</span> <span class="col-success svelte-c59208">SUCCESS</span> <span class="col-tokens svelte-c59208">TOKENS</span> <span class="col-active svelte-c59208">LAST_ACTIVE</span></div> <!></div>'),Ps=f('<span class="event-agent svelte-c59208"> </span>'),Bs=f("<span> </span>"),Us=f('<span class="event-reason svelte-c59208"> </span>'),Vs=f('<div class="event-item svelte-c59208"><span class="event-time svelte-c59208"> </span> <span class="event-type svelte-c59208"> </span> <!> <!> <!></div>'),js=f('<div class="card"><h2>RECENT_EVENTS // ACTIVITY_LOG</h2> <div class="events-list svelte-c59208"></div></div>'),Ks=f('<div class="info-bar svelte-c59208"><div class="info-item svelte-c59208"><span class="info-label svelte-c59208">SEASON</span> <span class="info-value svelte-c59208"> </span></div> <!> <div class="info-item svelte-c59208"><span class="info-label svelte-c59208">UPDATED</span> <span class="info-value svelte-c59208"> </span></div></div> <div class="analytics-grid svelte-c59208"><div class="analytics-card svelte-c59208"><div class="analytics-value svelte-c59208"> </div> <div class="analytics-label svelte-c59208">TOTAL_AGENTS</div></div> <div class="analytics-card svelte-c59208"><div class="analytics-value yellow svelte-c59208"> </div> <div class="analytics-label svelte-c59208">TOTAL_POINTS</div></div> <div class="analytics-card svelte-c59208"><div class="analytics-value cyan svelte-c59208"> </div> <div class="analytics-label svelte-c59208">AVG_FITNESS</div></div> <div class="analytics-card svelte-c59208"><div class="analytics-value svelte-c59208"> </div> <div class="analytics-label svelte-c59208">ACTIVE_LABS</div></div></div> <!> <div class="controls-bar svelte-c59208"><div class="sort-controls svelte-c59208"><span class="control-label svelte-c59208">SORT_BY:</span> <button>POINTS</button> <button>FITNESS</button> <button>TASKS</button> <button>SUCCESS_RATE</button></div> <!></div> <div class="card leaderboard-card svelte-c59208"><h2> </h2> <!></div> <!>',1),Ys=f('<div class="page svelte-c59208"><div class="page-header svelte-c59208"><h2 class="glitch">Swarm Leaderboard // Agent Rankings</h2> <div class="header-controls svelte-c59208"><button class="brutal-btn"> </button></div></div> <!></div>');function tt(ja,Ka){Ns(Ka,!0);let p=q(null),B=q(!0),C=q("points"),S=q(null);const Sa={CC:"#c9a227",OC:"var(--terminal-green)",CX:"var(--cyan-data)",GE:"var(--warning)",GR:"var(--system-red)"};async function W(){N(B,!0);try{const l=await fetch("/api/leaderboard");l.ok&&N(p,await l.json(),!0)}catch(l){console.error("Failed to fetch leaderboard:",l)}finally{N(B,!1)}}function Ta(l){if(!l)return"--";const _=new Date(l),U=new Date().getTime()-_.getTime(),$=Math.floor(U/6e4),V=Math.floor(U/36e5),j=Math.floor(U/864e5);return $<60?`${$}m ago`:V<24?`${V}h ago`:`${j}d ago`}function Ya(l){return l>=1e6?`${(l/1e6).toFixed(1)}M`:l>=1e3?`${(l/1e3).toFixed(1)}K`:l.toString()}function Ha(l){return l===0?"1ST":l===1?"2ND":l===2?"3RD":`${l+1}TH`}function Ea(l){return l===null?"var(--text-muted)":l>=80?"var(--terminal-green)":l>=60?"var(--cyan-data)":l>=40?"var(--warning)":"var(--system-red)"}const X=Va(()=>()=>{if(!a(p))return[];let l=[...a(p).entries];switch(a(S)&&(l=l.filter(_=>_.lab===a(S))),a(C)){case"fitness":l.sort((_,x)=>(x.fitnessScore??0)-(_.fitnessScore??0));break;case"tasks":l.sort((_,x)=>x.tasksCompleted-_.tasksCompleted);break;case"success":l.sort((_,x)=>x.successRate-_.successRate);break;default:l.sort((_,x)=>x.points-_.points)}return l});As(()=>{W();const l=setInterval(W,6e4);return()=>clearInterval(l)});var J=Ys(),Q=t(J),xa=e(t(Q),2),Y=t(xa);Y.__click=W;var qa=t(Y,!0);s(Y),s(xa),s(Q);var za=e(Q,2);{var Wa=l=>{var _=Os();u(l,_)},Xa=l=>{var _=ys(),x=Ua(_);{var U=$=>{var V=Ks(),j=Ua(V),Z=t(j),ha=e(t(Z),2),Ja=t(ha,!0);s(ha),s(Z);var ka=e(Z,2);{var Qa=n=>{var c=ws(),m=e(t(c),2),E=t(m,!0);s(m),s(c),A(()=>v(E,a(p).governor)),u(n,c)};R(ka,n=>{a(p).governor&&n(Qa)})}var ya=e(ka,2),Aa=e(t(ya),2),Za=t(Aa,!0);s(Aa),s(ya),s(j);var aa=e(j,2),sa=t(aa),Na=t(sa),as=t(Na,!0);s(Na),P(2),s(sa);var ta=e(sa,2),Ra=t(ta),ss=t(Ra,!0);s(Ra),P(2),s(ta);var ea=e(ta,2),Ca=t(ea),ts=t(Ca,!0);s(Ca),P(2),s(ea);var Ia=e(ea,2),Oa=t(Ia),es=t(Oa,!0);s(Oa),P(2),s(Ia),s(aa);var wa=e(aa,2);{var ls=n=>{var c=Ls(),m=e(t(c),2);fa(m,21,()=>Object.entries(a(p).analytics.byLab).sort((E,r)=>r[1].points-E[1].points),ma,(E,r)=>{var g=Va(()=>Cs(a(r),2));let d=()=>a(g)[0],h=()=>a(g)[1];var b=Fs();let G;b.__click=()=>N(S,a(S)===d()?null:d(),!0),b.__keydown=w=>w.key==="Enter"&&N(S,a(S)===d()?null:d(),!0);var k=t(b),y=t(k),D=t(y,!0);s(y);var F=e(y,2),K=t(F);s(F),s(k);var O=e(k,2),i=t(O),o=t(i),T=t(o,!0);s(o),P(2),s(i);var M=e(i,2),L=t(M),da=t(L,!0);s(L),P(2),s(M),s(O),s(b),A((w,pa)=>{G=I(b,1,"lab-card svelte-c59208",null,G,{active:a(S)===d()}),z(b,`--lab-color: ${(Sa[d()]||"var(--terminal-green)")??""}`),ga(y,"data-lab",d()),v(D,d()),v(K,`${h().agents??""} AGENTS`),v(T,h().points),z(L,`color: ${w??""}`),v(da,pa)},[()=>Ea(h().avgFitness),()=>h().avgFitness.toFixed(1)]),u(E,b)}),s(m),s(c),u(n,c)};R(wa,n=>{Object.keys(a(p).analytics.byLab).length>0&&n(ls)})}var la=e(wa,2),ra=t(la),va=e(t(ra),2);let Fa;va.__click=()=>N(C,"points");var na=e(va,2);let La;na.__click=()=>N(C,"fitness");var ca=e(na,2);let $a;ca.__click=()=>N(C,"tasks");var Ga=e(ca,2);let Da;Ga.__click=()=>N(C,"success"),s(ra);var rs=e(ra,2);{var vs=n=>{var c=$s();c.__click=()=>N(S,null);var m=t(c);s(c),A(()=>v(m,`CLEAR_FILTER: ${a(S)??""}`)),u(n,c)};R(rs,n=>{a(S)&&n(vs)})}s(la);var ia=e(la,2),oa=t(ia),ns=t(oa);s(oa);var cs=e(oa,2);{var is=n=>{var c=Gs();u(n,c)},os=n=>{var c=Ms(),m=e(t(c),2);fa(m,17,()=>a(X)(),ma,(E,r,g)=>{var d=Ds();I(d,1,"leaderboard-row svelte-c59208",null,{},{"top-3":g<3,first:g===0});var h=t(d),b=t(h);I(b,1,"rank-badge svelte-c59208",null,{},{gold:g===0,silver:g===1,bronze:g===2});var G=t(b,!0);s(b),s(h);var k=e(h,2),y=t(k),D=t(y,!0);s(y);var F=e(y,2),K=t(F,!0);s(F),s(k);var O=e(k,2),i=t(O),o=t(i,!0);s(i),s(O);var T=e(O,2),M=t(T,!0);s(T);var L=e(T,2),da=t(L,!0);s(L);var w=e(L,2),pa=t(w,!0);s(w);var _a=e(w,2),ua=t(_a),_s=t(ua,!0);s(ua);var Ma=e(ua,4),us=t(Ma,!0);s(Ma),s(_a);var H=e(_a,2);let Pa;var bs=t(H);s(H);var ba=e(H,2),fs=t(ba,!0);s(ba);var Ba=e(ba,2),ms=t(Ba,!0);s(Ba),s(d),A((gs,Ss,Ts,Es,xs,hs,ks)=>{z(d,`--lab-color: ${(Sa[a(r).lab||""]||"var(--terminal-green)")??""}`),v(G,gs),v(D,a(r).badge),v(K,a(r).id),ga(i,"data-lab",a(r).lab),v(o,a(r).lab||"--"),v(M,Ss),v(da,a(r).points),z(w,`color: ${Ts??""}`),v(pa,Es),v(_s,a(r).tasksCompleted),v(us,a(r).tasksAttempted),Pa=I(H,1,"col-success svelte-c59208",null,Pa,{high:a(r).successRate>=80,medium:a(r).successRate>=50&&a(r).successRate<80,low:a(r).successRate<50}),v(bs,`${xs??""}%`),v(fs,hs),v(ms,ks)},[()=>Ha(g),()=>a(r).role?.toUpperCase()||"--",()=>Ea(a(r).fitnessScore),()=>a(r).fitnessScore!==null?a(r).fitnessScore.toFixed(1):"--",()=>a(r).successRate.toFixed(0),()=>Ya(a(r).totalTokens),()=>Ta(a(r).lastActive)]),u(E,d)}),s(c),u(n,c)};R(cs,n=>{a(X)().length===0?n(is):n(os,!1)})}s(ia);var ds=e(ia,2);{var ps=n=>{var c=js(),m=e(t(c),2);fa(m,21,()=>a(p).recentEvents,ma,(E,r)=>{var g=Vs(),d=t(g),h=t(d);s(d);var b=e(d,2),G=t(b,!0);s(b);var k=e(b,2);{var y=i=>{var o=Ps(),T=t(o,!0);s(o),A(()=>v(T,a(r).agent)),u(i,o)};R(k,i=>{a(r).agent&&i(y)})}var D=e(k,2);{var F=i=>{var o=Bs();let T;var M=t(o);s(o),A(()=>{T=I(o,1,"event-points svelte-c59208",null,T,{positive:a(r).points>0,negative:a(r).points<0}),v(M,`${a(r).points>0?"+":""}${a(r).points??""} PTS`)}),u(i,o)};R(D,i=>{a(r).points&&i(F)})}var K=e(D,2);{var O=i=>{var o=Us(),T=t(o,!0);s(o),A(()=>v(T,a(r).reason)),u(i,o)};R(K,i=>{a(r).reason&&i(O)})}s(g),A((i,o)=>{ga(g,"data-type",a(r).type),v(h,`[${i??""}]`),v(G,o)},[()=>a(r).time.slice(11,19),()=>a(r).type.toUpperCase()]),u(E,g)}),s(m),s(c),u(n,c)};R(ds,n=>{a(p).recentEvents.length>0&&n(ps)})}A((n,c,m,E,r)=>{v(Ja,n),v(Za,c),v(as,a(p).analytics.totalAgents),v(ss,a(p).analytics.totalPoints),v(ts,m),v(es,E),Fa=I(va,1,"sort-btn svelte-c59208",null,Fa,{active:a(C)==="points"}),La=I(na,1,"sort-btn svelte-c59208",null,La,{active:a(C)==="fitness"}),$a=I(ca,1,"sort-btn svelte-c59208",null,$a,{active:a(C)==="tasks"}),Da=I(Ga,1,"sort-btn svelte-c59208",null,Da,{active:a(C)==="success"}),v(ns,`AGENT_RANKINGS // ${r??""} ENTRIES ${a(S)?`[${a(S)}]`:""}`)},[()=>a(p).season?.replace("week_","WEEK_")||"ACTIVE",()=>Ta(a(p).lastUpdated),()=>a(p).analytics.avgFitness.toFixed(1),()=>Object.keys(a(p).analytics.byLab).length,()=>a(X)().length]),u($,V)};R(x,$=>{a(p)&&$(U)},!0)}u(l,_)};R(za,l=>{a(B)&&!a(p)?l(Wa):l(Xa,!1)})}s(J),A(()=>{Y.disabled=a(B),v(qa,a(B)?"SYNCING...":"REFRESH")}),u(ja,J),Rs()}Is(["click","keydown"]);export{tt as component};

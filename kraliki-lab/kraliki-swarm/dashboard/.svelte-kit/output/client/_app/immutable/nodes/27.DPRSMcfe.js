import{f as d,a as o,c as Ge}from"../chunks/CZY_NlAX.js";import{o as Qe}from"../chunks/BHyL2apj.js";import{ag as Xe,aj as K,ap as ze,ak as a,al as s,m as t,ai as Ze,G as w,am as e,ah as Ae,ao as te,an as u,aq as ea,ar as aa}from"../chunks/CHIrzwsT.js";import{s as c}from"../chunks/DsvTbyZG.js";import{i as f}from"../chunks/DNv7RG3c.js";import{e as Ce,i as Se}from"../chunks/De-eo5w8.js";import{s as sa}from"../chunks/Bf116p4L.js";import{s as ta}from"../chunks/U6XQp83X.js";import{d as la}from"../chunks/CaHQap0G.js";import{s as q}from"../chunks/CuoGBMhC.js";import{b as Me}from"../chunks/_ujM_1n3.js";var va=d('<div class="type-bar svelte-n4cblv"><span class="type-name svelte-n4cblv"> </span> <div class="bar-container svelte-n4cblv"><div class="bar-fill svelte-n4cblv"></div></div> <span class="type-count svelte-n4cblv"> </span></div>'),na=d('<div class="stats-grid svelte-n4cblv"><div class="stat-card svelte-n4cblv"><span class="stat-value svelte-n4cblv"> </span> <span class="stat-label svelte-n4cblv">TOTAL TRACES</span></div> <div class="stat-card svelte-n4cblv"><span class="stat-value svelte-n4cblv"> </span> <span class="stat-label svelte-n4cblv">DECISION TYPES</span></div> <div class="stat-card svelte-n4cblv"><span class="stat-value svelte-n4cblv"> </span> <span class="stat-label svelte-n4cblv">UNIQUE AGENTS</span></div> <div class="stat-card svelte-n4cblv"><span class="stat-value svelte-n4cblv"> </span> <span class="stat-label svelte-n4cblv">GENOMES</span></div></div> <div class="type-breakdown svelte-n4cblv"><h3 class="svelte-n4cblv">BY DECISION TYPE</h3> <div class="type-bars svelte-n4cblv"></div></div>',1),ia=d('<div class="loading-state svelte-n4cblv"><span class="loading-text svelte-n4cblv">LOADING_TRACES...</span></div>'),ra=d('<div class="error-state svelte-n4cblv"><span class="error-text svelte-n4cblv"> </span></div>'),ca=d('<div class="empty-state svelte-n4cblv"><span class="empty-text svelte-n4cblv">NO_TRACES_FOUND</span></div>'),oa=d('<div class="trace-outcome svelte-n4cblv"> </div>'),da=d('<button><div class="trace-header svelte-n4cblv"><span class="trace-type svelte-n4cblv"> </span> <span class="trace-time svelte-n4cblv"> </span></div> <div class="trace-agent svelte-n4cblv"> </div> <div class="trace-decision svelte-n4cblv"> </div> <!></button>'),_a=d('<div class="trace-items svelte-n4cblv"></div>'),pa=d('<div class="detail-row svelte-n4cblv"><span class="detail-label svelte-n4cblv">GENOME</span> <span class="detail-value svelte-n4cblv"> </span></div>'),ba=d('<div class="detail-row svelte-n4cblv"><span class="detail-label svelte-n4cblv">CLI</span> <span class="detail-value svelte-n4cblv"> </span></div>'),ua=d('<div class="detail-row svelte-n4cblv"><span class="detail-label svelte-n4cblv">LINEAR</span> <a target="_blank" class="detail-link svelte-n4cblv"> </a></div>'),fa=d('<li class="svelte-n4cblv"> </li>'),ma=d('<div class="detail-section svelte-n4cblv"><span class="detail-label svelte-n4cblv">ALTERNATIVES</span> <ul class="alternatives-list svelte-n4cblv"></ul></div>'),ga=d('<div class="detail-row svelte-n4cblv"><span class="detail-label svelte-n4cblv">CONFIDENCE</span> <div class="confidence-bar svelte-n4cblv"><div class="confidence-fill svelte-n4cblv"></div> <span class="confidence-text svelte-n4cblv"> </span></div></div>'),Ea=d('<div class="detail-row svelte-n4cblv"><span class="detail-label svelte-n4cblv">OUTCOME</span> <span class="detail-value outcome svelte-n4cblv"> </span></div>'),Ta=d('<div class="detail-row svelte-n4cblv"><span class="detail-label svelte-n4cblv">DURATION</span> <span class="detail-value svelte-n4cblv"> </span></div>'),xa=d('<div class="detail-section svelte-n4cblv"><span class="detail-label svelte-n4cblv">CONTEXT</span> <pre class="context-json svelte-n4cblv"> </pre></div>'),ha=d('<div class="detail-content svelte-n4cblv"><div class="detail-row svelte-n4cblv"><span class="detail-label svelte-n4cblv">TRACE_ID</span> <span class="detail-value mono svelte-n4cblv"> </span></div> <div class="detail-row svelte-n4cblv"><span class="detail-label svelte-n4cblv">TIMESTAMP</span> <span class="detail-value svelte-n4cblv"> </span></div> <div class="detail-row svelte-n4cblv"><span class="detail-label svelte-n4cblv">AGENT</span> <span class="detail-value mono svelte-n4cblv"> </span></div> <!> <!> <!> <div class="detail-section svelte-n4cblv"><span class="detail-label svelte-n4cblv">DECISION</span> <div class="detail-text svelte-n4cblv"> </div></div> <div class="detail-section svelte-n4cblv"><span class="detail-label svelte-n4cblv">REASONING</span> <div class="detail-text svelte-n4cblv"> </div></div> <!> <!> <!> <!> <!></div>'),ya=d('<div class="empty-detail svelte-n4cblv"><span class="empty-text svelte-n4cblv">SELECT A TRACE TO VIEW DETAILS</span></div>'),Oa=d('<div class="page svelte-n4cblv"><div class="page-header svelte-n4cblv"><h2 class="glitch svelte-n4cblv">Decision Traces // Agent Observability</h2> <div class="controls svelte-n4cblv"><select class="filter-select svelte-n4cblv"><option class="svelte-n4cblv">ALL TYPES</option><option class="svelte-n4cblv">SPAWN</option><option class="svelte-n4cblv">TASK_SELECTION</option><option class="svelte-n4cblv">IMPL_STRATEGY</option><option class="svelte-n4cblv">TOOL_CHOICE</option><option class="svelte-n4cblv">COMPLETION</option><option class="svelte-n4cblv">ERROR_HANDLING</option><option class="svelte-n4cblv">CLAIM</option><option class="svelte-n4cblv">SKIP</option><option class="svelte-n4cblv">DELEGATE</option><option class="svelte-n4cblv">ABORT</option></select> <select class="filter-select svelte-n4cblv"><option class="svelte-n4cblv">25 TRACES</option><option class="svelte-n4cblv">50 TRACES</option><option class="svelte-n4cblv">100 TRACES</option><option class="svelte-n4cblv">200 TRACES</option></select> <button class="brutal-btn svelte-n4cblv">REFRESH</button></div></div> <!> <div class="content-grid svelte-n4cblv"><div class="traces-list card svelte-n4cblv"><h3 class="svelte-n4cblv">RECENT DECISIONS</h3> <!></div> <div class="trace-detail card svelte-n4cblv"><h3 class="svelte-n4cblv">TRACE DETAIL</h3> <!></div></div></div>');function Ga(Pe,je){Xe(je,!0);let le=K(ze([])),k=K(null),ve=K(!0),ee=K(null),i=K(null),ae=K(""),$e="",ne=K(50);async function se(){w(ve,!0),w(ee,null);try{const l=new URLSearchParams;t(ae)&&l.set("type",t(ae)),l.set("limit",t(ne).toString());const g=await(await fetch(`/api/traces?${l}`)).json();w(le,g.traces||[],!0),w(k,g.stats||null,!0)}catch(l){w(ee,l instanceof Error?l.message:"Failed to load traces",!0)}finally{w(ve,!1)}}function Ie(l){return new Date(l).toLocaleString("en-US",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit"})}function ie(l){return{spawn:"#33ff00",task_selection:"#00d4ff",implementation_strategy:"#ff9500",tool_choice:"#9d4edd",error_handling:"#ff4444",completion:"#33ff00",claim:"#00d4ff",skip:"#6b7280",delegate:"#ff9500",abort:"#ff4444"}[l]||"#6b7280"}function Ne(l){return l&&{success:"#33ff00",complete:"#33ff00",partial:"#ff9500",failure:"#ff4444",error:"#ff4444",pending:"#6b7280"}[l.toLowerCase()]||"#6b7280"}Qe(()=>{se()});var re=Oa(),ce=a(re),Re=s(a(ce),2),J=a(Re);J.__change=se;var oe=a(J);oe.value=oe.__value="";var de=s(oe);de.value=de.__value="spawn";var _e=s(de);_e.value=_e.__value="task_selection";var pe=s(_e);pe.value=pe.__value="implementation_strategy";var be=s(pe);be.value=be.__value="tool_choice";var ue=s(be);ue.value=ue.__value="completion";var fe=s(ue);fe.value=fe.__value="error_handling";var me=s(fe);me.value=me.__value="claim";var ge=s(me);ge.value=ge.__value="skip";var Ee=s(ge);Ee.value=Ee.__value="delegate";var Le=s(Ee);Le.value=Le.__value="abort",e(J);var Q=s(J,2);Q.__change=se;var Te=a(Q);Te.value=Te.__value=25;var xe=s(Te);xe.value=xe.__value=50;var he=s(xe);he.value=he.__value=100;var we=s(he);we.value=we.__value=200,e(Q);var Fe=s(Q,2);Fe.__click=se,e(Re),e(ce);var ke=s(ce,2);{var Ye=l=>{var _=na(),g=Ae(_),D=a(g),V=a(D),E=a(V,!0);e(V),te(2),e(D);var m=s(D,2),C=a(m),S=a(C,!0);e(C),te(2),e(m);var U=s(m,2),x=a(U),O=a(x,!0);e(x),te(2),e(U);var W=s(U,2),p=a(W),I=a(p,!0);e(p),te(2),e(W),e(g);var G=s(g,2),M=s(a(G),2);Ce(M,21,()=>Object.entries(t(k).by_type),Se,(T,P)=>{var N=ea(()=>aa(t(P),2));let R=()=>t(N)[0],L=()=>t(N)[1];var Y=va(),h=a(Y),X=a(h,!0);e(h);var j=s(h,2),z=a(j);e(j);var y=s(j,2),A=a(y,!0);e(y),e(Y),u(($,H,Z)=>{q(h,`color: ${$??""}`),c(X,H),q(z,`width: ${L()/t(k).total_traces*100}%; background: ${Z??""}`),c(A,L())},[()=>ie(R()),()=>R().toUpperCase(),()=>ie(R())]),o(T,Y)}),e(M),e(G),u((T,P,N)=>{c(E,t(k).total_traces),c(S,T),c(O,P),c(I,N)},[()=>Object.keys(t(k).by_type).length,()=>Object.keys(t(k).by_agent).length,()=>Object.keys(t(k).by_genome).length]),o(l,_)};f(ke,l=>{t(k)&&l(Ye)})}var De=s(ke,2),ye=a(De),He=s(a(ye),2);{var Be=l=>{var _=ia();o(l,_)},Ke=l=>{var _=Ge(),g=Ae(_);{var D=E=>{var m=ra(),C=a(m),S=a(C);e(C),e(m),u(()=>c(S,`ERROR: ${t(ee)??""}`)),o(E,m)},V=E=>{var m=Ge(),C=Ae(m);{var S=x=>{var O=ca();o(x,O)},U=x=>{var O=_a();Ce(O,21,()=>t(le).slice().reverse(),Se,(W,p)=>{var I=da();let G;I.__click=()=>w(i,t(p),!0);var M=a(I),T=a(M),P=a(T,!0);e(T);var N=s(T,2),R=a(N,!0);e(N),e(M);var L=s(M,2),Y=a(L,!0);e(L);var h=s(L,2),X=a(h);e(h);var j=s(h,2);{var z=y=>{var A=oa(),$=a(A,!0);e(A),u((H,Z)=>{q(A,`color: ${H??""}`),c($,Z)},[()=>Ne(t(p).outcome),()=>t(p).outcome.toUpperCase()]),o(y,A)};f(j,y=>{t(p).outcome&&y(z)})}e(I),u((y,A,$,H)=>{G=ta(I,1,"trace-item svelte-n4cblv",null,G,{selected:t(i)?.trace_id===t(p).trace_id}),q(T,`color: ${y??""}`),c(P,A),c(R,$),c(Y,t(p).agent_id),c(X,`${H??""}...`)},[()=>ie(t(p).decision_type),()=>t(p).decision_type.toUpperCase(),()=>Ie(t(p).timestamp),()=>t(p).decision.slice(0,80)]),o(W,I)}),e(O),o(x,O)};f(C,x=>{t(le).length===0?x(S):x(U,!1)},!0)}o(E,m)};f(g,E=>{t(ee)?E(D):E(V,!1)},!0)}o(l,_)};f(He,l=>{t(ve)?l(Be):l(Ke,!1)})}e(ye);var Ue=s(ye,2),Ve=s(a(Ue),2);{var We=l=>{var _=ha(),g=a(_),D=s(a(g),2),V=a(D,!0);e(D),e(g);var E=s(g,2),m=s(a(E),2),C=a(m,!0);e(m),e(E);var S=s(E,2),U=s(a(S),2),x=a(U,!0);e(U),e(S);var O=s(S,2);{var W=v=>{var n=pa(),r=s(a(n),2),b=a(r,!0);e(r),e(n),u(()=>c(b,t(i).genome)),o(v,n)};f(O,v=>{t(i).genome&&v(W)})}var p=s(O,2);{var I=v=>{var n=ba(),r=s(a(n),2),b=a(r,!0);e(r),e(n),u(()=>c(b,t(i).cli)),o(v,n)};f(p,v=>{t(i).cli&&v(I)})}var G=s(p,2);{var M=v=>{var n=ua(),r=s(a(n),2),b=a(r,!0);e(r),e(n),u(()=>{sa(r,"href",`https://linear.app/verduona/issue/${t(i).linear_issue??""}`),c(b,t(i).linear_issue)}),o(v,n)};f(G,v=>{t(i).linear_issue&&v(M)})}var T=s(G,2),P=s(a(T),2),N=a(P,!0);e(P),e(T);var R=s(T,2),L=s(a(R),2),Y=a(L,!0);e(L),e(R);var h=s(R,2);{var X=v=>{var n=ma(),r=s(a(n),2);Ce(r,21,()=>t(i).alternatives,Se,(b,F)=>{var B=fa(),Oe=a(B,!0);e(B),u(()=>c(Oe,t(F))),o(b,B)}),e(r),e(n),o(v,n)};f(h,v=>{t(i).alternatives.length>0&&v(X)})}var j=s(h,2);{var z=v=>{var n=ga(),r=s(a(n),2),b=a(r),F=s(b,2),B=a(F);e(F),e(r),e(n),u(Oe=>{q(b,`width: ${t(i).confidence*100}%`),c(B,`${Oe??""}%`)},[()=>(t(i).confidence*100).toFixed(0)]),o(v,n)};f(j,v=>{t(i).confidence>0&&v(z)})}var y=s(j,2);{var A=v=>{var n=Ea(),r=s(a(n),2),b=a(r,!0);e(r),e(n),u((F,B)=>{q(r,`color: ${F??""}`),c(b,B)},[()=>Ne(t(i).outcome),()=>t(i).outcome.toUpperCase()]),o(v,n)};f(y,v=>{t(i).outcome&&v(A)})}var $=s(y,2);{var H=v=>{var n=Ta(),r=s(a(n),2),b=a(r);e(r),e(n),u(()=>c(b,`${t(i).duration_ms??""}ms`)),o(v,n)};f($,v=>{t(i).duration_ms&&v(H)})}var Z=s($,2);{var Je=v=>{var n=xa(),r=s(a(n),2),b=a(r,!0);e(r),e(n),u(F=>c(b,F),[()=>JSON.stringify(t(i).context,null,2)]),o(v,n)};f(Z,v=>{Object.keys(t(i).context).length>0&&v(Je)})}e(_),u(v=>{c(V,t(i).trace_id),c(C,v),c(x,t(i).agent_id),c(N,t(i).decision),c(Y,t(i).reasoning)},[()=>Ie(t(i).timestamp)]),o(l,_)},qe=l=>{var _=ya();o(l,_)};f(Ve,l=>{t(i)?l(We):l(qe,!1)})}e(Ue),e(De),e(re),Me(J,()=>t(ae),l=>w(ae,l)),Me(Q,()=>t(ne),l=>w(ne,l)),o(Pe,re),Ze()}la(["change","click"]);export{Ga as component};

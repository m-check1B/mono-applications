import{f as n,a as r,c as O}from"../chunks/CZY_NlAX.js";import{o as jt}from"../chunks/BHyL2apj.js";import{ag as Kt,aj as N,ap as yt,ak as s,G as f,al as v,an as y,ai as Bt,am as a,m as t,aq as qt,ah as H}from"../chunks/CHIrzwsT.js";import{s as l}from"../chunks/DsvTbyZG.js";import{i as p}from"../chunks/DNv7RG3c.js";import{e as _t,i as bt}from"../chunks/De-eo5w8.js";import{s as Jt}from"../chunks/Bf116p4L.js";import{s as ft}from"../chunks/U6XQp83X.js";import{d as Pt}from"../chunks/CaHQap0G.js";import{s as pt}from"../chunks/CuoGBMhC.js";var Wt=n('<span class="critical-badge svelte-4b134t"> </span>'),Qt=n('<div class="loading svelte-4b134t">LOADING_HUMAN_BLOCKERS...</div>'),Vt=n('<div class="empty success svelte-4b134t">NO_BLOCKERS - All clear for human work queue!</div>'),zt=n('<span class="blocker-time svelte-4b134t"> </span>'),Xt=n('<span class="blocker-notes svelte-4b134t"> </span>'),Yt=n('<div><div class="blocker-header svelte-4b134t"><span class="blocker-id svelte-4b134t"> </span> <span class="blocker-priority svelte-4b134t"> </span></div> <div class="blocker-task svelte-4b134t"> </div> <div class="blocker-meta svelte-4b134t"><!> <!></div> <div class="blocker-actions svelte-4b134t"><button class="brutal-btn done-btn svelte-4b134t"> </button></div></div>'),Zt=n('<div class="blockers-list svelte-4b134t"></div>'),$t=n('<div class="loading svelte-4b134t">FETCHING_LINEAR_ISSUES...</div>'),ta=n('<div class="error svelte-4b134t"> </div>'),aa=n('<div class="empty svelte-4b134t">No active issues found</div>'),ea=n('<span class="issue-label svelte-4b134t"> </span>'),sa=n('<div class="issue-assignee svelte-4b134t"> </div>'),ra=n('<div class="issue-card svelte-4b134t"><div class="issue-header svelte-4b134t"><span class="issue-id svelte-4b134t"> </span> <span class="issue-priority svelte-4b134t"> </span></div> <h3 class="issue-title svelte-4b134t"> </h3> <div class="issue-meta svelte-4b134t"><span class="issue-state svelte-4b134t"> </span> <!></div> <!></div>'),va=n('<div class="issues-grid svelte-4b134t"></div>'),ia=n('<div class="page svelte-4b134t"><div class="page-header svelte-4b134t"><h2 class="glitch svelte-4b134t">Jobs // Work Queue</h2> <div style="display: flex; gap: 12px;" class="svelte-4b134t"><button class="brutal-btn svelte-4b134t"> </button> <a target="_blank" class="brutal-btn svelte-4b134t">OPEN_LINEAR</a></div></div> <div class="tabs svelte-4b134t"><button>HUMAN_BLOCKERS <!></button> <button> </button></div> <!> <!></div>');function ma(It,xt){Kt(xt,!0);let T=N(yt([])),U=N(yt([])),D=N(!0),G=N(!0),Q=N(null),A=N("blockers"),V=N(null);const Et={0:"No priority",1:"Urgent",2:"High",3:"Medium",4:"Low"},Lt={0:"#666",1:"#ff5555",2:"#ffaa00",3:"#33ff00",4:"#888"},Ct={CRITICAL:"#ff5555",HIGH:"#ffaa00",MEDIUM:"#33ff00",LOW:"#888"};async function Z(){f(D,!0),f(Q,null);try{const e=await fetch("/api/jobs");if(!e.ok)throw new Error("Failed to fetch");const i=await e.json();f(T,i.issues||[],!0)}catch(e){f(Q,"Failed to load Linear issues"),console.error(e)}finally{f(D,!1)}}async function z(){f(G,!0);try{const e=await fetch("/api/human-blockers");if(e.ok){const i=await e.json();f(U,i.blockers||[],!0)}}catch(e){console.error("Failed to fetch blockers:",e)}finally{f(G,!1)}}async function Nt(e){f(V,e,!0);try{(await fetch("/api/human-blockers",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:"mark_done",id:e})})).ok&&await z()}catch(i){console.error("Failed to mark done:",i)}finally{f(V,null)}}jt(()=>{Z(),z();const e=setInterval(()=>{Z(),z()},6e4);return()=>clearInterval(e)});const At="https://linear.app/verduona/team/VD/active",ut=qt(()=>t(U).filter(e=>e.priority==="CRITICAL").length);var $=ia(),tt=s($),mt=v(s(tt),2),M=s(mt);M.__click=()=>{Z(),z()};var St=s(M,!0);a(M);var Rt=v(M,2);Jt(Rt,"href",At),a(mt),a(tt);var at=v(tt,2),F=s(at);let ht;F.__click=()=>f(A,"blockers");var wt=v(s(F));{var Ot=e=>{var i=Wt(),j=s(i);a(i),y(()=>l(j,`${t(ut)??""} CRITICAL`)),r(e,i)};p(wt,e=>{t(ut)>0&&e(Ot)})}a(F);var X=v(F,2);let gt;X.__click=()=>f(A,"linear");var Ht=s(X);a(X),a(at);var kt=v(at,2);{var Tt=e=>{var i=O(),j=H(i);{var et=c=>{var u=Qt();r(c,u)},st=c=>{var u=O(),rt=H(u);{var vt=d=>{var _=Vt();r(d,_)},it=d=>{var _=Zt();_t(_,21,()=>t(U),bt,(K,o)=>{var S=Yt();let m;var h=s(S),B=s(h),b=s(B,!0);a(B);var I=v(B,2),q=s(I,!0);a(I),a(h);var x=v(h,2),lt=s(x,!0);a(x);var E=v(x,2),Y=s(E);{var J=g=>{var k=zt(),W=s(k);a(k),y(()=>l(W,`EST: ${t(o).time??""}`)),r(g,k)};p(Y,g=>{t(o).time&&g(J)})}var ot=v(Y,2);{var P=g=>{var k=Xt(),W=s(k,!0);a(k),y(()=>l(W,t(o).notes)),r(g,k)};p(ot,g=>{t(o).notes&&g(P)})}a(E);var L=v(E,2),R=s(L);R.__click=()=>Nt(t(o).id);var nt=s(R,!0);a(R),a(L),a(S),y(()=>{m=ft(S,1,"blocker-card svelte-4b134t",null,m,{critical:t(o).priority==="CRITICAL",high:t(o).priority==="HIGH"}),l(b,t(o).id),pt(I,`color: ${Ct[t(o).priority]??""}`),l(q,t(o).priority),l(lt,t(o).task),R.disabled=t(V)===t(o).id,l(nt,t(V)===t(o).id?"MARKING...":"MARK_DONE")}),r(K,S)}),a(_),r(d,_)};p(rt,d=>{t(U).length===0?d(vt):d(it,!1)},!0)}r(c,u)};p(j,c=>{t(G)&&t(U).length===0?c(et):c(st,!1)})}r(e,i)};p(kt,e=>{t(A)==="blockers"&&e(Tt)})}var Ut=v(kt,2);{var Dt=e=>{var i=O(),j=H(i);{var et=c=>{var u=$t();r(c,u)},st=c=>{var u=O(),rt=H(u);{var vt=d=>{var _=ta(),K=s(_,!0);a(_),y(()=>l(K,t(Q))),r(d,_)},it=d=>{var _=O(),K=H(_);{var o=m=>{var h=aa();r(m,h)},S=m=>{var h=va();_t(h,21,()=>t(T),bt,(B,b)=>{var I=ra(),q=s(I),x=s(q),lt=s(x,!0);a(x);var E=v(x,2),Y=s(E,!0);a(E),a(q);var J=v(q,2),ot=s(J,!0);a(J);var P=v(J,2),L=s(P),R=s(L,!0);a(L);var nt=v(L,2);{var g=C=>{var w=O(),ct=H(w);_t(ct,17,()=>t(b).labels.slice(0,3),bt,(Gt,Mt)=>{var dt=ea(),Ft=s(dt,!0);a(dt),y(()=>l(Ft,t(Mt).name)),r(Gt,dt)}),r(C,w)};p(nt,C=>{t(b).labels?.length&&C(g)})}a(P);var k=v(P,2);{var W=C=>{var w=sa(),ct=s(w);a(w),y(()=>l(ct,`ASSIGNED: ${t(b).assignee.name??""}`)),r(C,w)};p(k,C=>{t(b).assignee&&C(W)})}a(I),y(()=>{l(lt,t(b).identifier),pt(E,`color: ${(Lt[t(b).priority]||"#666")??""}`),l(Y,Et[t(b).priority]||"Unknown"),l(ot,t(b).title),pt(L,`background: ${(t(b).state?.color||"#333")??""}`),l(R,t(b).state?.name||"Unknown")}),r(B,I)}),a(h),r(m,h)};p(K,m=>{t(T).length===0?m(o):m(S,!1)},!0)}r(d,_)};p(rt,d=>{t(Q)?d(vt):d(it,!1)},!0)}r(c,u)};p(j,c=>{t(D)&&t(T).length===0?c(et):c(st,!1)})}r(e,i)};p(Ut,e=>{t(A)==="linear"&&e(Dt)})}a($),y(()=>{M.disabled=t(D)||t(G),l(St,t(D)||t(G)?"LOADING...":"REFRESH"),ht=ft(F,1,"tab-btn svelte-4b134t",null,ht,{active:t(A)==="blockers"}),gt=ft(X,1,"tab-btn svelte-4b134t",null,gt,{active:t(A)==="linear"}),l(Ht,`LINEAR_ISSUES (${t(T).length??""})`)}),r(It,$),Bt()}Pt(["click"]);export{ma as component};

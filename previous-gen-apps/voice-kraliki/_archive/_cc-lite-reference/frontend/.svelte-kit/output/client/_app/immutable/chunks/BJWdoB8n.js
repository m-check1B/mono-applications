import{w as s,o as i,z as o}from"./BuVZNLKp.js";import{t as a}from"./CO_IWAlQ.js";import{g as r}from"./QsC6zclp.js";class n{#e=s(null);get user(){return i(this.#e)}set user(e){o(this.#e,e,!0)}#t=s(!1);get loading(){return i(this.#t)}set loading(e){o(this.#t,e,!0)}#r=s(!1);get initialized(){return i(this.#r)}set initialized(e){o(this.#r,e,!0)}async init(){if(!this.initialized){this.loading=!0;try{const e=await Promise.race([a.auth.me.query(),new Promise((u,t)=>setTimeout(()=>t(new Error("Timeout")),2e3))]);this.user=e.user}catch{console.warn("Auth check failed, using mock user"),this.user={id:"demo-user",email:"agent@demo.com",firstName:"Demo",lastName:"Agent",role:"AGENT"}}finally{this.loading=!1,this.initialized=!0}}}async login(e,u){this.loading=!0;try{const t=await a.auth.login.mutate({email:e,password:u});return this.user=t.user,this.user.role==="ADMIN"?r("/admin"):this.user.role==="SUPERVISOR"?r("/supervisor"):r("/operator"),{success:!0}}catch(t){return{success:!1,error:t.message||"Login failed"}}finally{this.loading=!1}}async logout(){try{await a.auth.logout.mutate()}catch(e){console.error("Logout error:",e)}finally{this.user=null,r("/login")}}get isAuthenticated(){return this.user!==null}get isAgent(){return this.user?.role==="AGENT"}get isSupervisor(){return this.user?.role==="SUPERVISOR"}get isAdmin(){return this.user?.role==="ADMIN"}}const m=new n;export{m as a};

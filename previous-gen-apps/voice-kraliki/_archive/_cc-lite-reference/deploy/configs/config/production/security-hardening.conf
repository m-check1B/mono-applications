# Voice by Kraliki Security Hardening Configuration

# Application Security
security:
  # Input validation
  inputValidation:
    enabled: true
    maxPayloadSize: 10485760  # 10MB
    allowedContentTypes:
      - application/json
      - application/x-www-form-urlencoded
      - multipart/form-data
    sanitizeInput: true
    stripTags: true

  # Rate limiting
  rateLimiting:
    enabled: true
    windowMs: 900000  # 15 minutes
    maxRequests: 1000
    skipSuccessfulRequests: false
    skipFailedRequests: false
    keyGenerator: "ip"  # Can be 'ip', 'user', 'custom'

  # CORS configuration
  cors:
    enabled: true
    origin: ["https://your-domain.com"]
    methods: ["GET", "POST", "PUT", "DELETE", "OPTIONS"]
    allowedHeaders: ["Content-Type", "Authorization", "X-Requested-With"]
    exposedHeaders: ["Content-Length", "X-Request-ID"]
    credentials: true
    maxAge: 86400  # 24 hours

  # Security headers
  headers:
    helmet:
      enabled: true
      contentSecurityPolicy:
        enabled: true
        directives:
          defaultSrc: ["'self'"]
          scriptSrc: ["'self'", "'unsafe-inline'"]
          styleSrc: ["'self'", "'unsafe-inline'"]
          imgSrc: ["'self'", "data:", "https:"]
          connectSrc: ["'self'", "wss:", "https://api.openai.com", "https://api.anthropic.com"]
          fontSrc: ["'self'"]
          objectSrc: ["'none'"]
          mediaSrc: ["'self'"]
          frameSrc: ["'none'"]
          frameAncestors: ["'none'"]
          formAction: ["'self'"]
          baseUri: ["'self'"]
      strictTransportSecurity:
        enabled: true
        maxAge: 31536000  # 1 year
        includeSubDomains: true
        preload: true
      xContentTypeOptions: "nosniff"
      xFrameOptions: "DENY"
      xXssProtection: "1; mode=block"
      referrerPolicy: "strict-origin-when-cross-origin"
      permissionsPolicy:
        enabled: true
        policies:
          accelerometer: "none"
          camera: "none"
          geolocation: "none"
          gyroscope: "none"
          magnetometer: "none"
          microphone: "none"
          payment: "none"
          usb: "none"

# Database Security
database:
  # Connection security
  ssl:
    enabled: true
    mode: "require"
    ca: "/etc/ssl/certs/ca-bundle.crt"
  # Query protection
  queryProtection:
    enabled: true
    timeoutMs: 30000
    maxRows: 1000
    allowWrites: true
    allowSchemaChanges: false
  # Backup encryption
  backup:
    encryption: true
    encryptionKey: "your-backup-encryption-key"
    retentionDays: 30

# API Security
api:
  # Authentication
  authentication:
    jwt:
      algorithm: "HS256"
      expiresIn: "24h"
      refreshExpiresIn: "7d"
      issuer: "cc-lite"
      audience: "cc-lite-users"
    bcrypt:
      rounds: 12
  # Authorization
  authorization:
    enabled: true
    rbac:
      enabled: true
      defaultRole: "user"
      roles:
        - admin
        - supervisor
        - agent
        - user
  # API key management
  apiKeys:
    enabled: true
    rotationIntervalDays: 90
    maxKeysPerUser: 5

# File Upload Security
fileUpload:
  enabled: true
  maxSize: 10485760  # 10MB
  allowedTypes:
    - "application/pdf"
    - "application/msword"
    - "application/vnd.openxmlformats-officedocument.wordprocessingml.document"
    - "text/plain"
    - "image/jpeg"
    - "image/jpg"
    - "image/png"
    - "image/gif"
  scanViruses: true
  storeLocation: "/var/uploads/cc-lite"
  generateUniqueNames: true
  sanitizeFilenames: true

# Session Security
session:
  enabled: true
  maxAge: 86400000  # 24 hours
  rolling: true
  resave: false
  saveUninitialized: false
  cookie:
    secure: true
    httpOnly: true
    sameSite: "strict"
    domain: "your-domain.com"
    path: "/"
    maxAge: 86400000

# WebSocket Security
websocket:
  enabled: true
  maxConnections: 1000
  timeoutMs: 30000
  originValidation:
    enabled: true
    allowedOrigins: ["https://your-domain.com"]
  rateLimiting:
    enabled: true
    messagesPerMinute: 100
  messageSizeLimit: 65536  # 64KB

# Logging and Monitoring
logging:
  level: "info"
  format: "json"
  file: "/var/log/cc-lite/security.log"
  maxFileSize: 10485760  # 10MB
  maxFiles: 10
  auditLog:
    enabled: true
    file: "/var/log/cc-lite/audit.log"
    events:
      - "login"
      - "logout"
      - "failed_login"
      - "permission_denied"
      - "data_access"
      - "data_modification"

# Network Security
network:
  firewall:
    enabled: true
    allowedPorts:
      - 22    # SSH
      - 80    # HTTP
      - 443   # HTTPS
      - 3001  # Application
      - 9090  # Metrics
    blockedIPs: []
    rateLimit:
      enabled: true
      connectionsPerSecond: 10
  ssl:
    enabled: true
    certPath: "/etc/ssl/certs/cc-lite.crt"
    keyPath: "/etc/ssl/private/cc-lite.key"
    caPath: "/etc/ssl/certs/ca-bundle.crt"
    protocols:
      - "TLSv1.2"
      - "TLSv1.3"
    ciphers:
      - "ECDHE-RSA-AES256-GCM-SHA512"
      - "ECDHE-RSA-AES128-GCM-SHA256"
      - "ECDHE-RSA-AES256-SHA384"
      - "ECDHE-RSA-AES128-SHA256"
    preferServerCiphers: true

# Data Protection
dataProtection:
  encryption:
    enabled: true
    algorithm: "AES-256-GCM"
    keyRotationDays: 90
    fields:
      - "user.email"
      - "user.phone"
      - "call.transcript"
      - "call.recording"
  masking:
    enabled: true
    fields:
      - "credit_card"
      - "ssn"
      - "password"
  anonymization:
    enabled: true
    retentionDays: 180
    fields:
      - "ip_address"
      - "user_agent"

# Backup and Disaster Recovery
backup:
  enabled: true
  schedule: "0 2 * * *"  # Daily at 2 AM
  retentionDays: 30
  compression: true
  encryption: true
  remoteStorage:
    enabled: true
    provider: "s3"  # s3, gcs, azure
    region: "us-east-1"
    bucket: "cc-lite-backups"
  verification:
    enabled: true
    schedule: "0 6 * * 0"  # Weekly on Sunday at 6 AM

# Incident Response
incidentResponse:
  enabled: true
  alerting:
    enabled: true
    channels:
      - email
      - slack
      - sms
    severityLevels:
      - low
      - medium
      - high
      - critical
  escalation:
    enabled: true
    levels:
      - level1: 5 minutes
      - level2: 15 minutes
      - level3: 30 minutes
      - level4: 60 minutes
  playbook:
    enabled: true
    location: "/etc/cc-lite/incident-response.yml"

# Compliance
compliance:
  gdpr:
    enabled: true
    consentManagement: true
    dataSubjectRequests: true
    breachNotification: true
    retentionPeriod: 180
  hipaa:
    enabled: false
    phiProtection: false
    auditLogging: false
  pci:
    enabled: false
    cardholderData: false
    quarterlyScans: false

# Development Restrictions (for production)
development:
  debugMode: false
  verboseLogging: false
  errorStackTraces: false
  sourceMaps: false
  hotReload: false
  testMode: false

# Performance Security
performance:
  dosProtection:
    enabled: true
    maxConcurrentConnections: 1000
    maxRequestsPerSecond: 100
    timeoutMs: 30000
  resourceLimits:
    maxMemoryUsage: 2048  # MB
    maxCpuUsage: 80      # %
    maxDiskUsage: 80      # %
    maxConnections: 1000
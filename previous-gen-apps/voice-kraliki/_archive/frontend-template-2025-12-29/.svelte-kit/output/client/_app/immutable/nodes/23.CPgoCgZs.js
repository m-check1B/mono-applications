import{f as $,a as d,c as Q}from"../chunks/pFl1CK35.js";import{p as V,s as N,a as X,i as Z,f as r,g as o,e as l,t as O,c as ss,d as t,r as a,n as es,h as ts}from"../chunks/aQ_ifger.js";import{s as u}from"../chunks/DBuqHHqM.js";import{i as as}from"../chunks/BTxJJ6eU.js";import{e as is,i as os}from"../chunks/oqRKM5NY.js";import{r as ls}from"../chunks/BqAhscvM.js";import{c as rs,s as z}from"../chunks/DGR2HyJN.js";import{d as cs,e as ns}from"../chunks/C918u5xm.js";import{b as vs}from"../chunks/CDxeFDgn.js";import{s as ds,a as us}from"../chunks/BPSUqZ7R.js";import{c,b as bs}from"../chunks/J6IVVljB.js";var fs=$('<p class="no-messages svelte-7wxcfb">No messages yet. Try logging in/out in another tab or send a test message.</p>'),ps=$('<div class="message svelte-7wxcfb"> </div>'),ms=$(`<div class="cross-tab-demo svelte-7wxcfb"><h1 class="svelte-7wxcfb">Cross-Tab Synchronization Demo</h1> <div class="status svelte-7wxcfb"><div class="status-item svelte-7wxcfb"><strong class="svelte-7wxcfb">BroadcastChannel:</strong> <span> </span></div> <div class="status-item svelte-7wxcfb"><strong class="svelte-7wxcfb">Auth Status:</strong> <span> </span></div> <div class="status-item svelte-7wxcfb"><strong class="svelte-7wxcfb">User:</strong> <span> </span></div></div> <div class="instructions svelte-7wxcfb"><h2 class="svelte-7wxcfb">Instructions:</h2> <ol class="svelte-7wxcfb"><li class="svelte-7wxcfb">Open this page in multiple browser tabs (Ctrl+Click or Cmd+Click on the tab)</li> <li class="svelte-7wxcfb">Login or logout in one tab using the auth pages</li> <li class="svelte-7wxcfb">Observe automatic synchronization in other tabs</li> <li class="svelte-7wxcfb">You can also send test messages between tabs using the form below</li></ol></div> <div class="test-section svelte-7wxcfb"><h2 class="svelte-7wxcfb">Test Messages</h2> <div class="input-group svelte-7wxcfb"><input placeholder="Enter test message" class="svelte-7wxcfb"/> <button class="svelte-7wxcfb">Send to Other Tabs</button></div></div> <div class="messages svelte-7wxcfb"><div class="messages-header svelte-7wxcfb"><h3 class="svelte-7wxcfb">Messages from Other Tabs:</h3> <button class="clear-btn svelte-7wxcfb">Clear</button></div> <div class="messages-list svelte-7wxcfb"><!></div></div> <div class="info-box svelte-7wxcfb"><h3 class="svelte-7wxcfb">How It Works</h3> <p class="svelte-7wxcfb">This feature uses the <code class="svelte-7wxcfb">BroadcastChannel API</code> to synchronize authentication state
			and sessions across multiple browser tabs. When you login, logout, or update your session in
			one tab, all other tabs are automatically notified and updated.</p> <p class="svelte-7wxcfb"><strong>Benefits:</strong></p> <ul class="svelte-7wxcfb"><li class="svelte-7wxcfb">Consistent authentication state across all tabs</li> <li class="svelte-7wxcfb">Automatic logout in all tabs when you logout in one</li> <li class="svelte-7wxcfb">Real-time session updates</li> <li class="svelte-7wxcfb">No server polling required</li></ul></div></div>`);function As(B,E){V(E,!0);const b=()=>us(bs,"$authStore",W),[W,q]=ds();let i=N(X([])),n=N("");Z(()=>{const e=[c.subscribe("auth_updated",s=>{r(i,[...o(i),`[${new Date(s.timestamp).toLocaleTimeString()}] Auth updated from tab ${s.tabId.slice(0,15)}...`],!0)}),c.subscribe("auth_logout",s=>{r(i,[...o(i),`[${new Date(s.timestamp).toLocaleTimeString()}] Logout detected from tab ${s.tabId.slice(0,15)}...`],!0)}),c.subscribe("session_updated",s=>{r(i,[...o(i),`[${new Date(s.timestamp).toLocaleTimeString()}] Session updated: ${JSON.stringify(s.payload).slice(0,50)}...`],!0)}),c.subscribe("session_ended",s=>{r(i,[...o(i),`[${new Date(s.timestamp).toLocaleTimeString()}] Session ended from tab ${s.tabId.slice(0,15)}...`],!0)})];return()=>e.forEach(s=>s())});function T(){o(n).trim()&&(c.broadcast("session_updated",{test:o(n)}),r(n,""))}function H(){r(i,[],!0)}var f=ms(),p=l(t(f),2),m=t(p),g=l(t(m),2),J=t(g,!0);a(g),a(m);var x=l(m,2),h=l(t(x),2),P=t(h,!0);a(h),a(x);var k=l(x,2),C=l(t(k),2),R=t(C,!0);a(C),a(k),a(p);var w=l(p,4),A=l(t(w),2),v=t(A);ls(v);var I=l(v,2);I.__click=T,a(A),a(w);var L=l(w,2),_=t(L),D=l(t(_),2);D.__click=H,a(_);var M=l(_,2),U=t(M);{var Y=e=>{var s=fs();d(e,s)},j=e=>{var s=Q(),S=ts(s);is(S,17,()=>o(i),os,(F,G)=>{var y=ps(),K=t(y,!0);a(y),O(()=>u(K,o(G))),d(F,y)}),d(e,s)};as(U,e=>{o(i).length===0?e(Y):e(j,!1)})}a(M),a(L),es(2),a(f),O((e,s,S)=>{z(g,1,e,"svelte-7wxcfb"),u(J,s),z(h,1,`auth-status status-${b().status??""}`,"svelte-7wxcfb"),u(P,b().status),u(R,b().user?.email||"Not logged in"),I.disabled=S,D.disabled=o(i).length===0},[()=>rs(c.isAvailable()?"supported":"not-supported"),()=>c.isAvailable()?"✓ Supported":"✗ Not Supported",()=>!o(n).trim()]),ns("keypress",v,e=>e.key==="Enter"&&T()),vs(v,()=>o(n),e=>r(n,e)),d(B,f),ss(),q()}cs(["click"]);export{As as component};

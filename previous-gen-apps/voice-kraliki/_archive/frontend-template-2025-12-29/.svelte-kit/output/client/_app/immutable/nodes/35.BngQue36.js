import{f as x,a as c,c as Et}from"../chunks/pFl1CK35.js";import"../chunks/CnJ-dsFT.js";import{o as Ft,a as Nt}from"../chunks/0VtO9hYy.js";import{p as Pt,e as s,c as Rt,d as a,g as e,J as D,f as q,r as t,t as _,h as ct,n as Lt}from"../chunks/aQ_ifger.js";import{s as o}from"../chunks/DBuqHHqM.js";import{i as h}from"../chunks/BTxJJ6eU.js";import{e as X,i as Y}from"../chunks/oqRKM5NY.js";import{d as Qt}from"../chunks/C918u5xm.js";import{s as pt}from"../chunks/DGR2HyJN.js";import{i as Jt}from"../chunks/ft9JqUN4.js";import{g as Ut}from"../chunks/CTjsJUPt.js";var Gt=x('<div class="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-4"> </div>'),Kt=x('<div class="grid grid-cols-1 md:grid-cols-5 gap-4 mb-6"><div class="bg-white p-4 rounded-lg shadow"><div class="text-sm text-gray-600 mb-1">Waiting Now</div> <div class="text-3xl font-bold text-yellow-600"> </div></div> <div class="bg-white p-4 rounded-lg shadow"><div class="text-sm text-gray-600 mb-1">Avg Wait Time</div> <div class="text-3xl font-bold"> </div></div> <div class="bg-white p-4 rounded-lg shadow"><div class="text-sm text-gray-600 mb-1">Abandon Rate</div> <div class="text-3xl font-bold text-red-600"> </div></div> <div class="bg-white p-4 rounded-lg shadow"><div class="text-sm text-gray-600 mb-1">Abandoned</div> <div class="text-3xl font-bold text-red-600"> </div></div> <div class="bg-white p-4 rounded-lg shadow"><div class="text-sm text-gray-600 mb-1">Last Hour</div> <div class="text-3xl font-bold"> </div></div></div>'),Ot=x("<button> </button>"),Vt=x('<div class="text-center py-12"><div class="inline-block animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"></div> <p class="mt-4 text-gray-600">Loading queue...</p></div>'),Xt=x('<div class="text-center py-12 bg-gray-50 rounded-lg"><p class="text-gray-600">No calls in queue</p></div>'),Yt=x('<span class="px-2 py-1 bg-red-100 text-red-800 rounded-full text-xs font-semibold"> </span>'),Zt=x('<span class="text-gray-500">Normal</span>'),ta=x('<span class="px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded"> </span>'),aa=x('<span class="px-2 py-1 bg-green-100 text-green-800 text-xs rounded"> </span>'),ea=x('<div class="text-xs text-gray-500 mt-1"> </div>'),ra=x('<tr class="hover:bg-gray-50"><td class="px-6 py-4 whitespace-nowrap"><div class="text-sm font-medium text-gray-900"> </div></td><td class="px-6 py-4 whitespace-nowrap"><div class="text-sm font-medium text-gray-900"> </div> <div class="text-sm text-gray-500"> </div></td><td class="px-6 py-4 whitespace-nowrap"><div class="text-sm text-gray-900 capitalize"> </div></td><td class="px-6 py-4 whitespace-nowrap"><div class="text-sm text-gray-900"> </div></td><td class="px-6 py-4 whitespace-nowrap"><div class="text-sm text-gray-900"> </div></td><td class="px-6 py-4 whitespace-nowrap"><div class="text-sm"><!></div></td><td class="px-6 py-4"><div class="flex flex-wrap gap-1"><!> <!></div></td><td class="px-6 py-4 whitespace-nowrap"><span> </span> <!></td></tr>'),sa=x('<div class="bg-white rounded-lg shadow overflow-hidden"><table class="min-w-full divide-y divide-gray-200"><thead class="bg-gray-50"><tr><th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Position</th><th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Caller</th><th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Direction</th><th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Wait Time</th><th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Est. Wait</th><th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Priority</th><th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Skills</th><th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Status</th></tr></thead><tbody class="bg-white divide-y divide-gray-200"></tbody></table></div> <div class="mt-4 text-sm text-gray-600 flex items-center justify-between"><div> </div> <div class="flex items-center gap-2"><span>üîÑ</span> <span>Auto-refreshing every 3 seconds</span></div></div>',1),ia=x('<div class="container mx-auto p-6"><div class="mb-6 flex items-center justify-between"><div><h1 class="text-3xl font-bold">Call Queue</h1> <p class="text-gray-600 mt-1">Manage incoming call queue and routing</p></div> <button class="px-4 py-2 border border-gray-300 rounded text-gray-700 hover:bg-gray-50">‚Üê Back to Dashboard</button></div> <!> <!> <div class="mb-6 bg-white rounded-lg shadow p-4"><div class="flex gap-2"></div></div> <!></div>');function ma(xt,ut){Pt(ut,!1);let $=D([]),f=D(null),W=D(!0),B=D(""),C,z=D("waiting");const gt={waiting:"bg-yellow-100 text-yellow-800",routing:"bg-blue-100 text-blue-800",assigned:"bg-green-100 text-green-800",abandoned:"bg-red-100 text-red-800",answered:"bg-gray-100 text-gray-800"};Ft(async()=>{await E(),C=setInterval(E,3e3)}),Nt(()=>{C&&clearInterval(C)});async function E(){try{const r=localStorage.getItem("token"),i=e(z)!=="all"?`?status=${e(z)}`:"",d=await fetch(`/api/supervisor/queue${i}`,{headers:{Authorization:`Bearer ${r}`}});d.ok&&q($,await d.json());const p=await fetch("/api/supervisor/queue/statistics",{headers:{Authorization:`Bearer ${r}`}});p.ok&&q(f,await p.json()),q(W,!1)}catch(r){q(B,`Error loading queue: ${r}`),q(W,!1)}}function Z(r){if(r===null)return"-";const i=Math.floor(r/60),d=r%60;return`${i}:${d.toString().padStart(2,"0")}`}function _t(r){const i=new Date(r),p=Math.floor((new Date().getTime()-i.getTime())/1e3);if(p<60)return`${p}s`;const m=Math.floor(p/60);return m<60?`${m}m`:`${Math.floor(m/60)}h ${m%60}m`}async function mt(r){q(z,r),await E()}Jt();var F=ia(),N=a(F),ft=s(a(N),2);ft.__click=()=>Ut("/supervisor/dashboard"),t(N);var tt=s(N,2);{var bt=r=>{var i=Gt(),d=a(i,!0);t(i),_(()=>o(d,e(B))),c(r,i)};h(tt,r=>{e(B)&&r(bt)})}var at=s(tt,2);{var ht=r=>{var i=Kt(),d=a(i),p=s(a(d),2),m=a(p,!0);t(p),t(d);var u=s(d,2),b=s(a(u),2),S=a(b,!0);t(b),t(u);var y=s(u,2),M=s(a(y),2),T=a(M);t(M),t(y);var w=s(y,2),j=s(a(w),2),R=a(j,!0);t(j),t(w);var v=s(w,2),k=s(a(v),2),A=a(k,!0);t(k),t(v),t(i),_((H,L)=>{o(m,e(f).waiting_count),o(S,H),o(T,`${L??""}%`),o(R,e(f).abandoned_count),o(A,e(f).total_calls_last_hour)},[()=>Z(e(f).average_wait_seconds),()=>e(f).abandon_rate_percentage.toFixed(1)]),c(r,i)};h(at,r=>{e(f)&&r(ht)})}var P=s(at,2),et=a(P);X(et,4,()=>["all","waiting","routing","assigned","abandoned"],Y,(r,i)=>{var d=Ot();d.__click=()=>mt(i);var p=a(d,!0);t(d),_(()=>{pt(d,1,`px-4 py-2 rounded-md capitalize ${e(z)===i?"bg-blue-600 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`),o(p,i)}),c(r,d)}),t(et),t(P);var yt=s(P,2);{var wt=r=>{var i=Vt();c(r,i)},kt=r=>{var i=Et(),d=ct(i);{var p=u=>{var b=Xt();c(u,b)},m=u=>{var b=sa(),S=ct(b),y=a(S),M=s(a(y));X(M,5,()=>e($),Y,(R,v)=>{var k=ra(),A=a(k),H=a(A),L=a(H,!0);t(H),t(A);var Q=s(A),J=a(Q),qt=a(J,!0);t(J);var rt=s(J,2),$t=a(rt,!0);t(rt),t(Q);var U=s(Q),st=a(U),St=a(st,!0);t(st),t(U);var G=s(U),it=a(G),Mt=a(it,!0);t(it),t(G);var K=s(G),dt=a(K),At=a(dt,!0);t(dt),t(K);var O=s(K),ot=a(O),Dt=a(ot);{var zt=l=>{var n=Yt(),g=a(n);t(n),_(()=>o(g,`High (${e(v).priority??""})`)),c(l,n)},Tt=l=>{var n=Zt();c(l,n)};h(Dt,l=>{e(v).priority>0?l(zt):l(Tt,!1)})}t(ot),t(O);var V=s(O),vt=a(V),lt=a(vt);X(lt,1,()=>e(v).required_skills,Y,(l,n)=>{var g=ta(),Ct=a(g,!0);t(g),_(()=>o(Ct,e(n))),c(l,g)});var jt=s(lt,2);{var Ht=l=>{var n=aa(),g=a(n,!0);t(n),_(()=>o(g,e(v).required_language)),c(l,n)};h(jt,l=>{e(v).required_language&&l(Ht)})}t(vt),t(V);var nt=s(V),I=a(nt),It=a(I,!0);t(I);var Wt=s(I,2);{var Bt=l=>{var n=ea(),g=a(n);t(n),_(()=>o(g,`${e(v).routing_attempts??""} attempts`)),c(l,n)};h(Wt,l=>{e(v).routing_attempts>0&&l(Bt)})}t(nt),t(k),_((l,n)=>{o(L,e(v).queue_position||"-"),o(qt,e(v).caller_name||"Unknown"),o($t,e(v).caller_phone),o(St,e(v).direction),o(Mt,l),o(At,n),pt(I,1,`px-2 py-1 text-xs font-semibold rounded-full capitalize ${gt[e(v).status]??""}`),o(It,e(v).status)},[()=>_t(e(v).queued_at),()=>Z(e(v).estimated_wait_time)]),c(R,k)}),t(M),t(y),t(S);var T=s(S,2),w=a(T),j=a(w);t(w),Lt(2),t(T),_(()=>o(j,`Showing ${e($).length??""} calls`)),c(u,b)};h(d,u=>{e($).length===0?u(p):u(m,!1)},!0)}c(r,i)};h(yt,r=>{e(W)&&e($).length===0?r(wt):r(kt,!1)})}t(F),c(xt,F),Rt()}Qt(["click"]);export{ma as component};

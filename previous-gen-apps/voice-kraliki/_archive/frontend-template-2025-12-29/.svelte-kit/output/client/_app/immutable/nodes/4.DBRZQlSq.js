import{f as c,a as n,c as na,d as Aa}from"../chunks/pFl1CK35.js";import{p as xa,d as a,e as s,g as t,s as j,r as e,n as ta,t as h,c as ya,f as u,h as je,j as K,l as fa,a as va,m as Fa,aI as Ia}from"../chunks/aQ_ifger.js";import{d as ha}from"../chunks/C918u5xm.js";import{i as b}from"../chunks/BTxJJ6eU.js";import{h as Ma}from"../chunks/DV0aRw8T.js";import{s as de}from"../chunks/DGR2HyJN.js";import{o as qa,a as $a}from"../chunks/0VtO9hYy.js";import{s as i}from"../chunks/DBuqHHqM.js";import{e as ca,i as oa}from"../chunks/oqRKM5NY.js";import{s as Te}from"../chunks/C8vjnfWO.js";import{p as Le}from"../chunks/DzqNI6-e.js";import{a as Je}from"../chunks/BqAhscvM.js";var Ca=c('<span class="last-update svelte-1992uwp"> </span>'),Pa=c('<div class="error-banner svelte-1992uwp"><span class="error-icon">âš </span> <span class="error-text svelte-1992uwp"> </span></div>'),Sa=c('<div class="loading-state svelte-1992uwp"><span class="spinner svelte-1992uwp">âŸ³</span> <p>Loading analytics...</p></div>'),Oa=c('<div class="realtime-bar svelte-1992uwp"><div class="realtime-item svelte-1992uwp"><span class="realtime-label svelte-1992uwp">Active Calls</span> <span class="realtime-value active svelte-1992uwp"> </span></div> <div class="realtime-item svelte-1992uwp"><span class="realtime-label svelte-1992uwp">Calls (Last Hour)</span> <span class="realtime-value svelte-1992uwp"> </span></div> <div class="realtime-item svelte-1992uwp"><span class="realtime-label svelte-1992uwp">Recent Success Rate</span> <span class="realtime-value svelte-1992uwp"> </span></div> <div class="realtime-item svelte-1992uwp"><span class="realtime-label svelte-1992uwp">Avg Sentiment</span> <span class="realtime-value svelte-1992uwp"> </span></div></div>'),ja=c('<div class="provider-card svelte-1992uwp"><div class="provider-header svelte-1992uwp"><span class="provider-name svelte-1992uwp"> </span> <span class="provider-calls svelte-1992uwp"> </span></div> <div class="provider-metrics svelte-1992uwp"><div class="provider-metric svelte-1992uwp"><span class="pm-label svelte-1992uwp">Success</span> <span class="pm-value svelte-1992uwp"> </span></div> <div class="provider-metric svelte-1992uwp"><span class="pm-label svelte-1992uwp">Quality</span> <span class="pm-value svelte-1992uwp"> </span></div> <div class="provider-metric svelte-1992uwp"><span class="pm-label svelte-1992uwp">Uptime</span> <span class="pm-value svelte-1992uwp"> </span></div> <div class="provider-metric svelte-1992uwp"><span class="pm-label svelte-1992uwp">Error Rate</span> <span class="pm-value error svelte-1992uwp"> </span></div></div></div>'),La=c('<div class="section-card svelte-1992uwp"><h3 class="section-title svelte-1992uwp">Provider Performance</h3> <div class="provider-grid svelte-1992uwp"></div></div>'),Ya=c('<div class="agent-table-row svelte-1992uwp"><span class="agent-col agent-id svelte-1992uwp"> </span> <span class="agent-col svelte-1992uwp"> </span> <span class="agent-col svelte-1992uwp"> </span> <span class="agent-col svelte-1992uwp"> </span> <span class="agent-col svelte-1992uwp"> </span> <span class="agent-col svelte-1992uwp"> </span></div>'),Ha=c('<div class="section-card svelte-1992uwp"><h3 class="section-title svelte-1992uwp">Agent Performance</h3> <div class="agent-table svelte-1992uwp"><div class="agent-table-header svelte-1992uwp"><span class="agent-col svelte-1992uwp">Agent ID</span> <span class="agent-col svelte-1992uwp">Calls</span> <span class="agent-col svelte-1992uwp">Success</span> <span class="agent-col svelte-1992uwp">Avg Duration</span> <span class="agent-col svelte-1992uwp">Sentiment</span> <span class="agent-col svelte-1992uwp">Quality</span></div> <!></div></div>'),Ua=c('<div class="section-card svelte-1992uwp"><h3 class="section-title svelte-1992uwp">Call Activity</h3> <div class="timeseries-info svelte-1992uwp"><p class="svelte-1992uwp"> </p> <p class="note svelte-1992uwp">Detailed charts available in Provider Metrics Display</p></div></div>'),Xa=c('<!> <div class="metrics-grid svelte-1992uwp"><div class="metric-card svelte-1992uwp"><div class="metric-icon svelte-1992uwp">ğŸ“</div> <div class="metric-content"><span class="metric-label svelte-1992uwp">Total Calls</span> <span class="metric-value svelte-1992uwp"> </span></div></div> <div class="metric-card svelte-1992uwp"><div class="metric-icon svelte-1992uwp">âœ“</div> <div class="metric-content"><span class="metric-label svelte-1992uwp">Completed Calls</span> <span class="metric-value success svelte-1992uwp"> </span></div></div> <div class="metric-card svelte-1992uwp"><div class="metric-icon svelte-1992uwp">âœ—</div> <div class="metric-content"><span class="metric-label svelte-1992uwp">Failed Calls</span> <span class="metric-value error svelte-1992uwp"> </span></div></div> <div class="metric-card svelte-1992uwp"><div class="metric-icon svelte-1992uwp">ğŸ“Š</div> <div class="metric-content"><span class="metric-label svelte-1992uwp">Success Rate</span> <span class="metric-value svelte-1992uwp"> </span></div></div> <div class="metric-card svelte-1992uwp"><div class="metric-icon svelte-1992uwp">â±ï¸</div> <div class="metric-content"><span class="metric-label svelte-1992uwp">Avg Duration</span> <span class="metric-value svelte-1992uwp"> </span></div></div> <div class="metric-card svelte-1992uwp"><div class="metric-icon svelte-1992uwp">ğŸ˜Š</div> <div class="metric-content"><span class="metric-label svelte-1992uwp">Avg Sentiment</span> <span class="metric-value svelte-1992uwp"> </span></div></div> <div class="metric-card svelte-1992uwp"><div class="metric-icon svelte-1992uwp">ğŸ¤</div> <div class="metric-content"><span class="metric-label svelte-1992uwp">Audio Quality</span> <span class="metric-value svelte-1992uwp"> </span></div></div> <div class="metric-card svelte-1992uwp"><div class="metric-icon svelte-1992uwp">ğŸ“</div> <div class="metric-content"><span class="metric-label svelte-1992uwp">Transcription</span> <span class="metric-value svelte-1992uwp"> </span></div></div></div> <!> <!> <!>',1),Ea=c('<div class="no-data svelte-1992uwp"><p>No analytics data available</p> <p class="hint svelte-1992uwp">Start making calls to see analytics</p></div>'),Na=c('<div class="enhanced-dashboard svelte-1992uwp"><div class="dashboard-header svelte-1992uwp"><div class="title-section svelte-1992uwp"><h2 class="dashboard-title svelte-1992uwp">Analytics Dashboard</h2> <!></div> <button class="refresh-btn svelte-1992uwp"><span>ğŸ”„</span> Refresh</button></div> <!> <!></div>');function Ga(Ge,_){xa(_,!0),Le(_,"timeRange",3,"24h");let Re=Le(_,"autoRefresh",3,!0),De=Le(_,"refreshInterval",3,3e4),o=j(null),A=j(null),F=j(!0),H=j(null),P=j(null),U=null;const L={gemini:"Google Gemini",openai:"OpenAI Realtime",deepgram_nova3:"Deepgram Nova 3",twilio:"Twilio",telnyx:"Telnyx"};async function pe(){try{u(H,null);const[l,r]=await Promise.all([fetch("http://localhost:8000/analytics/summary"),fetch("http://localhost:8000/analytics/metrics/realtime")]);if(!l.ok)throw new Error(`HTTP ${l.status}: ${l.statusText}`);if(!r.ok)throw new Error(`HTTP ${r.status}: ${r.statusText}`);const v=await l.json(),d=await r.json();u(o,v.summary,!0),u(A,d,!0),u(P,new Date,!0),u(F,!1)}catch(l){u(H,l instanceof Error?l.message:"Failed to fetch analytics",!0),console.error("Failed to fetch analytics:",l),u(F,!1)}}function ge(l){const r=Math.floor(l/60),v=Math.round(l%60);return`${r}m ${v}s`}function W(l){return`${l.toFixed(1)}%`}function I(l){return l>=.5?"#10b981":l>=.2?"#84cc16":l>=-.2?"#f59e0b":l>=-.5?"#f97316":"#ef4444"}function k(l){return l>=80?"#10b981":l>=60?"#84cc16":l>=40?"#f59e0b":l>=20?"#f97316":"#ef4444"}function we(l){const r=Math.floor((new Date().getTime()-l.getTime())/1e3);if(r<60)return`${r}s ago`;const v=Math.floor(r/60);return v<60?`${v}m ago`:`${Math.floor(v/60)}h ago`}qa(()=>{pe(),Re()&&(U=setInterval(pe,De()))}),$a(()=>{U&&clearInterval(U)});var ue=Na(),z=a(ue),M=a(z),E=s(a(M),2);{var N=l=>{var r=Ca(),v=a(r);e(r),h(d=>i(v,`Updated ${d??""}`),[()=>we(t(P))]),n(l,r)};b(E,l=>{t(P)&&l(N)})}e(M);var J=s(M,2);J.__click=pe;var xe=a(J);let ae;ta(),e(J),e(z);var Ae=s(z,2);{var Qe=l=>{var r=Pa(),v=s(a(r),2),d=a(v,!0);e(v),e(r),h(()=>i(d,t(H))),n(l,r)};b(Ae,l=>{t(H)&&l(Qe)})}var Ze=s(Ae,2);{var sa=l=>{var r=Sa();n(l,r)},ra=l=>{var r=na(),v=je(r);{var d=Y=>{var C=Xa(),T=je(C);{var ea=p=>{var f=Oa(),x=a(f),X=s(a(x),2),be=a(X,!0);e(X),e(x);var oe=s(x,2),$=s(a(oe),2),y=a($,!0);e($),e(oe);var q=s(oe,2),B=s(a(q),2),Oe=a(B,!0);e(B),e(q);var aa=s(q,2),ke=s(a(aa),2),la=a(ke,!0);e(ke),e(aa),e(f),h((Xe,ze,Ee)=>{i(be,t(A).active_calls),i(y,t(A).recent_calls_last_hour),i(Oe,Xe),Te(ke,`color: ${ze??""}`),i(la,Ee)},[()=>W(t(A).recent_success_rate),()=>I(t(A).recent_average_sentiment),()=>t(A).recent_average_sentiment.toFixed(2)]),n(p,f)};b(T,p=>{t(A)&&p(ea)})}var Fe=s(T,2),Ie=a(Fe),Me=s(a(Ie),2),Ve=s(a(Me),2),R=a(Ve,!0);e(Ve),e(Me),e(Ie);var te=s(Ie,2),Ce=s(a(te),2),Ye=s(a(Ce),2),Be=a(Ye,!0);e(Ye),e(Ce),e(te);var He=s(te,2),Ke=s(a(He),2),S=s(a(Ke),2),m=a(S,!0);e(S),e(Ke),e(He);var g=s(He,2),se=s(a(g),2),re=s(a(se),2),We=a(re,!0);e(re),e(se),e(g);var _e=s(g,2),le=s(a(_e),2),w=s(a(le),2),Q=a(w,!0);e(w),e(le),e(_e);var Z=s(_e,2),ie=s(a(Z),2),ve=s(a(ie),2),ye=a(ve,!0);e(ve),e(ie),e(Z);var ne=s(Z,2),me=s(a(ne),2),qe=s(a(me),2),ee=a(qe,!0);e(qe),e(me),e(ne);var Pe=s(ne,2),ce=s(a(Pe),2),Se=s(a(ce),2),fe=a(Se,!0);e(Se),e(ce),e(Pe),e(Fe);var Ue=s(Fe,2);{var D=p=>{var f=La(),x=s(a(f),2);ca(x,21,()=>Object.entries(t(o).provider_performance),oa,(X,be)=>{var oe=K(()=>fa(t(be),2));let $=()=>t(oe)[0],y=()=>t(oe)[1];var q=ja(),B=a(q),Oe=a(B),aa=a(Oe,!0);e(Oe);var ke=s(Oe,2),la=a(ke);e(ke),e(B);var Xe=s(B,2),ze=a(Xe),Ee=s(a(ze),2),ba=a(Ee,!0);e(Ee),e(ze);var Ne=s(ze,2),da=s(a(Ne),2),pa=a(da,!0);e(da),e(Ne);var ia=s(Ne,2),ua=s(a(ia),2),ga=a(ua,!0);e(ua),e(ia);var _a=s(ia,2),ma=s(a(_a),2),wa=a(ma,!0);e(ma),e(_a),e(Xe),e(q),h((ka,Ta,Ra,Da)=>{i(aa,L[$()]||$()),i(la,`${y().total_calls??""} calls`),i(ba,ka),i(pa,Ta),i(ga,Ra),i(wa,Da)},[()=>W(y().successful_calls/y().total_calls*100),()=>y().average_audio_quality.toFixed(1),()=>W(y().uptime_percentage),()=>W(y().error_rate)]),n(X,q)}),e(x),e(f),n(p,f)};b(Ue,p=>{Object.keys(t(o).provider_performance).length>0&&p(D)})}var O=s(Ue,2);{var he=p=>{var f=Ha(),x=s(a(f),2),X=s(a(x),2);ca(X,17,()=>Object.entries(t(o).agent_performance),oa,(be,oe)=>{var $=K(()=>fa(t(oe),2));let y=()=>t($)[0],q=()=>t($)[1];var B=Ya(),Oe=a(B),aa=a(Oe,!0);e(Oe);var ke=s(Oe,2),la=a(ke,!0);e(ke);var Xe=s(ke,2),ze=a(Xe,!0);e(Xe);var Ee=s(Xe,2),ba=a(Ee,!0);e(Ee);var Ne=s(Ee,2),da=a(Ne,!0);e(Ne);var pa=s(Ne,2),ia=a(pa,!0);e(pa),e(B),h((ua,ga,_a,ma,wa)=>{i(aa,y()),i(la,q().total_calls),i(ze,ua),i(ba,ga),Te(Ne,`color: ${_a??""}`),i(da,ma),i(ia,wa)},[()=>W(q().completed_calls/q().total_calls*100),()=>ge(q().average_call_duration),()=>I(q().average_sentiment),()=>q().average_sentiment.toFixed(2),()=>q().quality_score.toFixed(1)]),n(be,B)}),e(x),e(f),n(p,f)};b(O,p=>{Object.keys(t(o).agent_performance).length>0&&p(he)})}var $e=s(O,2);{var V=p=>{var f=Ua(),x=s(a(f),2),X=a(x),be=a(X);e(X),ta(2),e(x),e(f),h(()=>i(be,`${t(o).calls_over_time.length??""} data points over the last 24 hours`)),n(p,f)};b($e,p=>{t(o).calls_over_time.length>0&&p(V)})}h((p,f,x,X,be,oe,$)=>{i(R,t(o).total_calls),i(Be,t(o).completed_calls),i(m,t(o).failed_calls),i(We,p),i(Q,f),Te(ve,`color: ${x??""}`),i(ye,X),Te(qe,`color: ${be??""}`),i(ee,oe),i(fe,$)},[()=>W(t(o).success_rate),()=>ge(t(o).average_call_duration),()=>I(t(o).average_sentiment),()=>t(o).average_sentiment.toFixed(2),()=>k(t(o).average_audio_quality),()=>t(o).average_audio_quality.toFixed(1),()=>W(t(o).average_transcription_accuracy*100)]),n(Y,C)},G=Y=>{var C=Ea();n(Y,C)};b(v,Y=>{t(o)?Y(d):Y(G,!1)},!0)}n(l,r)};b(Ze,l=>{t(F)&&!t(o)?l(sa):l(ra,!1)})}e(ue),h(()=>{J.disabled=t(F),ae=de(xe,1,"refresh-icon svelte-1992uwp",null,ae,{spinning:t(F)})}),n(Ge,ue),ya()}ha(["click"]);var Qa=c('<div class="error-banner svelte-1alq6p3"><span class="error-icon">âš </span> <span class="error-text"> </span></div>'),Va=c('<div class="loading-state svelte-1alq6p3"><span class="spinner svelte-1alq6p3">âŸ³</span> <p>Loading metrics...</p></div>'),Ba=Aa('<circle r="4" stroke="white" stroke-width="2"><title> </title></circle>'),Ka=c('<div class="chart-wrapper"><svg class="chart-svg" preserveAspectRatio="xMidYMid meet"><defs><pattern id="grid" width="80" height="60" patternUnits="userSpaceOnUse"><path d="M 80 0 L 0 0 0 60" fill="none" stroke="#e5e7eb" stroke-width="1"></path></pattern></defs><rect width="100%" height="100%" fill="url(#grid)"></rect><path fill="none" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"></path><!></svg></div> <div class="chart-legend"><div class="legend-item"><div class="legend-color"></div> <span class="legend-label"> </span></div> <div class="legend-stats"><span class="stat-item svelte-1alq6p3"> </span> <span class="stat-item svelte-1alq6p3"> </span> <span class="stat-item svelte-1alq6p3"> </span></div></div>',1),Wa=c('<div class="no-chart-data svelte-1alq6p3"><p> </p> <p class="hint">Data will appear once calls are made</p></div>'),za=c('<div class="table-row svelte-1alq6p3"><span class="col-provider"><span class="provider-dot svelte-1alq6p3"></span> </span> <span class="col-calls"> </span> <span class="col-success"> </span> <span class="col-latency"> </span> <span class="col-quality"> </span> <span class="col-uptime"> </span> <span> </span></div>'),Ja=c('<div class="comparison-section svelte-1alq6p3"><h4 class="comparison-title svelte-1alq6p3">Provider Performance Comparison</h4> <div class="comparison-table svelte-1alq6p3"><div class="table-header svelte-1alq6p3"><span class="col-provider">Provider</span> <span class="col-calls">Total Calls</span> <span class="col-success">Success Rate</span> <span class="col-latency">Avg Latency</span> <span class="col-quality">Audio Quality</span> <span class="col-uptime">Uptime</span> <span class="col-error">Error Rate</span></div> <!></div></div>'),Za=c('<div class="chart-selector svelte-1alq6p3"><button>ğŸ“ Call Volume</button> <button>ğŸ˜Š Sentiment</button> <button>ğŸ¤ Audio Quality</button></div> <div class="chart-container svelte-1alq6p3"><div class="chart-header svelte-1alq6p3"><h4 class="chart-title svelte-1alq6p3"> </h4> <span class="data-points"> </span></div> <!></div> <!>',1),et=c('<div class="provider-metrics-display svelte-1alq6p3"><div class="header svelte-1alq6p3"><h3 class="title svelte-1alq6p3">Provider Metrics & Trends</h3> <button class="refresh-btn svelte-1alq6p3"><span>ğŸ”„</span> Refresh</button></div> <!> <!></div>');function at(Ge,_){xa(_,!0),Le(_,"timeRange",3,"24h");let Re=Le(_,"autoRefresh",3,!0),De=Le(_,"refreshInterval",3,6e4),o=j(va([])),A=j(va([])),F=j(va([])),H=j(va({})),P=j(!0),U=j(null),L=j("calls"),pe=null;const ge={gemini:"Google Gemini",openai:"OpenAI Realtime",deepgram_nova3:"Deepgram Nova 3",twilio:"Twilio",telnyx:"Telnyx"},W={gemini:"#4285f4",openai:"#10b981",deepgram_nova3:"#f59e0b",twilio:"#ef4444",telnyx:"#8b5cf6"};async function I(){try{u(U,null);const l=await fetch("http://localhost:8000/analytics/summary");if(!l.ok)throw new Error(`HTTP ${l.status}: ${l.statusText}`);const v=(await l.json()).summary;u(o,v.calls_over_time||[],!0),u(A,v.sentiment_over_time||[],!0),u(F,v.quality_over_time||[],!0),u(H,v.provider_performance||{},!0),u(P,!1)}catch(l){u(U,l instanceof Error?l.message:"Failed to fetch metrics",!0),console.error("Failed to fetch metrics:",l),u(P,!1)}}function k(l){return l.length===0?[]:l.map((r,v)=>({x:v,y:r.value,label:new Date(r.timestamp).toLocaleTimeString()}))}function we(l){if(l.length===0)return{minY:0,maxY:100,minX:0,maxX:100};const r=l.map(T=>T.y),v=Math.min(...r),d=Math.max(...r),G=0,Y=l.length-1,C=(d-v)*.1||10;return{minY:v-C,maxY:d+C,minX:G,maxX:Y}}function ue(l,r,v,d){if(l.length===0)return"";const G=T=>(T-r.minX)/(r.maxX-r.minX)*v,Y=T=>d-(T-r.minY)/(r.maxY-r.minY)*d;return`M ${l.map(T=>`${G(T.x)},${Y(T.y)}`).join(" L ")}`}const z=K(()=>()=>{switch(t(L)){case"calls":return k(t(o));case"sentiment":return k(t(A));case"quality":return k(t(F));default:return[]}}),M=K(()=>()=>{switch(t(L)){case"calls":return{title:"Call Volume Over Time",color:"#3b82f6",unit:"calls"};case"sentiment":return{title:"Sentiment Trend",color:"#10b981",unit:"score"};case"quality":return{title:"Audio Quality Trend",color:"#f59e0b",unit:"score"};default:return{title:"Metrics",color:"#6b7280",unit:""}}});qa(()=>{I(),Re()&&(pe=setInterval(I,De()))}),$a(()=>{pe&&clearInterval(pe)});var E=et(),N=a(E),J=s(a(N),2);J.__click=I;var xe=a(J);let ae;ta(),e(J),e(N);var Ae=s(N,2);{var Qe=l=>{var r=Qa(),v=s(a(r),2),d=a(v,!0);e(v),e(r),h(()=>i(d,t(U))),n(l,r)};b(Ae,l=>{t(U)&&l(Qe)})}var Ze=s(Ae,2);{var sa=l=>{var r=Va();n(l,r)},ra=l=>{var r=Za(),v=je(r),d=a(v);let G;d.__click=()=>u(L,"calls");var Y=s(d,2);let C;Y.__click=()=>u(L,"sentiment");var T=s(Y,2);let ea;T.__click=()=>u(L,"quality"),e(v);var Fe=s(v,2),Ie=a(Fe),Me=a(Ie),Ve=a(Me,!0);e(Me);var R=s(Me,2),te=a(R);e(R),e(Ie);var Ce=s(Ie,2);{var Ye=S=>{const m=K(()=>t(z)()),g=K(()=>we(t(m))),se=K(()=>800),re=K(()=>300),We=K(()=>ue(t(m),t(g),t(se),t(re)));var _e=Ka(),le=je(_e),w=a(le);Je(w,"viewBox",`0 0 ${t(se)??""} ${t(re)??""}`);var Q=s(a(w),2),Z=s(Q);ca(Z,17,()=>t(m),oa,(D,O)=>{const he=K(()=>(t(O).x-t(g).minX)/(t(g).maxX-t(g).minX)*t(se)),$e=K(()=>t(re)-(t(O).y-t(g).minY)/(t(g).maxY-t(g).minY)*t(re));var V=Ba(),p=a(V),f=a(p);e(p),e(V),h((x,X)=>{Je(V,"cx",t(he)),Je(V,"cy",t($e)),Je(V,"fill",x),i(f,`${t(O).label??""}: ${X??""}`)},[()=>t(M)().color,()=>t(O).y.toFixed(2)]),n(D,V)}),e(w),e(le);var ie=s(le,2),ve=a(ie),ye=a(ve),ne=s(ye,2),me=a(ne,!0);e(ne),e(ve);var qe=s(ve,2),ee=a(qe),Pe=a(ee);e(ee);var ce=s(ee,2),Se=a(ce);e(ce);var fe=s(ce,2),Ue=a(fe);e(fe),e(qe),e(ie),h((D,O,he,$e,V,p)=>{Je(Q,"d",t(We)),Je(Q,"stroke",D),Te(ye,`background: ${O??""}`),i(me,he),i(Pe,`Min: ${$e??""}`),i(Se,`Max: ${V??""}`),i(Ue,`Avg: ${p??""}`)},[()=>t(M)().color,()=>t(M)().color,()=>t(M)().title,()=>Math.min(...t(m).map(D=>D.y)).toFixed(2),()=>Math.max(...t(m).map(D=>D.y)).toFixed(2),()=>(t(m).reduce((D,O)=>D+O.y,0)/t(m).length).toFixed(2)]),n(S,_e)},Be=S=>{var m=Wa(),g=a(m),se=a(g);e(g),ta(2),e(m),h(()=>i(se,`No ${t(L)??""} data available`)),n(S,m)};b(Ce,S=>{t(z)().length>0?S(Ye):S(Be,!1)})}e(Fe);var He=s(Fe,2);{var Ke=S=>{var m=Ja(),g=s(a(m),2),se=s(a(g),2);ca(se,17,()=>Object.entries(t(H)),oa,(re,We)=>{var _e=K(()=>fa(t(We),2));let le=()=>t(_e)[0],w=()=>t(_e)[1];var Q=za(),Z=a(Q),ie=a(Z),ve=s(ie);e(Z);var ye=s(Z,2),ne=a(ye,!0);e(ye);var me=s(ye,2),qe=a(me);e(me);var ee=s(me,2),Pe=a(ee);e(ee);var ce=s(ee,2),Se=a(ce,!0);e(ce);var fe=s(ce,2),Ue=a(fe);e(fe);var D=s(fe,2);let O;var he=a(D);e(D),e(Q),h(($e,V,p,f,x)=>{Te(ie,`background: ${(W[le()]||"#6b7280")??""}`),i(ve,` ${(ge[le()]||le())??""}`),i(ne,w().total_calls),i(qe,`${$e??""}%`),i(Pe,`${V??""}ms`),i(Se,p),i(Ue,`${f??""}%`),O=de(D,1,"col-error svelte-1alq6p3",null,O,{"high-error":w().error_rate>10}),i(he,`${x??""}%`)},[()=>(w().successful_calls/w().total_calls*100).toFixed(1),()=>w().average_latency_ms.toFixed(0),()=>w().average_audio_quality.toFixed(1),()=>w().uptime_percentage.toFixed(1),()=>w().error_rate.toFixed(1)]),n(re,Q)}),e(g),e(m),n(S,m)};b(He,S=>{Object.keys(t(H)).length>0&&S(Ke)})}h((S,m)=>{G=de(d,1,"selector-btn svelte-1alq6p3",null,G,{active:t(L)==="calls"}),C=de(Y,1,"selector-btn svelte-1alq6p3",null,C,{active:t(L)==="sentiment"}),ea=de(T,1,"selector-btn svelte-1alq6p3",null,ea,{active:t(L)==="quality"}),i(Ve,S),i(te,`${m??""} data points`)},[()=>t(M)().title,()=>t(z)().length]),n(l,r)};b(Ze,l=>{t(P)&&t(o).length===0?l(sa):l(ra,!1)})}e(E),h(()=>{J.disabled=t(P),ae=de(xe,1,"refresh-icon svelte-1alq6p3",null,ae,{spinning:t(P)})}),n(Ge,E),ya()}ha(["click"]);var tt=c('<span class="last-update svelte-33263f"> </span>'),st=c('<div class="error-banner svelte-33263f"><span class="error-icon svelte-33263f">âš </span> <span class="error-text svelte-33263f"> </span></div>'),rt=c('<div class="loading svelte-33263f">Loading provider health...</div>'),lt=c('<div class="no-data svelte-33263f">No provider health data available</div>'),it=c('<div class="warning-footer svelte-33263f"> </div>'),vt=c('<div class="error-footer svelte-33263f"> </div>'),nt=c('<div class="metrics-grid svelte-33263f"><div class="metric-item svelte-33263f"><span class="metric-label svelte-33263f">Latency</span> <span class="metric-value svelte-33263f"> </span></div> <div class="metric-item svelte-33263f"><span class="metric-label svelte-33263f">Uptime</span> <span class="metric-value svelte-33263f"> </span></div> <div class="metric-item svelte-33263f"><span class="metric-label svelte-33263f">Success Rate</span> <span class="metric-value svelte-33263f"> </span></div> <div class="metric-item svelte-33263f"><span class="metric-label svelte-33263f">Checks</span> <span class="metric-value svelte-33263f"> </span></div></div> <div class="progress-section svelte-33263f"><div class="progress-item svelte-33263f"><div class="progress-label svelte-33263f"><span class="svelte-33263f">Uptime</span> <span class="svelte-33263f"> </span></div> <div class="progress-bar svelte-33263f"><div class="progress-fill svelte-33263f"></div></div></div></div> <!> <!>',1),ct=c('<div class="provider-card svelte-33263f"><div class="card-header svelte-33263f"><div class="provider-name svelte-33263f"><span class="status-dot svelte-33263f"></span> <span class="name-text svelte-33263f"> </span></div> <div class="status-badge svelte-33263f"><span class="status-icon svelte-33263f"> </span> <span class="status-text svelte-33263f"> </span></div></div> <!></div>'),ot=c('<div><div class="header svelte-33263f"><div class="title-section svelte-33263f"><h3 class="title svelte-33263f">Provider Health</h3> <!></div> <button class="refresh-btn svelte-33263f"><span>ğŸ”„</span> Refresh</button></div> <!> <div><!></div></div>');function dt(Ge,_){xa(_,!0);let Re=Le(_,"autoRefresh",3,!0),De=Le(_,"refreshInterval",3,15e3),o=Le(_,"compact",3,!1),A=j(va({})),F=j(!0),H=j(null),P=j(null),U=null;const L={gemini:"Google Gemini",openai:"OpenAI Realtime",deepgram_nova3:"Deepgram Nova 3",twilio:"Twilio",telnyx:"Telnyx"},pe={healthy:{bg:"#d1fae5",border:"#10b981",text:"#065f46",dot:"#10b981"},degraded:{bg:"#fef3c7",border:"#f59e0b",text:"#92400e",dot:"#f59e0b"},unhealthy:{bg:"#fee2e2",border:"#ef4444",text:"#991b1b",dot:"#ef4444"},offline:{bg:"#f3f4f6",border:"#6b7280",text:"#374151",dot:"#6b7280"},unknown:{bg:"#f3f4f6",border:"#9ca3af",text:"#6b7280",dot:"#9ca3af"}};async function ge(){try{u(P,null);const r=await fetch("http://localhost:8000/providers/health");if(!r.ok)throw new Error(`HTTP ${r.status}: ${r.statusText}`);const v=await r.json();u(A,v,!0),u(H,new Date,!0),u(F,!1)}catch(r){u(P,r instanceof Error?r.message:"Failed to fetch provider health",!0),console.error("Failed to fetch provider health:",r),u(F,!1)}}function W(r){return r<1?"<1ms":r<1e3?`${Math.round(r)}ms`:`${(r/1e3).toFixed(2)}s`}function I(r){switch(r){case"healthy":return"âœ“";case"degraded":return"âš ";case"unhealthy":return"âœ—";case"offline":return"â—‹";default:return"?"}}qa(()=>{ge(),Re()&&(U=setInterval(ge,De()))}),$a(()=>{U&&clearInterval(U)});var k=ot();let we;var ue=a(k),z=a(ue),M=s(a(z),2);{var E=r=>{var v=tt(),d=a(v);e(v),h(G=>i(d,`Updated ${G??""}`),[()=>t(H).toLocaleTimeString()]),n(r,v)};b(M,r=>{t(H)&&r(E)})}e(z);var N=s(z,2);N.__click=ge;var J=a(N);let xe;ta(),e(N),e(ue);var ae=s(ue,2);{var Ae=r=>{var v=st(),d=s(a(v),2),G=a(d,!0);e(d),e(v),h(()=>i(G,t(P))),n(r,v)};b(ae,r=>{t(P)&&r(Ae)})}var Qe=s(ae,2);let Ze;var sa=a(Qe);{var ra=r=>{var v=rt();n(r,v)},l=r=>{var v=na(),d=je(v);{var G=C=>{var T=lt();n(C,T)},Y=C=>{var T=na(),ea=je(T);ca(ea,17,()=>Object.entries(t(A)),oa,(Fe,Ie)=>{var Me=K(()=>fa(t(Ie),2));let Ve=()=>t(Me)[0],R=()=>t(Me)[1];const te=K(()=>pe[R().status]);var Ce=ct(),Ye=a(Ce),Be=a(Ye),He=a(Be),Ke=s(He,2),S=a(Ke,!0);e(Ke),e(Be);var m=s(Be,2),g=a(m),se=a(g,!0);e(g);var re=s(g,2),We=a(re,!0);e(re),e(m),e(Ye);var _e=s(Ye,2);{var le=w=>{var Q=nt(),Z=je(Q),ie=a(Z),ve=s(a(ie),2),ye=a(ve,!0);e(ve),e(ie);var ne=s(ie,2),me=s(a(ne),2),qe=a(me);e(me),e(ne);var ee=s(ne,2),Pe=s(a(ee),2),ce=a(Pe);e(Pe),e(ee);var Se=s(ee,2),fe=s(a(Se),2),Ue=a(fe,!0);e(fe),e(Se),e(Z);var D=s(Z,2),O=a(D),he=a(O),$e=s(a(he),2),V=a($e);e($e),e(he);var p=s(he,2),f=a(p);e(p),e(O),e(D);var x=s(D,2);{var X=$=>{var y=it(),q=a(y);e(y),h(()=>i(q,`âš  ${R().consecutive_failures??""} consecutive failures`)),n($,y)};b(x,$=>{R().consecutive_failures>0&&$(X)})}var be=s(x,2);{var oe=$=>{var y=vt(),q=a(y);e(y),h(B=>{Je(y,"title",R().last_error),i(q,`Last error: ${B??""}...`)},[()=>R().last_error.substring(0,50)]),n($,y)};b(be,$=>{R().last_error&&$(oe)})}h(($,y,q,B)=>{i(ye,$),i(qe,`${y??""}%`),i(ce,`${q??""}%`),i(Ue,R().total_checks),i(V,`${B??""}%`),Te(f,`width: ${R().uptime_percentage??""}%; background: ${t(te).border??""}`)},[()=>W(R().average_latency_ms),()=>R().uptime_percentage.toFixed(1),()=>R().success_rate.toFixed(1),()=>R().uptime_percentage.toFixed(1)]),n(w,Q)};b(_e,w=>{o()||w(le)})}e(Ce),h((w,Q)=>{Te(Ce,`border-color: ${t(te).border??""}; background: ${t(te).bg??""}`),Te(He,`background: ${t(te).dot??""}`),i(S,L[Ve()]||Ve()),Te(m,`color: ${t(te).text??""}; border-color: ${t(te).border??""}`),i(se,w),i(We,Q)},[()=>I(R().status),()=>R().status.toUpperCase()]),n(Fe,Ce)}),n(C,T)};b(d,C=>{Object.keys(t(A)).length===0?C(G):C(Y,!1)},!0)}n(r,v)};b(sa,r=>{t(F)&&Object.keys(t(A)).length===0?r(ra):r(l,!1)})}e(Qe),e(k),h(()=>{we=de(k,1,"provider-health-monitor svelte-33263f",null,we,{compact:o()}),N.disabled=t(F),xe=de(J,1,"refresh-icon svelte-33263f",null,xe,{spinning:t(F)}),Ze=de(Qe,1,"providers-grid svelte-33263f",null,Ze,{compact:o()})}),n(Ge,k),ya()}ha(["click"]);var pt=c('<meta name="description" content="Real-time analytics and performance metrics"/>'),ut=c('<div class="tab-panel svelte-10q6bi9" data-tab="overview"><!></div>'),_t=c('<div class="tab-panel svelte-10q6bi9" data-tab="metrics"><!></div>'),mt=c('<div class="tab-panel svelte-10q6bi9" data-tab="health"><!></div>'),ft=c('<div class="analytics-page svelte-10q6bi9"><div class="page-header svelte-10q6bi9"><div class="header-content svelte-10q6bi9"><h1 class="page-title svelte-10q6bi9">Analytics & Insights</h1> <p class="page-description svelte-10q6bi9">Real-time monitoring of call metrics, provider performance, and agent activity</p></div></div> <div class="tab-navigation svelte-10q6bi9"><button><span class="tab-icon svelte-10q6bi9">ğŸ“Š</span> <span class="tab-label svelte-10q6bi9">Overview</span></button> <button><span class="tab-icon svelte-10q6bi9">ğŸ“ˆ</span> <span class="tab-label svelte-10q6bi9">Metrics & Charts</span></button> <button><span class="tab-icon svelte-10q6bi9">ğŸ¥</span> <span class="tab-label svelte-10q6bi9">Provider Health</span></button></div> <div class="tab-content svelte-10q6bi9"><!></div> <div class="info-section svelte-10q6bi9"><div class="info-card svelte-10q6bi9"><div class="info-icon svelte-10q6bi9">ğŸ’¡</div> <div class="info-content"><h4 class="info-title svelte-10q6bi9">Getting Started</h4> <p class="info-text svelte-10q6bi9">Analytics data is collected from all active calls. Visit the <a href="/calls/agent" class="svelte-10q6bi9">Agent Operations</a> page to start demo calls and see live metrics.</p></div></div> <div class="info-card svelte-10q6bi9"><div class="info-icon svelte-10q6bi9">âš™ï¸</div> <div class="info-content"><h4 class="info-title svelte-10q6bi9">Auto-Refresh</h4> <p class="info-text svelte-10q6bi9">All dashboards auto-refresh to show the latest data. Overview refreshes every 30 seconds, metrics every 60 seconds, and health every 15 seconds.</p></div></div> <div class="info-card svelte-10q6bi9"><div class="info-icon svelte-10q6bi9">ğŸ“‹</div> <div class="info-content"><h4 class="info-title svelte-10q6bi9">Data Retention</h4> <p class="info-text svelte-10q6bi9">Time-series data is retained for 24 hours. Historical summaries can be retrieved via the API with custom date ranges.</p></div></div></div></div>');function At(Ge){let _=j("overview");var Re=ft();Ma("10q6bi9",I=>{var k=pt();Fa(()=>{Ia.title="Analytics Dashboard | Voice by Kraliki"}),n(I,k)});var De=s(a(Re),2),o=a(De);let A;o.__click=()=>u(_,"overview");var F=s(o,2);let H;F.__click=()=>u(_,"metrics");var P=s(F,2);let U;P.__click=()=>u(_,"health"),e(De);var L=s(De,2),pe=a(L);{var ge=I=>{var k=ut(),we=a(k);Ga(we,{autoRefresh:!0,refreshInterval:3e4}),e(k),n(I,k)},W=I=>{var k=na(),we=je(k);{var ue=M=>{var E=_t(),N=a(E);at(N,{autoRefresh:!0,refreshInterval:6e4}),e(E),n(M,E)},z=M=>{var E=na(),N=je(E);{var J=xe=>{var ae=mt(),Ae=a(ae);dt(Ae,{autoRefresh:!0,refreshInterval:15e3,compact:!1}),e(ae),n(xe,ae)};b(N,xe=>{t(_)==="health"&&xe(J)},!0)}n(M,E)};b(we,M=>{t(_)==="metrics"?M(ue):M(z,!1)},!0)}n(I,k)};b(pe,I=>{t(_)==="overview"?I(ge):I(W,!1)})}e(L),ta(2),e(Re),h(()=>{A=de(o,1,"tab-btn svelte-10q6bi9",null,A,{active:t(_)==="overview"}),H=de(F,1,"tab-btn svelte-10q6bi9",null,H,{active:t(_)==="metrics"}),U=de(P,1,"tab-btn svelte-10q6bi9",null,U,{active:t(_)==="health"})}),n(Ge,Re)}ha(["click"]);export{At as component};

import{f as l,a as o,c as pe}from"../chunks/pFl1CK35.js";import"../chunks/CnJ-dsFT.js";import{o as he,a as we}from"../chunks/0VtO9hYy.js";import{p as ye,d as e,e as s,c as ke,f as z,J as q,r as t,g as a,t as j,h as Qt,n as E}from"../chunks/aQ_ifger.js";import{s as i}from"../chunks/DBuqHHqM.js";import{i as f}from"../chunks/BTxJJ6eU.js";import{e as ut,i as xt}from"../chunks/oqRKM5NY.js";import{a as $e}from"../chunks/BqAhscvM.js";import{s as bt}from"../chunks/DGR2HyJN.js";import{d as Ae}from"../chunks/C918u5xm.js";import{i as je}from"../chunks/ft9JqUN4.js";import{g as N}from"../chunks/CTjsJUPt.js";var De=l('<div class="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-4"> </div>'),Se=l('<div class="text-center py-12"><div class="inline-block animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"></div> <p class="mt-4 text-gray-600">Loading dashboard...</p></div>'),Ce=l('<button class="ml-4 px-3 py-1 text-sm bg-white rounded hover:bg-gray-50">Acknowledge</button>'),Me=l('<div><div class="flex-1"><div class="flex items-center gap-2 mb-1"><span class="font-semibold"> </span> <span class="text-xs uppercase font-bold"> </span></div> <p class="text-sm"> </p> <p class="text-xs mt-1 opacity-75"> </p></div> <!></div>'),ze=l('<button class="mt-2 text-blue-600 hover:text-blue-800 text-sm"> </button>'),Re=l('<div class="mb-6"><h2 class="text-xl font-semibold mb-3"> </h2> <div class="space-y-2"></div> <!></div>'),Te=l('<div class="text-center py-8 text-gray-500">No agents available</div>'),Be=l('<div class="text-orange-600 mt-1">üîá On Hold</div>'),Ie=l('<div class="text-xs bg-gray-50 rounded p-2"><div class="flex items-center justify-between"><span class="capitalize"> </span> <span class="font-medium"> </span></div> <!></div>'),Oe=l('<div class="mt-3 space-y-1"></div>'),Le=l('<div class="border rounded-lg p-4 hover:shadow-md transition-shadow"><div class="flex items-start justify-between mb-2"><div class="flex items-center gap-2"><div></div> <button class="font-medium hover:text-blue-600"> </button></div> <span> </span></div> <div class="text-sm text-gray-600"><div> </div> <div class="mt-1"> </div></div> <!></div>'),qe=l('<div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"></div>'),Ee=l('<div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-6"><div class="bg-white p-6 rounded-lg shadow"><div class="flex items-center justify-between"><div><div class="text-sm text-gray-600 mb-1">Active Calls</div> <div class="text-3xl font-bold text-blue-600"> </div></div> <div class="text-4xl">üìû</div></div></div> <div class="bg-white p-6 rounded-lg shadow"><div class="flex items-center justify-between"><div><div class="text-sm text-gray-600 mb-1">Queue Waiting</div> <div class="text-3xl font-bold text-orange-600"> </div></div> <div class="text-4xl">‚è±Ô∏è</div></div></div> <div class="bg-white p-6 rounded-lg shadow"><div class="flex items-center justify-between"><div><div class="text-sm text-gray-600 mb-1">Avg Wait Time</div> <div class="text-3xl font-bold"> </div></div> <div class="text-4xl">‚è≥</div></div></div> <div class="bg-white p-6 rounded-lg shadow"><div class="flex items-center justify-between"><div><div class="text-sm text-gray-600 mb-1">Abandon Rate</div> <div class="text-3xl font-bold text-red-600"> </div></div> <div class="text-4xl">üìâ</div></div></div></div> <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-6"><div class="bg-white p-4 rounded-lg shadow"><div class="text-sm text-gray-600 mb-2">Available</div> <div class="text-2xl font-bold text-green-600"> </div></div> <div class="bg-white p-4 rounded-lg shadow"><div class="text-sm text-gray-600 mb-2">On Call</div> <div class="text-2xl font-bold text-blue-600"> </div></div> <div class="bg-white p-4 rounded-lg shadow"><div class="text-sm text-gray-600 mb-2">On Break</div> <div class="text-2xl font-bold text-orange-600"> </div></div> <div class="bg-white p-4 rounded-lg shadow"><div class="text-sm text-gray-600 mb-2">Offline</div> <div class="text-2xl font-bold text-gray-600"> </div></div></div> <!> <div class="bg-white rounded-lg shadow p-6"><div class="flex items-center justify-between mb-4"><h2 class="text-xl font-semibold"> </h2> <button class="text-blue-600 hover:text-blue-800 text-sm flex items-center gap-1"><span>üîÑ</span> Refresh</button></div> <!></div> <div class="mt-4 text-center text-sm text-gray-500"> <span class="ml-2">‚Ä¢ Auto-refreshing every 5 seconds</span></div>',1),He=l('<div class="container mx-auto p-6"><div class="mb-6 flex items-center justify-between"><div><h1 class="text-3xl font-bold">Supervisor Dashboard</h1> <p class="text-gray-600 mt-1">Real-time monitoring and control center</p></div> <div class="flex gap-3"><button class="px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700">Call Queue</button> <button class="px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700">Active Calls</button></div></div> <!> <!></div>');function Ze(Wt,Ft){ye(Ft,!1);let c=q(null),H=q([]),D=q([]),V=q(!0),G=q(""),K,gt=null;const mt={offline:"bg-gray-400",available:"bg-green-500",busy:"bg-yellow-500",on_call:"bg-blue-500",break:"bg-orange-500",training:"bg-purple-500",away:"bg-red-500"},Nt={info:"bg-blue-100 text-blue-800 border-blue-200",warning:"bg-yellow-100 text-yellow-800 border-yellow-200",critical:"bg-red-100 text-red-800 border-red-200"};he(async()=>{await J(),K=setInterval(J,5e3)}),we(()=>{K&&clearInterval(K)});async function J(){try{const r=localStorage.getItem("token"),v=gt?`?team_id=${gt}`:"",b=await fetch(`/api/supervisor/dashboard/stats${v}`,{headers:{Authorization:`Bearer ${r}`}});b.ok&&z(c,await b.json());const S=await fetch(`/api/supervisor/agents/live-status${v}`,{headers:{Authorization:`Bearer ${r}`}});S.ok&&z(H,await S.json());const u=await fetch(`/api/supervisor/alerts${v}`,{headers:{Authorization:`Bearer ${r}`}});u.ok&&z(D,await u.json()),z(V,!1)}catch(r){z(G,`Error loading dashboard: ${r}`),z(V,!1)}}async function Vt(r){try{const v=localStorage.getItem("token");(await fetch(`/api/supervisor/alerts/${r}/acknowledge`,{method:"POST",headers:{Authorization:`Bearer ${v}`}})).ok&&await J()}catch(v){console.error("Error acknowledging alert:",v)}}function ft(r){const v=Math.floor(r/60),b=r%60;return`${v}m ${b}s`}function U(r){const v=new Date(r),S=new Date().getTime()-v.getTime(),u=Math.floor(S/6e4);if(u<1)return"Just now";if(u<60)return`${u}m ago`;const C=Math.floor(u/60);return C<24?`${C}h ago`:`${Math.floor(C/24)}d ago`}je();var X=He(),Y=e(X),pt=s(e(Y),2),ht=e(pt);ht.__click=()=>N("/supervisor/queue");var Gt=s(ht,2);Gt.__click=()=>N("/supervisor/active-calls"),t(pt),t(Y);var wt=s(Y,2);{var Kt=r=>{var v=De(),b=e(v,!0);t(v),j(()=>i(b,a(G))),o(r,v)};f(wt,r=>{a(G)&&r(Kt)})}var Ut=s(wt,2);{var Xt=r=>{var v=Se();o(r,v)},Yt=r=>{var v=pe(),b=Qt(v);{var S=u=>{var C=Ee(),P=Qt(C),Z=e(P),yt=e(Z),kt=e(yt),$t=s(e(kt),2),Zt=e($t,!0);t($t),t(kt),E(2),t(yt),t(Z);var tt=s(Z,2),At=e(tt),jt=e(At),Dt=s(e(jt),2),te=e(Dt,!0);t(Dt),t(jt),E(2),t(At),t(tt);var et=s(tt,2),St=e(et),Ct=e(St),Mt=s(e(Ct),2),ee=e(Mt,!0);t(Mt),t(Ct),E(2),t(St),t(et);var zt=s(et,2),Rt=e(zt),Tt=e(Rt),Bt=s(e(Tt),2),ae=e(Bt);t(Bt),t(Tt),E(2),t(Rt),t(zt),t(P);var at=s(P,2),st=e(at),It=s(e(st),2),se=e(It,!0);t(It),t(st);var rt=s(st,2),Ot=s(e(rt),2),re=e(Ot,!0);t(Ot),t(rt);var it=s(rt,2),Lt=s(e(it),2),ie=e(Lt,!0);t(Lt),t(it);var qt=s(it,2),Et=s(e(qt),2),ve=e(Et,!0);t(Et),t(qt),t(at);var Ht=s(at,2);{var de=_=>{var x=Re(),h=e(x),n=e(h);t(h);var w=s(h,2);ut(w,5,()=>a(D).slice(0,5),xt,(g,d)=>{var p=Me(),y=e(p),B=e(y),k=e(B),I=e(k,!0);t(k);var Q=s(k,2),W=e(Q,!0);t(Q),t(B);var O=s(B,2),lt=e(O,!0);t(O);var F=s(O,2),$=e(F,!0);t(F),t(y);var A=s(y,2);{var nt=m=>{var M=Ce();M.__click=()=>Vt(a(d).id),o(m,M)};f(A,m=>{a(d).is_acknowledged||m(nt)})}t(p),j(m=>{bt(p,1,`border rounded-lg p-4 ${Nt[a(d).severity]??""} flex items-start justify-between`),i(I,a(d).title),i(W,a(d).severity),i(lt,a(d).message),i($,m)},[()=>U(a(d).created_at)]),o(g,p)}),t(w);var R=s(w,2);{var T=g=>{var d=ze();d.__click=()=>N("/supervisor/alerts");var p=e(d);t(d),j(()=>i(p,`View all ${a(D).length??""} alerts ‚Üí`)),o(g,d)};f(R,g=>{a(D).length>5&&g(T)})}t(x),j(()=>i(n,`Active Alerts (${a(D).length??""})`)),o(_,x)};f(Ht,_=>{a(D).length>0&&_(de)})}var vt=s(Ht,2),dt=e(vt),ot=e(dt),oe=e(ot);t(ot);var le=s(ot,2);le.__click=J,t(dt);var ne=s(dt,2);{var ce=_=>{var x=Te();o(_,x)},_e=_=>{var x=qe();ut(x,5,()=>a(H),xt,(h,n)=>{var w=Le(),R=e(w),T=e(R),g=e(T),d=s(g,2);d.__click=()=>N(`/agents/${a(n).agent_id}`);var p=e(d,!0);t(d),t(T);var y=s(T,2),B=e(y,!0);t(y),t(R);var k=s(R,2),I=e(k),Q=e(I);t(I);var W=s(I,2),O=e(W);t(W),t(k);var lt=s(k,2);{var F=$=>{var A=Oe();ut(A,5,()=>a(n).active_calls,xt,(nt,m)=>{var M=Ie(),ct=e(M),_t=e(ct),xe=e(_t,!0);t(_t);var Pt=s(_t,2),be=e(Pt,!0);t(Pt),t(ct);var ge=s(ct,2);{var me=L=>{var fe=Be();o(L,fe)};f(ge,L=>{a(m).is_on_hold&&L(me)})}t(M),j(L=>{i(xe,a(m).direction),i(be,L)},[()=>ft(a(m).duration_seconds)]),o(nt,M)}),t(A),o($,A)};f(lt,$=>{a(n).active_calls_count>0&&$(F)})}t(w),j(($,A)=>{bt(g,1,`w-3 h-3 rounded-full ${mt[a(n).current_status]??""}`),$e(g,"title",a(n).current_status),i(p,a(n).display_name),bt(y,1,`text-xs px-2 py-1 rounded-full capitalize ${mt[a(n).current_status]??""} text-white`),i(B,$),i(Q,`Since: ${A??""}`),i(O,`Calls: ${a(n).active_calls_count??""}/${a(n).max_concurrent_calls??""}`)},[()=>a(n).current_status.replace("_"," "),()=>U(a(n).status_since)]),o(h,w)}),t(x),o(_,x)};f(ne,_=>{a(H).length===0?_(ce):_(_e,!1)})}t(vt);var Jt=s(vt,2),ue=e(Jt);E(),t(Jt),j((_,x,h)=>{i(Zt,a(c).active_calls),i(te,a(c).queue_waiting),i(ee,_),i(ae,`${x??""}%`),i(se,a(c).agents_available),i(re,a(c).agents_on_call),i(ie,a(c).agents_on_break),i(ve,a(c).agents_offline),i(oe,`Live Agent Status (${a(H).length??""})`),i(ue,`Last updated: ${h??""} `)},[()=>ft(a(c).average_wait_time),()=>a(c).abandon_rate.toFixed(1),()=>U(a(c).timestamp)]),o(u,C)};f(b,u=>{a(c)&&u(S)},!0)}o(r,v)};f(Ut,r=>{a(V)&&!a(c)?r(Xt):r(Yt,!1)})}t(X),o(Wt,X),ke()}Ae(["click"]);export{Ze as component};

import{f as F,a as v,c as Lt}from"../chunks/pFl1CK35.js";import"../chunks/CnJ-dsFT.js";import{o as he}from"../chunks/0VtO9hYy.js";import{p as be,K as ye,L as we,t as D,d as a,e as s,g as t,c as Fe,J as _,f as p,M as L,r as e,N as ke,n as Pt,q as l,h as Rt,O as Se}from"../chunks/aQ_ifger.js";import{s as n}from"../chunks/DBuqHHqM.js";import{i as nt}from"../chunks/BTxJJ6eU.js";import{e as Ee,i as Te}from"../chunks/oqRKM5NY.js";import{b as Ce,r as Ie,a as Vt}from"../chunks/BqAhscvM.js";import{s as At,c as je}from"../chunks/DGR2HyJN.js";import{d as De}from"../chunks/C918u5xm.js";import{b as Le}from"../chunks/CDxeFDgn.js";import{i as Pe}from"../chunks/ft9JqUN4.js";import{P as w}from"../chunks/W1CsE6Bq.js";import{P as Nt}from"../chunks/BumCI67k.js";import{S as Re}from"../chunks/BztEPeEE.js";import{P as Ve}from"../chunks/DxRKn0x_.js";import{S as Ae}from"../chunks/DdJ5BR_D.js";import{T as Ne}from"../chunks/F1e28-8V.js";var $e=F('<div class="p-8 text-center"><div class="inline-block animate-spin rounded-full h-8 w-8 border-4 border-gray-300 border-t-blue-600"></div> <p class="mt-2 text-gray-600">Loading IVR flows...</p></div>'),Oe=F('<div class="p-8 text-center"><p class="text-red-600"> </p> <button class="mt-4 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700">Retry</button></div>'),Ue=F('<div class="p-8 text-center"><!> <p class="text-gray-600">No IVR flows found</p> <a href="/operations/ivr/builder" class="mt-4 inline-block px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700">Create Your First Flow</a></div>'),qe=F('<tr class="hover:bg-gray-50"><td class="px-6 py-4 whitespace-nowrap"><div class="flex items-center"><!> <div><div class="text-sm font-medium text-gray-900"> </div> <div class="text-sm text-gray-500"> </div></div></div></td><td class="px-6 py-4"><div class="text-sm text-gray-900 max-w-xs truncate"> </div></td><td class="px-6 py-4 whitespace-nowrap"><span> </span></td><td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900"> </td><td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900"> </td><td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500"> </td><td class="px-6 py-4 whitespace-nowrap text-sm font-medium"><div class="flex items-center gap-2"><button class="text-blue-600 hover:text-blue-900" title="Test Flow"><!></button> <a class="text-indigo-600 hover:text-indigo-900" title="Edit Flow"><!></a> <button><!></button> <button class="text-red-600 hover:text-red-900" title="Delete Flow"><!></button></div></td></tr>'),Je=F('<table class="w-full"><thead class="bg-gray-50 border-b border-gray-200"><tr><th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Flow Name</th><th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Description</th><th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Status</th><th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Version</th><th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Timeout</th><th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Updated</th><th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Actions</th></tr></thead><tbody class="bg-white divide-y divide-gray-200"></tbody></table>'),Me=F('<div class="p-6 max-w-7xl mx-auto"><div class="mb-6"><h1 class="text-3xl font-bold text-gray-900 mb-2">IVR Flow Management</h1> <p class="text-gray-600">Configure and manage Interactive Voice Response (IVR) flows for call routing</p></div> <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-6"><div class="bg-white rounded-lg border border-gray-200 p-4"><div class="flex items-center justify-between"><div><p class="text-sm text-gray-600">Total Flows</p> <p class="text-2xl font-bold text-gray-900"> </p></div> <!></div></div> <div class="bg-white rounded-lg border border-gray-200 p-4"><div class="flex items-center justify-between"><div><p class="text-sm text-gray-600">Active Flows</p> <p class="text-2xl font-bold text-green-600"> </p></div> <!></div></div> <div class="bg-white rounded-lg border border-gray-200 p-4"><div class="flex items-center justify-between"><div><p class="text-sm text-gray-600">Inactive Flows</p> <p class="text-2xl font-bold text-gray-600"> </p></div> <!></div></div> <div class="bg-white rounded-lg border border-gray-200 p-4"><div class="flex items-center justify-between"><div><p class="text-sm text-gray-600">Total Nodes</p> <p class="text-2xl font-bold text-blue-600"> </p></div> <!></div></div></div> <div class="bg-white rounded-lg border border-gray-200 p-4 mb-4"><div class="flex flex-col md:flex-row md:items-center md:justify-between gap-4"><div class="flex flex-col md:flex-row gap-4 flex-1"><div class="relative flex-1"><!> <input type="text" placeholder="Search flows..." class="w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"/></div> <select class="px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"><option>All Status</option><option>Active</option><option>Inactive</option></select></div> <a href="/operations/ivr/builder" class="inline-flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors"><!> Create Flow</a></div></div> <div class="bg-white rounded-lg border border-gray-200 overflow-hidden"><!></div></div>');function da($t,Ot){be(Ot,!1);const S=_();let c=_([]),P=_(!0),E=_(null),g=_(""),u=_("all"),d=_({total_flows:0,active_flows:0,inactive_flows:0,total_nodes:0});he(async()=>{await T()});async function T(){p(P,!0),p(E,null);try{const r=await fetch("http://localhost:8000/api/ivr/flows");if(!r.ok)throw new Error("Failed to load IVR flows");p(c,await r.json()),Ut()}catch(r){p(E,r instanceof Error?r.message:"Unknown error occurred")}finally{p(P,!1)}}function Ut(){L(d,t(d).total_flows=t(c).length),L(d,t(d).active_flows=t(c).filter(r=>r.is_active).length),L(d,t(d).inactive_flows=t(c).filter(r=>!r.is_active).length),L(d,t(d).total_nodes=t(c).reduce((r,i)=>r+(i.nodes_count||0),0))}async function qt(r){try{const i=t(c).find(G=>G.id===r);if(!i)return;if(!(await fetch(`http://localhost:8000/api/ivr/flows/${r}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:i.name,description:i.description,is_active:!i.is_active,timeout_seconds:i.timeout_seconds,max_retries:i.max_retries})})).ok)throw new Error("Failed to update flow status");await T()}catch(i){alert(i instanceof Error?i.message:"Failed to update flow status")}}async function Jt(r){if(confirm("Are you sure you want to delete this IVR flow?"))try{if(!(await fetch(`http://localhost:8000/api/ivr/flows/${r}`,{method:"DELETE"})).ok)throw new Error("Failed to delete flow");await T()}catch(i){alert(i instanceof Error?i.message:"Failed to delete flow")}}async function Mt(r){try{const i=await fetch(`http://localhost:8000/api/ivr/flows/${r}/test`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({test_phone:"+1234567890",test_language:"en"})});if(!i.ok)throw new Error("Failed to test flow");const m=await i.json();alert(`Flow test completed: ${m.status}`)}catch(i){alert(i instanceof Error?i.message:"Failed to test flow")}}function Bt(r){return new Date(r).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"2-digit",minute:"2-digit"})}function Kt(r){return r?"text-green-600":"text-gray-400"}function Qt(r){return r?"bg-green-100 text-green-800 border-green-200":"bg-gray-100 text-gray-600 border-gray-200"}ye(()=>(t(c),t(g),t(u)),()=>{p(S,t(c).filter(r=>{const i=t(g)===""||r.name.toLowerCase().includes(t(g).toLowerCase())||r.description&&r.description.toLowerCase().includes(t(g).toLowerCase()),m=t(u)==="all"||t(u)==="active"&&r.is_active||t(u)==="inactive"&&!r.is_active;return i&&m}))}),we(),Pe();var R=Me(),V=s(a(R),2),A=a(V),ct=a(A),N=a(ct),vt=s(a(N),2),Yt=a(vt,!0);e(vt),e(N);var zt=s(N,2);w(zt,{class:"w-8 h-8 text-blue-500"}),e(ct),e(A);var $=s(A,2),pt=a($),O=a(pt),ut=s(a(O),2),Gt=a(ut,!0);e(ut),e(O);var Ht=s(O,2);Nt(Ht,{class:"w-8 h-8 text-green-500"}),e(pt),e($);var U=s($,2),xt=a(U),q=a(xt),_t=s(a(q),2),Wt=a(_t,!0);e(_t),e(q);var Xt=s(q,2);w(Xt,{class:"w-8 h-8 text-gray-400"}),e(xt),e(U);var gt=s(U,2),mt=a(gt),J=a(mt),ft=s(a(J),2),Zt=a(ft,!0);e(ft),e(J);var te=s(J,2);w(te,{class:"w-8 h-8 text-blue-400"}),e(mt),e(gt),e(V);var M=s(V,2),ht=a(M),B=a(ht),K=a(B),bt=a(K);Re(bt,{class:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"});var yt=s(bt,2);Ie(yt),e(K);var Q=s(K,2);D(()=>{t(u),ke(()=>{})});var Y=a(Q);Y.value=Y.__value="all";var z=s(Y);z.value=z.__value="active";var wt=s(z);wt.value=wt.__value="inactive",e(Q),e(B);var Ft=s(B,2),ee=a(Ft);Ve(ee,{class:"w-4 h-4"}),Pt(),e(Ft),e(ht),e(M);var kt=s(M,2),ae=a(kt);{var re=r=>{var i=$e();v(r,i)},se=r=>{var i=Lt(),m=Rt(i);{var G=f=>{var h=Oe(),k=a(h),H=a(k,!0);e(k);var W=s(k,2);W.__click=T,e(h),D(()=>n(H,t(E))),v(f,h)},ie=f=>{var h=Lt(),k=Rt(h);{var H=b=>{var x=Ue(),C=a(x);w(C,{class:"w-12 h-12 text-gray-300 mx-auto mb-2"}),Pt(4),e(x),v(b,x)},W=b=>{var x=Je(),C=s(a(x));Ee(C,5,()=>t(S),Te,(oe,o)=>{var X=qe(),Z=a(X),St=a(Z),Et=a(St);{let dt=Se(()=>(t(o),l(()=>Kt(t(o).is_active))));w(Et,{get class(){return`w-5 h-5 ${t(dt)??""} mr-2`}})}var Tt=s(Et,2),tt=a(Tt),le=a(tt,!0);e(tt);var Ct=s(tt,2),de=a(Ct);e(Ct),e(Tt),e(St),e(Z);var et=s(Z),It=a(et),ne=a(It,!0);e(It),e(et);var at=s(et),rt=a(at),ce=a(rt,!0);e(rt),e(at);var st=s(at),ve=a(st);e(st);var it=s(st),pe=a(it);e(it);var ot=s(it),ue=a(ot,!0);e(ot);var jt=s(ot),Dt=a(jt),I=a(Dt);I.__click=()=>Mt(t(o).id);var xe=a(I);Nt(xe,{class:"w-4 h-4"}),e(I);var j=s(I,2),_e=a(j);Ae(_e,{class:"w-4 h-4"}),e(j);var y=s(j,2);y.__click=()=>qt(t(o).id);var ge=a(y);w(ge,{class:"w-4 h-4"}),e(y);var lt=s(y,2);lt.__click=()=>Jt(t(o).id);var me=a(lt);Ne(me,{class:"w-4 h-4"}),e(lt),e(Dt),e(jt),e(X),D((dt,fe)=>{n(le,(t(o),l(()=>t(o).name))),n(de,`ID: ${t(o),l(()=>t(o).id)??""}`),n(ne,(t(o),l(()=>t(o).description||"No description"))),At(rt,1,`px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full border ${dt??""}`),n(ce,(t(o),l(()=>t(o).is_active?"Active":"Inactive"))),n(ve,`v${t(o),l(()=>t(o).version)??""}`),n(pe,`${t(o),l(()=>t(o).timeout_seconds)??""}s`),n(ue,fe),Vt(j,"href",`/operations/ivr/builder?id=${t(o),l(()=>t(o).id)??""}`),At(y,1,je((t(o),l(()=>t(o).is_active?"text-gray-600 hover:text-gray-900":"text-green-600 hover:text-green-900")))),Vt(y,"title",(t(o),l(()=>t(o).is_active?"Deactivate":"Activate")))},[()=>(t(o),l(()=>Qt(t(o).is_active))),()=>(t(o),l(()=>Bt(t(o).updated_at)))]),v(oe,X)}),e(C),e(x),v(b,x)};nt(k,b=>{t(S),l(()=>t(S).length===0)?b(H):b(W,!1)},!0)}v(f,h)};nt(m,f=>{t(E)?f(G):f(ie,!1)},!0)}v(r,i)};nt(ae,r=>{t(P)?r(re):r(se,!1)})}e(kt),e(R),D(()=>{n(Yt,(t(d),l(()=>t(d).total_flows))),n(Gt,(t(d),l(()=>t(d).active_flows))),n(Wt,(t(d),l(()=>t(d).inactive_flows))),n(Zt,(t(d),l(()=>t(d).total_nodes)))}),Le(yt,()=>t(g),r=>p(g,r)),Ce(Q,()=>t(u),r=>p(u,r)),v($t,R),Fe()}De(["click"]);export{da as component};

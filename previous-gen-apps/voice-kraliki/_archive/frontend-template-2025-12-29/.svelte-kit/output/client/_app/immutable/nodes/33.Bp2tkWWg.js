import{f as l,a as v,c as jt}from"../chunks/pFl1CK35.js";import"../chunks/CnJ-dsFT.js";import{o as Ct,a as St}from"../chunks/0VtO9hYy.js";import{p as $t,e as i,t as f,c as At,d as a,f as y,J,r as e,g as t,h as R,n as Dt}from"../chunks/aQ_ifger.js";import{s as c}from"../chunks/DBuqHHqM.js";import{i as _}from"../chunks/BTxJJ6eU.js";import{e as It,i as Mt}from"../chunks/oqRKM5NY.js";import{d as zt}from"../chunks/C918u5xm.js";import{s as V}from"../chunks/DGR2HyJN.js";import{i as Bt}from"../chunks/ft9JqUN4.js";import{g as W}from"../chunks/CTjsJUPt.js";var Ot=l('<div class="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-4"> </div>'),Et=l('<div class="text-center py-12"><div class="inline-block animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"></div> <p class="mt-4 text-gray-600">Loading active calls...</p></div>'),Jt=l('<div class="text-center py-12 bg-gray-50 rounded-lg"><p class="text-gray-600">No active calls</p></div>'),Nt=l('<div class="flex justify-between"><span class="text-gray-600">Sentiment:</span> <span> </span></div>'),Tt=l('<div class="flex justify-between"><span class="text-gray-600">Intent:</span> <span class="font-medium"> </span></div>'),Ht=l('<div class="flex items-center gap-2 text-orange-600"><span>üîá</span> <span> </span></div>'),Lt=l('<div class="flex items-center gap-2 text-blue-600"><span>üëÅÔ∏è</span> <span>Being Monitored</span></div>'),Pt=l('<button class="flex-1 px-3 py-2 text-sm bg-blue-600 text-white rounded hover:bg-blue-700">Monitor</button>'),Qt=l('<div class="bg-white rounded-lg shadow p-4 hover:shadow-lg transition-shadow"><div class="flex items-start justify-between mb-3"><div class="flex-1"><div class="font-medium"> </div> <div class="text-sm text-gray-600"> </div></div> <span> </span></div> <div class="space-y-2 text-sm"><div class="flex justify-between"><span class="text-gray-600">Duration:</span> <span class="font-medium"> </span></div> <div class="flex justify-between"><span class="text-gray-600">Direction:</span> <span class="font-medium capitalize"> </span></div> <!> <!> <!> <!></div> <div class="mt-4 flex gap-2"><!> <button class="flex-1 px-3 py-2 text-sm border border-gray-300 rounded hover:bg-gray-50">Details</button></div></div>'),Ut=l('<div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"></div> <div class="mt-6 text-center text-sm text-gray-500"><span>üîÑ Auto-refreshing every 3 seconds</span></div>',1),qt=l('<div class="container mx-auto p-6"><div class="mb-6 flex items-center justify-between"><div><h1 class="text-3xl font-bold">Active Calls</h1> <p class="text-gray-600 mt-1">Monitor and intervene in real-time calls</p></div> <button class="px-4 py-2 border border-gray-300 rounded text-gray-700 hover:bg-gray-50">‚Üê Back to Dashboard</button></div> <!> <div class="mb-6 bg-white p-4 rounded-lg shadow"><div class="text-lg font-semibold"> </div></div> <!></div>');function ae(X,Y){$t(Y,!1);let g=J([]),h=J(!0),w=J(""),k;const Z={ringing:"bg-blue-100 text-blue-800",connected:"bg-green-100 text-green-800",on_hold:"bg-yellow-100 text-yellow-800",transferring:"bg-purple-100 text-purple-800",completed:"bg-gray-100 text-gray-800",failed:"bg-red-100 text-red-800"},tt={positive:"text-green-600",neutral:"text-gray-600",negative:"text-red-600"};Ct(async()=>{await j(),k=setInterval(j,3e3)}),St(()=>{k&&clearInterval(k)});async function j(){try{const s=localStorage.getItem("token"),o=await fetch("/api/supervisor/calls",{headers:{Authorization:`Bearer ${s}`}});o.ok&&y(g,await o.json()),y(h,!1)}catch(s){y(w,`Error loading calls: ${s}`),y(h,!1)}}async function et(s){try{const o=localStorage.getItem("token");(await fetch("/api/supervisor/interventions",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${o}`},body:JSON.stringify({call_id:s,intervention_type:"monitor",reason:"Quality monitoring"})})).ok&&await j()}catch(o){console.error("Error starting monitoring:",o)}}function at(s){if(s===null)return"-";const o=Math.floor(s/60),m=s%60;return`${o}:${m.toString().padStart(2,"0")}`}Bt();var C=qt(),S=a(C),rt=i(a(S),2);rt.__click=()=>W("/supervisor/dashboard"),e(S);var N=i(S,2);{var st=s=>{var o=Ot(),m=a(o,!0);e(o),f(()=>c(m,t(w))),v(s,o)};_(N,s=>{t(w)&&s(st)})}var $=i(N,2),T=a($),it=a(T);e(T),e($);var nt=i($,2);{var ot=s=>{var o=Et();v(s,o)},dt=s=>{var o=jt(),m=R(o);{var vt=u=>{var b=Jt();v(u,b)},lt=u=>{var b=Ut(),H=R(b);It(H,5,()=>t(g),Mt,(ct,d)=>{var A=Qt(),D=a(A),I=a(D),M=a(I),pt=a(M,!0);e(M);var L=i(M,2),_t=a(L,!0);e(L),e(I);var z=i(I,2),gt=a(z,!0);e(z),e(D);var B=i(D,2),O=a(B),P=i(a(O),2),mt=a(P,!0);e(P),e(O);var E=i(O,2),Q=i(a(E),2),ut=a(Q,!0);e(Q),e(E);var U=i(E,2);{var ft=r=>{var n=Nt(),p=i(a(n),2),x=a(p,!0);e(p),e(n),f(()=>{V(p,1,`font-medium capitalize ${tt[t(d).current_sentiment]??""}`),c(x,t(d).current_sentiment)}),v(r,n)};_(U,r=>{t(d).current_sentiment&&r(ft)})}var q=i(U,2);{var xt=r=>{var n=Tt(),p=i(a(n),2),x=a(p,!0);e(p),e(n),f(()=>c(x,t(d).detected_intent)),v(r,n)};_(q,r=>{t(d).detected_intent&&r(xt)})}var F=i(q,2);{var bt=r=>{var n=Ht(),p=i(a(n),2),x=a(p);e(p),e(n),f(()=>c(x,`On Hold (${t(d).hold_count??""}x)`)),v(r,n)};_(F,r=>{t(d).is_on_hold&&r(bt)})}var yt=i(F,2);{var ht=r=>{var n=Lt();v(r,n)};_(yt,r=>{t(d).is_being_monitored&&r(ht)})}e(B);var G=i(B,2),K=a(G);{var wt=r=>{var n=Pt();n.__click=()=>et(t(d).id),v(r,n)};_(K,r=>{t(d).is_being_monitored||r(wt)})}var kt=i(K,2);kt.__click=()=>W(`/supervisor/calls/${t(d).id}`),e(G),e(A),f((r,n)=>{c(pt,t(d).caller_name||"Unknown"),c(_t,t(d).caller_phone),V(z,1,`px-2 py-1 text-xs font-semibold rounded-full capitalize ${Z[t(d).status]??""}`),c(gt,r),c(mt,n),c(ut,t(d).direction)},[()=>t(d).status.replace("_"," "),()=>at(t(d).duration_seconds)]),v(ct,A)}),e(H),Dt(2),v(u,b)};_(m,u=>{t(g).length===0?u(vt):u(lt,!1)},!0)}v(s,o)};_(nt,s=>{t(h)&&t(g).length===0?s(ot):s(dt,!1)})}e(C),f(()=>c(it,`${t(g).length??""} Active ${t(g).length===1?"Call":"Calls"}`)),v(X,C),At()}zt(["click"]);export{ae as component};

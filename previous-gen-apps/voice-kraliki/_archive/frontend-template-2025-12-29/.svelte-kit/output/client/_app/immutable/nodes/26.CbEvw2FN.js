import{f as v,a as l,c as gt}from"../chunks/pFl1CK35.js";import"../chunks/CnJ-dsFT.js";import{o as Bt}from"../chunks/0VtO9hYy.js";import{p as It,t as T,e as o,d as a,g as s,c as Lt,J as b,f as _,N as Mt,r as e,h as et}from"../chunks/aQ_ifger.js";import{s as d}from"../chunks/DBuqHHqM.js";import{i as y}from"../chunks/BTxJJ6eU.js";import{e as Pt,i as Jt}from"../chunks/oqRKM5NY.js";import{b as Ot,r as Qt}from"../chunks/BqAhscvM.js";import{s as qt}from"../chunks/DGR2HyJN.js";import{d as Gt}from"../chunks/C918u5xm.js";import{b as Ht}from"../chunks/CDxeFDgn.js";import{i as Kt}from"../chunks/ft9JqUN4.js";var Vt=v('<div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-8"><div class="bg-white rounded-lg shadow p-6"><div class="text-sm text-gray-500 mb-1">Total Recordings</div> <div class="text-3xl font-bold text-gray-900"> </div></div> <div class="bg-white rounded-lg shadow p-6"><div class="text-sm text-gray-500 mb-1">Completed</div> <div class="text-3xl font-bold text-green-600"> </div></div> <div class="bg-white rounded-lg shadow p-6"><div class="text-sm text-gray-500 mb-1">Avg Duration</div> <div class="text-3xl font-bold text-blue-600"> </div></div> <div class="bg-white rounded-lg shadow p-6"><div class="text-sm text-gray-500 mb-1">Storage Used</div> <div class="text-3xl font-bold text-purple-600"> </div></div></div>'),Wt=v('<div class="p-8 text-center text-gray-500"><div class="animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"></div> Loading recordings...</div>'),Xt=v('<div class="p-8 text-center text-red-600"><p class="text-lg font-semibold mb-2">Error</p> <p> </p></div>'),Yt=v('<div class="p-8 text-center text-gray-500"><p class="text-lg mb-2">No recordings found</p> <p class="text-sm">Recordings will appear here once calls are recorded</p></div>'),Zt=v('<button class="text-green-600 hover:text-green-900">Transcript</button>'),te=v('<button class="text-blue-600 hover:text-blue-900">Download</button> <!>',1),ee=v('<tr class="hover:bg-gray-50"><td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900"> </td><td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500"> </td><td class="px-6 py-4 whitespace-nowrap"><span> </span></td><td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500"> </td><td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500"> </td><td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500"> </td><td class="px-6 py-4 whitespace-nowrap text-sm font-medium space-x-2"><!></td></tr>'),ae=v('<div class="overflow-x-auto"><table class="min-w-full divide-y divide-gray-200"><thead class="bg-gray-50"><tr><th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Call SID</th><th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Caller</th><th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Status</th><th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Duration</th><th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Size</th><th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Date</th><th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Actions</th></tr></thead><tbody class="bg-white divide-y divide-gray-200"></tbody></table></div>'),re=v('<div class="container mx-auto px-4 py-8"><div class="mb-8"><h1 class="text-3xl font-bold text-gray-900 mb-2">Call Recordings</h1> <p class="text-gray-600">Manage and review call recordings</p></div> <!> <div class="bg-white rounded-lg shadow mb-6 p-6"><div class="grid grid-cols-1 md:grid-cols-3 gap-4"><div><label class="block text-sm font-medium text-gray-700 mb-2">Status</label> <select class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"><option>All Statuses</option><option>Pending</option><option>Recording</option><option>Processing</option><option>Completed</option><option>Failed</option></select></div> <div><label class="block text-sm font-medium text-gray-700 mb-2">Search</label> <input type="text" placeholder="Search by call SID or phone..." class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"/></div> <div class="flex items-end"><button class="px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors">Refresh</button></div></div></div> <div class="bg-white rounded-lg shadow overflow-hidden"><!></div></div>');function me(ut,xt){It(xt,!1);let j=b([]),f=b(null),E=b(!0),z=b(""),w=b(""),mt=null,at=b("");const _t={pending:"bg-gray-100 text-gray-800",recording:"bg-blue-100 text-blue-800",processing:"bg-yellow-100 text-yellow-800",completed:"bg-green-100 text-green-800",failed:"bg-red-100 text-red-800",deleted:"bg-gray-100 text-gray-600"};Bt(async()=>{await N(),await ft()});async function N(){try{const t=localStorage.getItem("token"),r=new URLSearchParams;s(w)&&r.append("status",s(w));const i=await fetch(`http://localhost:8000/api/recordings?${r}`,{headers:{Authorization:`Bearer ${t}`,"Content-Type":"application/json"}});if(!i.ok)throw new Error("Failed to load recordings");_(j,await i.json()),_(E,!1)}catch(t){_(z,t instanceof Error?t.message:"Failed to load recordings"),_(E,!1)}}async function ft(){try{const t=localStorage.getItem("token"),r=await fetch("http://localhost:8000/api/recordings/stats",{headers:{Authorization:`Bearer ${t}`,"Content-Type":"application/json"}});if(!r.ok)throw new Error("Failed to load stats");_(f,await r.json())}catch(t){console.error("Failed to load stats:",t)}}async function ht(t){try{const r=localStorage.getItem("token"),i=await fetch(`http://localhost:8000/api/recordings/${t}/download-url`,{method:"POST",headers:{Authorization:`Bearer ${r}`,"Content-Type":"application/json"},body:JSON.stringify({recording_id:t,expires_in_seconds:3600})});if(!i.ok)throw new Error("Failed to generate download URL");const g=await i.json();window.open(g.download_url,"_blank")}catch(r){alert(r instanceof Error?r.message:"Failed to generate download URL")}}async function bt(t){try{const r=localStorage.getItem("token"),i=await fetch(`http://localhost:8000/api/recordings/${t}/transcript`,{headers:{Authorization:`Bearer ${r}`,"Content-Type":"application/json"}});if(!i.ok)throw new Error("No transcript available");const g=await i.json();alert(`Transcript:

${g.text||"No text available"}`)}catch(r){alert(r instanceof Error?r.message:"Failed to load transcript")}}function rt(t){if(!t)return"N/A";const r=Math.floor(t/60),i=t%60;return`${r}:${i.toString().padStart(2,"0")}`}function ot(t){return t?`${(t/(1024*1024)).toFixed(2)} MB`:"N/A"}function yt(t){return new Date(t).toLocaleString()}Kt();var U=re(),st=o(a(U),2);{var wt=t=>{var r=Vt(),i=a(r),g=o(a(i),2),Q=a(g,!0);e(g),e(i);var c=o(i,2),p=o(a(c),2),h=a(p,!0);e(p),e(c);var m=o(c,2),C=o(a(m),2),u=a(C,!0);e(C),e(m);var x=o(m,2),k=o(a(x),2),D=a(k,!0);e(k),e(x),e(r),T((q,n)=>{d(Q,s(f).total_recordings),d(h,s(f).completed_recordings),d(u,q),d(D,n)},[()=>rt(Math.round(s(f).average_duration_seconds)),()=>ot(s(f).total_storage_bytes)]),l(t,r)};y(st,t=>{s(f)&&t(wt)})}var $=o(st,2),it=a($),B=a(it),A=o(a(B),2);T(()=>{s(w),Mt(()=>{})}),A.__change=N;var I=a(A);I.value=I.__value="";var L=o(I);L.value=L.__value="pending";var M=o(L);M.value=M.__value="recording";var P=o(M);P.value=P.__value="processing";var J=o(P);J.value=J.__value="completed";var nt=o(J);nt.value=nt.__value="failed",e(A),e(B);var O=o(B,2),lt=o(a(O),2);Qt(lt),e(O);var dt=o(O,2),kt=a(dt);kt.__click=N,e(dt),e(it),e($);var ct=o($,2),St=a(ct);{var At=t=>{var r=Wt();l(t,r)},Ct=t=>{var r=gt(),i=et(r);{var g=c=>{var p=Xt(),h=o(a(p),2),m=a(h,!0);e(h),e(p),T(()=>d(m,s(z))),l(c,p)},Q=c=>{var p=gt(),h=et(p);{var m=u=>{var x=Yt();l(u,x)},C=u=>{var x=ae(),k=a(x),D=o(a(k));Pt(D,5,()=>s(j),Jt,(q,n)=>{var G=ee(),H=a(G),Dt=a(H,!0);e(H);var K=o(H),Ft=a(K,!0);e(K);var V=o(K),W=a(V),Rt=a(W,!0);e(W),e(V);var X=o(V),Tt=a(X,!0);e(X);var Y=o(X),jt=a(Y,!0);e(Y);var Z=o(Y),Et=a(Z,!0);e(Z);var pt=o(Z),zt=a(pt);{var Nt=S=>{var F=te(),R=et(F);R.__click=()=>ht(s(n).id);var Ut=o(R,2);{var $t=tt=>{var vt=Zt();vt.__click=()=>bt(s(n).id),l(tt,vt)};y(Ut,tt=>{s(n).has_transcription&&tt($t)})}l(S,F)};y(zt,S=>{s(n).status==="completed"&&S(Nt)})}e(pt),e(G),T((S,F,R)=>{d(Dt,s(n).call_sid),d(Ft,s(n).caller_phone||"Unknown"),qt(W,1,`px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full ${(_t[s(n).status]||"bg-gray-100 text-gray-800")??""}`),d(Rt,s(n).status),d(Tt,S),d(jt,F),d(Et,R)},[()=>rt(s(n).duration_seconds),()=>ot(s(n).file_size_bytes),()=>yt(s(n).started_at)]),l(q,G)}),e(D),e(k),e(x),l(u,x)};y(h,u=>{s(j).length===0?u(m):u(C,!1)},!0)}l(c,p)};y(i,c=>{s(z)?c(g):c(Q,!1)},!0)}l(t,r)};y(St,t=>{s(E)?t(At):t(Ct,!1)})}e(ct),e(U),Ot(A,()=>s(w),t=>_(w,t)),Ht(lt,()=>s(at),t=>_(at,t)),l(ut,U),Lt()}Gt(["change","click"]);export{me as component};

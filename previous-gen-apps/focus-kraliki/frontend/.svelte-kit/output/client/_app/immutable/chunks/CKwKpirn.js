import{w as n}from"./CABBFY_M.js";import{a as c}from"./CBf0kXIe.js";const u={workspaces:[],activeWorkspaceId:null,members:[],isLoading:!1,membersLoading:!1,error:null};function d(){const{subscribe:m,update:a,set:l}=n(u);return{subscribe:m,async loadWorkspaces(){a(r=>({...r,isLoading:!0,error:null}));try{const r=await c.workspaces.list(),e=r.activeWorkspaceId||null;return l({workspaces:r.workspaces||[],activeWorkspaceId:e,members:[],isLoading:!1,membersLoading:!1,error:null}),{success:!0,activeWorkspaceId:e}}catch(r){return a(e=>({...e,isLoading:!1,error:r.detail||"Failed to load workspaces"})),{success:!1,error:r.detail}}},async loadMembers(r){if(!r)return{success:!1,error:"No workspace selected"};a(e=>({...e,membersLoading:!0}));try{const e=await c.workspaces.members(r);return a(s=>({...s,members:e,membersLoading:!1})),{success:!0,members:e}}catch(e){return a(s=>({...s,membersLoading:!1,error:e.detail||"Failed to load members"})),{success:!1,error:e.detail}}},async switchWorkspace(r){try{await c.workspaces.switch(r);const e=await c.workspaces.members(r);return a(s=>({...s,activeWorkspaceId:r,members:e})),{success:!0}}catch(e){return a(s=>({...s,error:e.detail||"Failed to switch workspace"})),{success:!1,error:e.detail}}},async inviteMember(r,e,s){try{const t=await c.workspaces.inviteMember(r,{email:e,role:s});return a(o=>({...o,members:[...o.members,t]})),{success:!0,member:t}}catch(t){return{success:!1,error:t.detail||"Failed to invite member"}}},async updateMemberRole(r,e,s){try{const t=await c.workspaces.updateMember(r,e,{role:s});return a(o=>({...o,members:o.members.map(i=>i.id===e?t:i)})),{success:!0}}catch(t){return{success:!1,error:t.detail||"Failed to update role"}}},async removeMember(r,e){try{return await c.workspaces.removeMember(r,e),a(s=>({...s,members:s.members.filter(t=>t.id!==e)})),{success:!0}}catch(s){return{success:!1,error:s.detail||"Failed to remove member"}}}}}const w=d();export{w};

import{d as te,f as m,a as _,s as i,c as ee,e as ae}from"../chunks/C3NdowuV.js";import{o as re}from"../chunks/BEA_S9YB.js";import{p as se,b as V,e as Ct,u as oe,i as $t,g as k,s,t as x,a as ie,h as a,d as le,c as e,$ as ve,r as t,k as Ut}from"../chunks/BIIBwolN.js";import{e as At,i as Lt}from"../chunks/C5feot9S.js";import{i as C}from"../chunks/BMZK_lNp.js";import{h as ne}from"../chunks/DCFnHnzv.js";import{r as St}from"../chunks/kJGk4-vF.js";import{s as Dt}from"../chunks/3ECVvnw7.js";import{b as ft,a as ce}from"../chunks/V2_FqNi0.js";import{b as pe}from"../chunks/HfYSDCGL.js";import{s as de,a as gt}from"../chunks/BfLFXwF2.js";import{g as ue}from"../chunks/BKtAgaYV.js";import{a as _e,i as be}from"../chunks/9ICADEXz.js";import{b as yt}from"../chunks/BXAMcmxS.js";import{t as me}from"../chunks/Czbc-fPz.js";var xe=m("<button> </button>"),fe=m('<div class="text-center py-12"><span class="animate-pulse"> </span></div>'),ge=m('<div class="brutal-card p-12 text-center"><p class="text-muted-foreground mb-4"> </p> <button class="brutal-btn brutal-btn-primary"> </button></div>'),ye=m('<span class="text-xs text-terminal-green"> </span>'),he=m('<p class="text-muted-foreground text-sm mb-2"> </p>'),we=m('<div class="mt-3 p-3 bg-void border-2 border-terminal-green/30"><span class="text-xs text-terminal-green block mb-1"> </span> <p class="text-sm"> </p></div>'),ke=m("<span> </span>"),Ce=m('<button class="brutal-btn text-sm"> </button>'),$e=m('<button class="brutal-btn text-sm"> </button>'),Ue=m('<div class="flex gap-2 mt-4 pt-4 border-t border-foreground/20"><!> <!> <button class="brutal-btn brutal-btn-primary text-sm"> </button></div>'),Ae=m('<div class="brutal-card p-6"><div class="flex items-start justify-between"><div class="flex-1"><div class="flex items-center gap-3 mb-2"><span> </span> <span class="text-xs text-muted-foreground"> </span> <!></div> <h3 class="text-lg font-bold mb-2"> </h3> <!> <!> <div class="flex gap-4 mt-3 text-xs text-muted-foreground"><span> </span> <!></div></div></div> <!></div>'),Le=m('<div class="grid gap-4"></div>'),Se=m('<div class="fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4"><div class="brutal-card max-w-lg w-full max-h-[90vh] overflow-y-auto p-6"><div class="flex items-center justify-between mb-6"><h2 class="text-xl"> </h2> <button class="text-2xl hover:text-terminal-green">X</button></div> <form><div class="space-y-4"><div><label for="action-topic" class="block text-sm mb-1"> </label> <input id="action-topic" type="text" class="brutal-input w-full" required/></div> <div><label for="action-description" class="block text-sm mb-1"> </label> <textarea id="action-description" class="brutal-input w-full" rows="2"></textarea></div> <div><label for="action-priority" class="block text-sm mb-1"> </label> <select id="action-priority" class="brutal-input w-full"><option> </option><option> </option><option> </option></select></div> <div><label for="action-public-message" class="block text-sm mb-1"> </label> <textarea id="action-public-message" class="brutal-input w-full" rows="2" placeholder="Message visible to employees..."></textarea></div> <div class="flex items-center gap-2"><input type="checkbox" id="visible"/> <label for="visible" class="text-sm"> </label></div></div> <div class="flex gap-3 mt-6 pt-6 border-t-2 border-foreground/20"><button type="button" class="brutal-btn flex-1"> </button> <button type="submit" class="brutal-btn brutal-btn-primary flex-1"> </button></div></form></div></div>'),De=m('<div class="container mx-auto p-6"><div class="flex items-center justify-between mb-8"><div><a href="/dashboard" class="text-sm text-muted-foreground hover:text-foreground mb-2 inline-block"> </a> <h1 class="text-3xl"> </h1> <p class="text-muted-foreground text-sm mt-1"> </p></div> <button class="brutal-btn brutal-btn-primary"> </button></div> <div class="flex gap-2 mb-6 flex-wrap"></div> <!></div> <!>',1);function Je(Mt,Tt){se(Tt,!0);const jt=()=>gt(be,"$isAuthenticated",rt),at=()=>gt(_e,"$accessToken",rt),r=()=>gt(me,"$t",rt),[rt,Ft]=de();let st=V(Ct([])),ot=V(!0),W=V("all"),z=V(!1),f=V(Ct({topic:"",description:"",priority:"medium",public_message:"",visible_to_employees:!0}));re(async()=>{if(!jt()){ue("/login");return}await Y()});async function Y(){try{k(ot,!0);const o=a(W)==="all"?void 0:a(W);k(st,await yt.list(at(),o),!0)}catch(o){console.error("Failed to load actions",o)}finally{k(ot,!1)}}async function Pt(){try{await yt.create(a(f),at()),k(z,!1),k(f,{topic:"",description:"",priority:"medium",public_message:"",visible_to_employees:!0},!0),await Y()}catch(o){console.error("Failed to create action",o)}}async function it(o,n){try{await yt.update(o,{status:n},at()),await Y()}catch(d){console.error("Failed to update action",d)}}function ht(o){return{new:r()("status.new"),heard:r()("status.heard"),in_progress:r()("status.inProgress"),resolved:r()("status.resolved")}[o]||o}function zt(o){return{new:"border-cyan-data text-cyan-data",heard:"border-terminal-green text-terminal-green",in_progress:"border-yellow-400 text-yellow-400",resolved:"border-gray-500 text-gray-500"}[o]||""}function Et(o){return{low:r()("alerts.severity.low"),medium:r()("alerts.severity.medium"),high:r()("alerts.severity.high")}[o]||o}oe(()=>{Y()});var wt=De();ne("m5zg27",o=>{le(n=>{ve.title=`${n??""} - Speak by Kraliki`},[()=>r()("actions.title")])});var lt=$t(wt),vt=e(lt),nt=e(vt),ct=e(nt),qt=e(ct);t(ct);var pt=s(ct,2),Ht=e(pt,!0);t(pt);var kt=s(pt,2),It=e(kt);t(kt),t(nt);var dt=s(nt,2);dt.__click=()=>k(z,!0);var Kt=e(dt,!0);t(dt),t(vt);var ut=s(vt,2);At(ut,20,()=>["all","new","heard","in_progress","resolved"],Lt,(o,n)=>{var d=xe();d.__click=()=>k(W,n,!0);var y=e(d,!0);t(d),x($=>{Dt(d,1,`brutal-btn text-sm ${a(W)===n?"brutal-btn-primary":""}`),i(y,$)},[()=>n==="all"?r()("common.all").toUpperCase():ht(n).toUpperCase()]),_(o,d)}),t(ut);var Rt=s(ut,2);{var Xt=o=>{var n=fe(),d=e(n),y=e(d,!0);t(d),t(n),x($=>i(y,$),[()=>r()("common.loading").toUpperCase()]),_(o,n)},Bt=o=>{var n=ee(),d=$t(n);{var y=S=>{var U=ge(),A=e(U),l=e(A,!0);t(A);var h=s(A,2);h.__click=()=>k(z,!0);var L=e(h,!0);t(h),t(U),x((E,D)=>{i(l,E),i(L,D)},[()=>r()("actions.noActions"),()=>r()("actions.create").toUpperCase()]),_(S,U)},$=S=>{var U=Le();At(U,21,()=>a(st),Lt,(A,l)=>{var h=Ae(),L=e(h),E=e(L),D=e(E),M=e(D),q=e(M,!0);t(M);var H=s(M,2),Z=e(H);t(H);var I=s(H,2);{var K=v=>{var c=ye(),u=e(c,!0);t(c),x(g=>i(u,g),[()=>r()("actions.visibleToEmployees")]),_(v,c)};C(I,v=>{a(l).visible_to_employees&&v(K)})}t(D);var R=s(D,2),X=e(R,!0);t(R);var T=s(R,2);{var _t=v=>{var c=he(),u=e(c,!0);t(c),x(()=>i(u,a(l).description)),_(v,c)};C(T,v=>{a(l).description&&v(_t)})}var j=s(T,2);{var bt=v=>{var c=we(),u=e(c),g=e(u,!0);t(u);var b=s(u,2),N=e(b,!0);t(b),t(c),x(F=>{i(g,F),i(N,a(l).public_message)},[()=>r()("actions.publicMessage").toUpperCase()]),_(v,c)};C(j,v=>{a(l).public_message&&v(bt)})}var P=s(j,2),B=e(P),G=e(B,!0);t(B);var J=s(B,2);{var mt=v=>{var c=ke(),u=e(c);t(c),x((g,b)=>i(u,`${g??""}: ${b??""}`),[()=>r()("status.resolved"),()=>new Date(a(l).resolved_at).toLocaleDateString()]),_(v,c)};C(J,v=>{a(l).resolved_at&&v(mt)})}t(P),t(E),t(L);var tt=s(L,2);{var et=v=>{var c=Ue(),u=e(c);{var g=p=>{var w=Ce();w.__click=()=>it(a(l).id,"heard");var O=e(w,!0);t(w),x(Q=>i(O,Q),[()=>r()("actions.markHeard").toUpperCase()]),_(p,w)};C(u,p=>{a(l).status==="new"&&p(g)})}var b=s(u,2);{var N=p=>{var w=$e();w.__click=()=>it(a(l).id,"in_progress");var O=e(w,!0);t(w),x(Q=>i(O,Q),[()=>r()("actions.markInProgress").toUpperCase()]),_(p,w)};C(b,p=>{(a(l).status==="new"||a(l).status==="heard")&&p(N)})}var F=s(b,2);F.__click=()=>it(a(l).id,"resolved");var xt=e(F,!0);t(F),t(c),x(p=>i(xt,p),[()=>r()("actions.markResolved").toUpperCase()]),_(v,c)};C(tt,v=>{a(l).status!=="resolved"&&v(et)})}t(h),x((v,c,u,g,b)=>{Dt(M,1,`text-xs px-2 py-1 border-2 ${v??""}`),i(q,c),i(Z,`${u??""} ${g??""}`),i(X,a(l).topic),i(G,b)},[()=>zt(a(l).status),()=>ht(a(l).status).toUpperCase(),()=>Et(a(l).priority),()=>r()("actions.priority").toLowerCase(),()=>new Date(a(l).created_at).toLocaleDateString()]),_(A,h)}),t(U),_(S,U)};C(d,S=>{a(st).length===0?S(y):S($,!1)},!0)}_(o,n)};C(Rt,o=>{a(ot)?o(Xt):o(Bt,!1)})}t(lt);var Gt=s(lt,2);{var Jt=o=>{var n=Se(),d=e(n),y=e(d),$=e(y),S=e($,!0);t($);var U=s($,2);U.__click=()=>k(z,!1),t(y);var A=s(y,2),l=e(A),h=e(l),L=e(h),E=e(L,!0);t(L);var D=s(L,2);St(D),t(h);var M=s(h,2),q=e(M),H=e(q,!0);t(q);var Z=s(q,2);Ut(Z),t(M);var I=s(M,2),K=e(I),R=e(K,!0);t(K);var X=s(K,2),T=e(X),_t=e(T,!0);t(T),T.value=T.__value="low";var j=s(T),bt=e(j,!0);t(j),j.value=j.__value="medium";var P=s(j),B=e(P,!0);t(P),P.value=P.__value="high",t(X),t(I);var G=s(I,2),J=e(G),mt=e(J,!0);t(J);var tt=s(J,2);Ut(tt),t(G);var et=s(G,2),v=e(et);St(v);var c=s(v,2),u=e(c,!0);t(c),t(et),t(l);var g=s(l,2),b=e(g);b.__click=()=>k(z,!1);var N=e(b,!0);t(b);var F=s(b,2),xt=e(F,!0);t(F),t(g),t(A),t(d),t(n),x((p,w,O,Q,Nt,Ot,Qt,Vt,Wt,Yt,Zt)=>{i(S,p),i(E,w),i(H,O),i(R,Q),i(_t,Nt),i(bt,Ot),i(B,Qt),i(mt,Vt),i(u,Wt),i(N,Yt),i(xt,Zt)},[()=>r()("actions.create").toUpperCase(),()=>r()("actions.topic").toUpperCase(),()=>r()("surveys.description").toUpperCase(),()=>r()("actions.priority").toUpperCase(),()=>r()("alerts.severity.low"),()=>r()("alerts.severity.medium"),()=>r()("alerts.severity.high"),()=>r()("actions.publicMessage").toUpperCase(),()=>r()("actions.visibleToEmployees"),()=>r()("common.cancel").toUpperCase(),()=>r()("common.create").toUpperCase()]),ae("submit",A,p=>{p.preventDefault(),Pt()}),ft(D,()=>a(f).topic,p=>a(f).topic=p),ft(Z,()=>a(f).description,p=>a(f).description=p),pe(X,()=>a(f).priority,p=>a(f).priority=p),ft(tt,()=>a(f).public_message,p=>a(f).public_message=p),ce(v,()=>a(f).visible_to_employees,p=>a(f).visible_to_employees=p),_(o,n)};C(Gt,o=>{a(z)&&o(Jt)})}x((o,n,d,y)=>{i(qt,`< ${o??""}`),i(Ht,n),i(It,`Action Loop - ${d??""}`),i(Kt,y)},[()=>r()("nav.dashboard"),()=>r()("actions.title").toUpperCase(),()=>r()("actionLoop.title"),()=>r()("actions.create").toUpperCase()]),_(Mt,wt),ie(),Ft()}te(["click"]);export{Je as component};

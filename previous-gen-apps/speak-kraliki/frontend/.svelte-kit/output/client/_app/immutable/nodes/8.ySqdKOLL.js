import{d as ee,f as b,a as _,s as n,c as $t,e as ae}from"../chunks/C3NdowuV.js";import{o as re}from"../chunks/BEA_S9YB.js";import{p as se,b as nt,e as Ct,i as ht,g as w,s as o,t as y,a as oe,d as ne,c as e,$ as ie,r as t,h as a,k as ue}from"../chunks/BIIBwolN.js";import{e as Ut,i as St}from"../chunks/C5feot9S.js";import{i as k}from"../chunks/BMZK_lNp.js";import{h as le}from"../chunks/DCFnHnzv.js";import{r as Ft,s as Qt}from"../chunks/kJGk4-vF.js";import{s as ve}from"../chunks/3ECVvnw7.js";import{b as gt}from"../chunks/V2_FqNi0.js";import{b as ce}from"../chunks/HfYSDCGL.js";import{s as de,a as qt}from"../chunks/BfLFXwF2.js";import{g as jt}from"../chunks/BKtAgaYV.js";import{i as pe,a as _e}from"../chunks/9ICADEXz.js";import{s as it}from"../chunks/BXAMcmxS.js";import{t as be}from"../chunks/Czbc-fPz.js";var me=b('<div class="text-center py-12"><span class="animate-pulse"> </span></div>'),fe=b('<div class="brutal-card p-12 text-center"><p class="text-muted-foreground mb-4"> </p> <button class="brutal-btn brutal-btn-primary"> </button></div>'),xe=b('<p class="text-muted-foreground text-sm mb-3"> </p>'),ye=b("<span> </span>"),he=b("<span> </span>"),ge=b('<button class="brutal-btn brutal-btn-primary text-sm"> </button>'),qe=b('<button class="brutal-btn text-sm"> </button>'),we=b('<div class="brutal-card p-6"><div class="flex items-start justify-between"><div><div class="flex items-center gap-3 mb-2"><h2 class="text-xl font-bold"> </h2> <span> </span></div> <!> <div class="flex gap-6 text-sm text-muted-foreground"><span> </span> <span> </span> <!> <!></div></div> <div class="flex gap-2"><!> <button class="brutal-btn text-sm"> </button></div></div></div>'),ke=b('<div class="grid gap-4"></div>'),$e=b('<button type="button" class="brutal-btn brutal-btn-danger px-3">X</button>'),Ce=b('<div class="flex gap-2"><input type="text" class="brutal-input flex-1" required/> <!></div>'),Ue=b('<div class="fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4"><div class="brutal-card max-w-2xl w-full max-h-[90vh] overflow-y-auto p-6"><div class="flex items-center justify-between mb-6"><h2 class="text-xl"> </h2> <button class="text-2xl hover:text-terminal-green">X</button></div> <form><div class="space-y-4"><div><label for="survey-name" class="block text-sm mb-1"> </label> <input id="survey-name" type="text" class="brutal-input w-full" required/></div> <div><label for="survey-description" class="block text-sm mb-1"> </label> <textarea id="survey-description" class="brutal-input w-full" rows="2"></textarea></div> <div><label for="survey-frequency" class="block text-sm mb-1"> </label> <select id="survey-frequency" class="brutal-input w-full"><option> </option><option> </option><option> </option><option> </option></select></div> <fieldset><legend class="block text-sm mb-2"> </legend> <div class="space-y-3"></div> <button type="button" class="brutal-btn text-sm mt-3"> </button></fieldset></div> <div class="flex gap-3 mt-6 pt-6 border-t-2 border-foreground/20"><button type="button" class="brutal-btn flex-1"> </button> <button type="submit" class="brutal-btn brutal-btn-primary flex-1"> </button></div></form></div></div>'),Se=b('<div class="container mx-auto p-6"><div class="flex items-center justify-between mb-8"><div><a href="/dashboard" class="text-sm text-muted-foreground hover:text-foreground mb-2 inline-block"> </a> <h1 class="text-3xl"> </h1></div> <button class="brutal-btn brutal-btn-primary"> </button></div> <!></div> <!>',1);function He(Mt,At){se(At,!0);const Lt=()=>qt(pe,"$isAuthenticated",ut),Y=()=>qt(_e,"$accessToken",ut),r=()=>qt(be,"$t",ut),[ut,Tt]=de();let lt=nt(Ct([])),vt=nt(!0),B=nt(!1),c=nt(Ct({name:"",description:"",frequency:"monthly",questions:[{id:1,question:"",follow_up_count:2}]}));re(async()=>{if(!Lt()){jt("/login");return}await Z()});async function Z(){try{w(vt,!0),w(lt,await it.list(Y()),!0)}catch(s){console.error("Failed to load surveys",s)}finally{w(vt,!1)}}async function Xt(){try{await it.create(a(c),Y()),w(B,!1),w(c,{name:"",description:"",frequency:"monthly",questions:[{id:1,question:"",follow_up_count:2}]},!0),await Z()}catch(s){console.error("Failed to create survey",s)}}async function zt(s){try{await it.launch(s,Y()),await Z()}catch(i){console.error("Failed to launch survey",i)}}async function Dt(s){try{await it.pause(s,Y()),await Z()}catch(i){console.error("Failed to pause survey",i)}}function It(){const s=Math.max(...a(c).questions.map(i=>i.id))+1;a(c).questions=[...a(c).questions,{id:s,question:"",follow_up_count:2}]}function Kt(s){a(c).questions.length>1&&(a(c).questions=a(c).questions.filter(i=>i.id!==s))}function Bt(s){return{draft:r()("status.draft"),scheduled:r()("status.scheduled"),active:r()("status.active"),paused:r()("status.paused"),completed:r()("status.completed")}[s]||s}function Et(s){return{draft:"text-muted-foreground",scheduled:"text-cyan-data",active:"text-terminal-green",paused:"text-yellow-400",completed:"text-gray-500"}[s]||""}function Gt(s){return{once:r()("surveys.once"),weekly:r()("surveys.weekly"),monthly:r()("surveys.monthly"),quarterly:r()("surveys.quarterly")}[s]||s}var wt=Se();le("13onqvn",s=>{ne(i=>{ie.title=`${i??""} - Speak by Kraliki`},[()=>r()("surveys.title")])});var ct=ht(wt),dt=e(ct),pt=e(dt),_t=e(pt),Ht=e(_t);t(_t);var kt=o(_t,2),Jt=e(kt,!0);t(kt),t(pt);var bt=o(pt,2);bt.__click=()=>w(B,!0);var Nt=e(bt,!0);t(bt),t(dt);var Ot=o(dt,2);{var Pt=s=>{var i=me(),h=e(i),F=e(h,!0);t(h),t(i),y(Q=>n(F,Q),[()=>r()("common.loading").toUpperCase()]),_(s,i)},Rt=s=>{var i=$t(),h=ht(i);{var F=$=>{var g=fe(),q=e(g),l=e(q,!0);t(q);var m=o(q,2);m.__click=()=>w(B,!0);var C=e(m,!0);t(m),t(g),y((j,U)=>{n(l,j),n(C,U)},[()=>r()("surveys.noSurveys"),()=>r()("surveys.create").toUpperCase()]),_($,g)},Q=$=>{var g=ke();Ut(g,21,()=>a(lt),St,(q,l)=>{var m=we(),C=e(m),j=e(C),U=e(j),M=e(U),H=e(M,!0);t(M);var J=o(M,2),tt=e(J,!0);t(J),t(U);var E=o(U,2);{var N=v=>{var u=xe(),d=e(u,!0);t(u),y(()=>n(d,a(l).description)),_(v,u)};k(E,v=>{a(l).description&&v(N)})}var et=o(E,2),A=e(et),L=e(A);t(A);var O=o(A,2),T=e(O);t(O);var at=o(O,2);{var X=v=>{var u=ye(),d=e(u);t(u),y(f=>n(d,`${f??""}: ${a(l).conversation_count??""}`),[()=>r()("dashboard.responses")]),_(v,u)};k(at,v=>{a(l).conversation_count!==void 0&&v(X)})}var mt=o(at,2);{var G=v=>{var u=he(),d=e(u);t(u),y((f,x)=>n(d,`${f??""}: ${x??""}%`),[()=>r()("dashboard.participation"),()=>Math.round(a(l).completion_rate*100)]),_(v,u)};k(mt,v=>{a(l).completion_rate!==void 0&&v(G)})}t(et),t(j);var rt=o(j,2),P=e(rt);{var R=v=>{var u=ge();u.__click=()=>zt(a(l).id);var d=e(u,!0);t(u),y(f=>n(d,f),[()=>r()("surveys.launch").toUpperCase()]),_(v,u)},ft=v=>{var u=$t(),d=ht(u);{var f=x=>{var S=qe();S.__click=()=>Dt(a(l).id);var p=e(S,!0);t(S),y(D=>n(p,D),[()=>r()("surveys.pause").toUpperCase()]),_(x,S)};k(d,x=>{a(l).status==="active"&&x(f)},!0)}_(v,u)};k(P,v=>{a(l).status==="draft"||a(l).status==="paused"?v(R):v(ft,!1)})}var z=o(P,2);z.__click=()=>jt(`/dashboard/surveys/${a(l).id}`);var V=e(z,!0);t(z),t(rt),t(C),t(m),y((v,u,d,f,x,S)=>{var p;n(H,a(l).name),ve(J,1,`text-xs px-2 py-1 border-2 border-foreground ${v??""}`),n(tt,u),n(L,`${d??""}: ${f??""}`),n(T,`${x??""}: ${(((p=a(l).questions)==null?void 0:p.length)||0)??""}`),n(V,S)},[()=>Et(a(l).status),()=>Bt(a(l).status).toUpperCase(),()=>r()("surveys.frequency"),()=>Gt(a(l).frequency),()=>r()("surveys.questions"),()=>r()("surveys.stats").toUpperCase()]),_(q,m)}),t(g),_($,g)};k(h,$=>{a(lt).length===0?$(F):$(Q,!1)},!0)}_(s,i)};k(Ot,s=>{a(vt)?s(Pt):s(Rt,!1)})}t(ct);var Vt=o(ct,2);{var Wt=s=>{var i=Ue(),h=e(i),F=e(h),Q=e(F),$=e(Q,!0);t(Q);var g=o(Q,2);g.__click=()=>w(B,!1),t(F);var q=o(F,2),l=e(q),m=e(l),C=e(m),j=e(C,!0);t(C);var U=o(C,2);Ft(U),t(m);var M=o(m,2),H=e(M),J=e(H,!0);t(H);var tt=o(H,2);ue(tt),t(M);var E=o(M,2),N=e(E),et=e(N,!0);t(N);var A=o(N,2),L=e(A),O=e(L,!0);t(L),L.value=L.__value="once";var T=o(L),at=e(T,!0);t(T),T.value=T.__value="weekly";var X=o(T),mt=e(X,!0);t(X),X.value=X.__value="monthly";var G=o(X),rt=e(G,!0);t(G),G.value=G.__value="quarterly",t(A),t(E);var P=o(E,2),R=e(P),ft=e(R,!0);t(R);var z=o(R,2);Ut(z,21,()=>a(c).questions,St,(p,D,st)=>{var W=Ce(),I=e(W);Ft(I),Qt(I,"placeholder",`Question ${st+1}`),Qt(I,"aria-label",`Question ${st+1}`);var xt=o(I,2);{var yt=K=>{var ot=$e();ot.__click=()=>Kt(a(D).id),_(K,ot)};k(xt,K=>{a(c).questions.length>1&&K(yt)})}t(W),gt(I,()=>a(D).question,K=>a(D).question=K),_(p,W)}),t(z);var V=o(z,2);V.__click=It;var v=e(V);t(V),t(P),t(l);var u=o(l,2),d=e(u);d.__click=()=>w(B,!1);var f=e(d,!0);t(d);var x=o(d,2),S=e(x,!0);t(x),t(u),t(q),t(h),t(i),y((p,D,st,W,I,xt,yt,K,ot,Yt,Zt,te)=>{n($,p),n(j,D),n(J,st),n(et,W),n(O,I),n(at,xt),n(mt,yt),n(rt,K),n(ft,ot),n(v,`+ ${Yt??""}`),n(f,Zt),n(S,te)},[()=>r()("surveys.create").toUpperCase(),()=>r()("surveys.name").toUpperCase(),()=>r()("surveys.description").toUpperCase(),()=>r()("surveys.frequency").toUpperCase(),()=>r()("surveys.once"),()=>r()("surveys.weekly"),()=>r()("surveys.monthly"),()=>r()("surveys.quarterly"),()=>r()("surveys.questions").toUpperCase(),()=>r()("surveys.addQuestion").toUpperCase(),()=>r()("common.cancel").toUpperCase(),()=>r()("common.create").toUpperCase()]),ae("submit",q,p=>{p.preventDefault(),Xt()}),gt(U,()=>a(c).name,p=>a(c).name=p),gt(tt,()=>a(c).description,p=>a(c).description=p),ce(A,()=>a(c).frequency,p=>a(c).frequency=p),_(s,i)};k(Vt,s=>{a(B)&&s(Wt)})}y((s,i,h)=>{n(Ht,`< ${s??""}`),n(Jt,i),n(Nt,h)},[()=>r()("nav.dashboard"),()=>r()("surveys.title").toUpperCase(),()=>r()("surveys.create").toUpperCase()]),_(Mt,wt),oe(),Tt()}ee(["click"]);export{He as component};

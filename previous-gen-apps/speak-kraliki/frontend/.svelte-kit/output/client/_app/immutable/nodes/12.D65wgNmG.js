import{d as ct,f as l,a as d,c as lt,s as h}from"../chunks/C3NdowuV.js";import{o as vt}from"../chunks/BEA_S9YB.js";import{p as ut,b as T,e as M,a as pt,o as ft,s as _,c as i,h as t,E as mt,g as r,$ as bt,r as s,i as V,t as z,n as _t}from"../chunks/BIIBwolN.js";import{e as xt,i as yt}from"../chunks/C5feot9S.js";import{i as k}from"../chunks/BMZK_lNp.js";import{h as gt}from"../chunks/DCFnHnzv.js";import{s as ht}from"../chunks/kJGk4-vF.js";import{s as N}from"../chunks/3ECVvnw7.js";import{s as Tt,a as zt}from"../chunks/BfLFXwF2.js";import{p as At}from"../chunks/COXvSIfD.js";import{d as $}from"../chunks/BXAMcmxS.js";var Ot=l('<div class="text-center py-8"><span class="animate-pulse">Nacitam...</span></div>'),St=l('<div class="text-center py-8"><p class="text-muted-foreground"> </p></div>'),kt=l("<button> </button>"),wt=l('<div><div class="flex items-center justify-between mb-2"><span class="text-xs text-muted-foreground"> </span> <!></div> <p> </p></div>'),Rt=l('<button class="brutal-btn brutal-btn-primary flex-1"> </button>'),Dt=l('<a class="brutal-btn brutal-btn-primary flex-1 text-center">POTVRDIT A ODESLAT</a>'),Et=l('<p class="text-sm text-muted-foreground mb-6">Muzes oznacit casti, ktere chces odstranit z analyzy. Tvuj nadrizeny tyto casti nikdy neuvidi.</p> <div class="max-h-[400px] overflow-y-auto mb-6 border-2 border-foreground p-4"></div> <div class="flex flex-col sm:flex-row gap-4"><!> <button class="brutal-btn brutal-btn-danger">SMAZAT VSE</button></div> <p class="text-xs text-muted-foreground mt-4 text-center">Po potvrzeni budou tvoje odpovedi anonymne analyzovany.</p>',1),Nt=l('<div class="min-h-screen flex items-center justify-center p-4 bg-void"><div class="brutal-card max-w-2xl w-full p-6"><h1 class="text-xl mb-6">PREPIS TVEHO ROZHOVORU</h1> <!></div></div>');function Ht(U,Z){ut(Z,!0);const L=()=>zt(At,"$page",B),[B,C]=Tt(),v=mt(()=>L().params.token);let x=T(M([])),P=T(!0),u=T(null),o=T(M(new Set)),A=T(!1);vt(async()=>{if(t(v))try{const e=await $.transcript(t(v));r(x,e.transcript||[],!0)}catch{r(u,"Prepis neni k dispozici")}finally{r(P,!1)}});function H(e){const n=new Set(t(o));n.has(e)?n.delete(e):n.add(e),r(o,n,!0)}async function K(){if(!(t(o).size===0||!t(v))){r(A,!0);try{await $.redact(t(v),Array.from(t(o))),r(x,t(x).map((e,n)=>t(o).has(n)?{...e,redacted:!0,content:"[ODEBRANO ZAMESTNANCEM]"}:e),!0),r(o,new Set,!0)}catch{r(u,"Nepodarilo se ulozit zmeny")}finally{r(A,!1)}}}async function F(){if(t(v)&&confirm("Opravdu chces smazat vsechna svÃ¡ data? Tato akce je nevratna."))try{await $.deleteData(t(v)),r(x,[],!0),r(u,"Tvoje data byla smazana")}catch{r(u,"Nepodarilo se smazat data")}}var w=Nt();gt("sc5ook",e=>{ft(()=>{bt.title="Prepis rozhovoru - Speak by Kraliki"})});var j=i(w),Y=_(i(j),2);{var q=e=>{var n=Ot();d(e,n)},G=e=>{var n=lt(),J=V(n);{var Q=p=>{var f=St(),m=i(f),O=i(m,!0);s(m),s(f),z(()=>h(O,t(u))),d(p,f)},W=p=>{var f=Et(),m=_(V(f),2);xt(m,21,()=>t(x),yt,(c,a,b)=>{var S=wt(),R=i(S),D=i(R),at=i(D,!0);s(D);var rt=_(D,2);{var st=y=>{var g=kt();g.__click=()=>H(b);var nt=i(g,!0);s(g),z((it,dt)=>{N(g,1,`text-xs ${it??""}`),h(nt,dt)},[()=>t(o).has(b)?"text-system-red":"text-muted-foreground hover:text-foreground",()=>t(o).has(b)?"[ZRUSIT]":"[ODSTRANIT TUTO CAST]"]),d(y,g)};k(rt,y=>{t(a).role==="user"&&!t(a).redacted&&y(st)})}s(R);var E=_(R,2),ot=i(E,!0);s(E),s(S),z(y=>{N(S,1,`mb-4 p-3 border-2 ${y??""}`),h(at,t(a).role==="ai"?"AI":"TY"),N(E,1,t(a).redacted?"text-muted-foreground italic":""),h(ot,t(a).content)},[()=>t(a).redacted?"border-foreground/30 bg-foreground/5":t(o).has(b)?"border-system-red":"border-foreground/50"]),d(c,S)}),s(m);var O=_(m,2),I=i(O);{var X=c=>{var a=Rt();a.__click=K;var b=i(a,!0);s(a),z(()=>{a.disabled=t(A),h(b,t(A)?"UKLADAM...":`POTVRDIT A ODESLAT (${t(o).size} ODEBRANO)`)}),d(c,a)},tt=c=>{var a=Dt();z(()=>ht(a,"href",`/v/${t(v)}`)),d(c,a)};k(I,c=>{t(o).size>0?c(X):c(tt,!1)})}var et=_(I,2);et.__click=F,s(O),_t(2),d(p,f)};k(J,p=>{t(u)?p(Q):p(W,!1)},!0)}d(e,n)};k(Y,e=>{t(P)?e(q):e(G,!1)})}s(j),s(w),d(U,w),pt(),C()}ct(["click"]);export{Ht as component};

import{d as kt,f as u,a as v,s as l,c as wt}from"../chunks/C3NdowuV.js";import{o as At}from"../chunks/BEA_S9YB.js";import{p as Ct,b as H,e as Ut,u as Ft,g as k,c as e,s as c,t as _,a as St,h as r,d as Lt,$ as Tt,r as t,i as jt}from"../chunks/BIIBwolN.js";import{e as Dt,i as Rt}from"../chunks/C5feot9S.js";import{i as w}from"../chunks/BMZK_lNp.js";import{h as zt}from"../chunks/DCFnHnzv.js";import{s as F}from"../chunks/3ECVvnw7.js";import{s as Kt,a as I}from"../chunks/BfLFXwF2.js";import{g as Z}from"../chunks/BKtAgaYV.js";import{a as Mt,i as qt}from"../chunks/9ICADEXz.js";import{a as J}from"../chunks/BXAMcmxS.js";import{t as Bt}from"../chunks/Czbc-fPz.js";var Et=u('<div class="text-center py-12"><span class="animate-pulse"> </span></div>'),Gt=u('<div class="brutal-card p-12 text-center"><p class="text-muted-foreground"> </p></div>'),Ht=u('<span class="text-sm text-cyan-data"> </span>'),It=u('<button class="brutal-btn text-sm"> </button>'),Jt=u('<button class="brutal-btn brutal-btn-primary text-sm"> </button>'),Nt=u('<div><div class="flex items-start justify-between"><div class="flex-1"><div class="flex items-center gap-3 mb-2"><span> </span> <span class="text-sm text-muted-foreground"> </span> <!> <span class="text-xs text-muted-foreground ml-auto"> </span></div> <p class="text-foreground"> </p></div></div> <div class="flex gap-2 mt-4 pt-4 border-t border-foreground/20"><!> <!></div></div>'),Ot=u('<div class="space-y-4"></div>'),Pt=u('<div class="container mx-auto p-6"><div class="flex items-center justify-between mb-8"><div><a href="/dashboard" class="text-sm text-muted-foreground hover:text-foreground mb-2 inline-block"> </a> <h1 class="text-3xl"> </h1></div> <div class="flex gap-2"><button> </button> <button> </button></div></div> <!></div>');function ie(tt,et){Ct(et,!0);const at=()=>I(qt,"$isAuthenticated",L),S=()=>I(Mt,"$accessToken",L),d=()=>I(Bt,"$t",L),[L,rt]=Kt();let T=H(Ut([])),j=H(!0),g=H("all");At(async()=>{if(!at()){Z("/login");return}await D()});async function D(){try{k(j,!0);const a=r(g)==="unread"?{is_read:!1}:void 0;k(T,await J.list(S(),a),!0)}catch(a){console.error("Failed to load alerts",a)}finally{k(j,!1)}}async function st(a){try{await J.update(a,{is_read:!0},S()),await D()}catch(s){console.error("Failed to mark alert as read",s)}}async function ot(a){try{await J.createAction(a,S()),Z("/dashboard/actions")}catch(s){console.error("Failed to create action from alert",s)}}function it(a){return{low:d()("alerts.severity.low"),medium:d()("alerts.severity.medium"),high:d()("alerts.severity.high")}[a]||a}function nt(a){return{low:"border-muted-foreground text-muted-foreground",medium:"border-yellow-400 text-yellow-400",high:"border-system-red text-system-red"}[a]||""}Ft(()=>{D()});var R=Pt();zt("1lh6zvb",a=>{Lt(s=>{Tt.title=`${s??""} - Speak by Kraliki`},[()=>d()("alerts.title")])});var z=e(R),K=e(z),M=e(K),lt=e(M);t(M);var N=c(M,2),dt=e(N,!0);t(N),t(K);var O=c(K,2),h=e(O);h.__click=()=>k(g,"all");var ct=e(h,!0);t(h);var A=c(h,2);A.__click=()=>k(g,"unread");var vt=e(A,!0);t(A),t(O),t(z);var ut=c(z,2);{var pt=a=>{var s=Et(),f=e(s),y=e(f,!0);t(f),t(s),_(q=>l(y,q),[()=>d()("common.loading").toUpperCase()]),v(a,s)},mt=a=>{var s=wt(),f=jt(s);{var y=b=>{var p=Gt(),C=e(p),i=e(C,!0);t(C),t(p),_(x=>l(i,x),[()=>d()("alerts.noAlerts")]),v(b,p)},q=b=>{var p=Ot();Dt(p,21,()=>r(T),Rt,(C,i)=>{var x=Nt(),B=e(x),P=e(B),E=e(P),U=e(E),_t=e(U,!0);t(U);var G=c(U,2),ft=e(G,!0);t(G);var Q=c(G,2);{var bt=n=>{var o=Ht(),m=e(o,!0);t(o),_(()=>l(m,r(i).department_name)),v(n,o)};w(Q,n=>{r(i).department_name&&n(bt)})}var V=c(Q,2),xt=e(V,!0);t(V),t(E);var W=c(E,2),gt=e(W,!0);t(W),t(P),t(B);var X=c(B,2),Y=e(X);{var ht=n=>{var o=It();o.__click=()=>st(r(i).id);var m=e(o,!0);t(o),_($=>l(m,$),[()=>d()("alerts.markRead").toUpperCase()]),v(n,o)};w(Y,n=>{r(i).is_read||n(ht)})}var yt=c(Y,2);{var $t=n=>{var o=Jt();o.__click=()=>ot(r(i).id);var m=e(o,!0);t(o),_($=>l(m,$),[()=>d()("alerts.createAction").toUpperCase()]),v(n,o)};w(yt,n=>{r(i).is_resolved||n($t)})}t(X),t(x),_((n,o,m,$)=>{F(x,1,`brutal-card p-6 ${r(i).is_read?"opacity-60":""}`),F(U,1,`text-xs px-2 py-1 border-2 ${n??""}`),l(_t,o),l(ft,m),l(xt,$),l(gt,r(i).description)},[()=>nt(r(i).severity),()=>it(r(i).severity).toUpperCase(),()=>r(i).type.replace(/_/g," ").toUpperCase(),()=>new Date(r(i).created_at).toLocaleDateString()]),v(C,x)}),t(p),v(b,p)};w(f,b=>{r(T).length===0?b(y):b(q,!1)},!0)}v(a,s)};w(ut,a=>{r(j)?a(pt):a(mt,!1)})}t(R),_((a,s,f,y)=>{l(lt,`< ${a??""}`),l(dt,s),F(h,1,`brutal-btn text-sm ${r(g)==="all"?"brutal-btn-primary":""}`),l(ct,f),F(A,1,`brutal-btn text-sm ${r(g)==="unread"?"brutal-btn-primary":""}`),l(vt,y)},[()=>d()("nav.dashboard"),()=>d()("alerts.title").toUpperCase(),()=>d()("common.all").toUpperCase(),()=>d()("alerts.unread").toUpperCase()]),v(tt,R),St(),rt()}kt(["click"]);export{ie as component};
